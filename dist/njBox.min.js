!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("njBox",[],e):"object"==typeof exports?exports.njBox=e():t.njBox=e()}(this,function(){return function(t){function e(n){if(o[n])return o[n].exports;var i=o[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var o={};return e.m=t,e.c=o,e.i=function(t){return t},e.d=function(t,o,n){e.o(t,o)||Object.defineProperty(t,o,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/",e(e.s=3)}([function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),r=o(1),l=n(r),d=o(2),c=window.jQuery||l.default,h=function(t,e,o){var n=function(){function n(t,o){if(i(this,n),!arguments.length)return void console.error("njBox, arguments not passed.");var s=void 0,a=this;!o&&t?s=c.isPlainObject(t)?t:{elem:t}:(s=o,s.elem=t),s=s||{},a.co=s,e(function(){a._init()},0)}return a(n,[{key:"_init",value:function(){var t=this;if(!t.state||!t.state.inited){var e=t.co;delete t.co,n.g||(n.g=(0,d.getDefaultInfo)()),t.state={active:0,arguments:{}},t._g={optionsPassed:e},t._handlers={};var o=t.o=c.extend({},n.defaults,e);if(o.jquery&&(c=o.jquery),t.$=c,!o.elem&&!o.content)return void t._e("njBox, no elements (o.elem) or content (o.content) for modal.");if(o.elem){var i=c(o.elem);if(!i.length)return void this._e("njBox, element not found ("+o.elem+")");if(i.length>1&&(i=c(i[0])),i[0].njBox)return void this._e("njBox, already inited on this element");i[0].njBox=this;var s=this._g.optionsGathered=this._gatherData(i);this._cb("options_gathered",s,i[0]),c.extend(!0,this.o,s)}for(var a in n.addons)n.addons.hasOwnProperty(a)&&this["_"+a+"_init"]();t.dom=t._createDom(),t._cb("domready",t.dom);var r=t._g.containerIsBody=t.dom.container[0]===t.dom.body[0];r||"static"!==t.dom.container.css("position")||t.dom.container.addClass("njb-relative"),r||"fixed"!==o.layout||(o.layout="absolute",t.dom.wrap.addClass("njb-absolute")),t._g.els=t.o.el,t._g.items_raw=[t.o],t._cb("items_raw",t._g),t.items=t._createItems(t._g.items_raw),t._g.animation=t._calculateAnimations(),t._addClickHandler(),o.buttonrole&&t._g.els&&t._g.els.attr("role",o.buttonrole),t.state.inited=!0,t._cb("inited")}}},{key:"show",value:function(e){this.state.arguments.show=arguments,this._init(),e!==t&&(this.state.active=e-1);this.o;if("inited"!==this.state.status)return void this._e("njBox, show, plugin not inited or in not inited state(probably plugin is already visible or destroyed, or smth else..)");if(!this.items.length)return void this._e("njBox, smth goes wrong, plugin don't create any item to show",!0);if(this._cb("show")!==!1){this.state.focused||(this.state.focused=o.activeElement),this.returnValue=null;var n=this.dom.container[0];n.njb_instances?n.njb_instances++:n.njb_instances=1,this._scrollbar("hide"),this._backdrop("show");var i;return this._g.popover?i=n:(n.appendChild(this.dom.wrap[0]),i=this.dom.items[0]),this._addListeners(),this._drawItem(this.items[this.state.active],!1,i),this._cb("inserted"),this.position(),this.dom.wrap[0].style.display="none",this.dom.wrap[0].clientHeight,this.dom.wrap[0].style.display="block",this._uiUpdate(),this._anim("show"),this}}},{key:"hide",value:function(){return this.state.arguments.hide=arguments,"shown"!==this.state.status?void this._e("njBox, hide, we can hide only showed modal (probably animation is still running or plugin destroyed)."):this._cb("hide")!==!1?(this.state.focused&&this.state.focused.focus(),this._backdrop("hide"),this._removeListeners(),this._anim("hide"),this):void 0}},{key:"position",value:function(){this.state.arguments.position=arguments;var t=this,e=this.o,o=t.state;if(o&&o.inited&&("show"===o.status||"shown"===o.status)){if(t.state.dimensions=t._getDimensions(),this._cb("position"),"absolute"===e.layout){var n=this.state.dimensions.container.scrollTop,i=this.state.dimensions.container.scrollLeft;n<=this.state.dimensions.container.scrollTopMax&&this.dom.wrap.css({top:n+"px",left:i+"px"}),this.dom.backdrop.css({width:"auto",height:"auto"}),this.dom.backdrop[0].clientHeight,this.dom.backdrop.css({width:this.state.dimensions.container.scrollWidth+"px",height:this.state.dimensions.container.scrollHeight+"px"})}return this._setMaxHeight(this.items[this.state.active]),this._cb("positioned"),this}}},{key:"destroy",value:function(){return this.state.arguments.destroy=arguments,this.state.inited&&"inited"===this.state.status?(this._removeClickHandler(),this.dom.container.removeClass("njb-relative"),this._cb("destroy"),this._events=this._g=this._handlers=this.items=this.itemsRaw=this.dom=this.$=t,this.o={},this):void this._e("njBox, we can destroy only initialized && hidden modals.")}},{key:"update",value:function(){return this.state.arguments.update=arguments,this.items=this._createItems(),this._addClickHandler(),this}},{key:"_gatherData",value:function(t){function e(t){var e={};for(var n in t)if(t.hasOwnProperty(n)&&/^njb[A-Z]+/.test(n)){var i=n.match(/^njb(.*)/)[1],s=i.charAt(0).toLowerCase()+i.slice(1);e[s]=o(t[n])}return e}function o(t){var e=/\s/.test(t),o=e?t:parseFloat(t);return"true"===t||"false"!==t&&(isNaN(o)?t:o)}var n=this.o,i=c(t),s=c.extend(!0,{},i.data()),a={};if(!i.length)return a;if(s.njbOptions)try{a=c.parseJSON(s.njbOptions),delete s.njbOptions}catch(t){return void this._e("njBox, fail to parse options from njb-options")}if(i.length&&(a.el=i),"a"===i[0].tagName.toLowerCase()){var r=i.attr("href");r&&"#"!==r&&"#!"!==r&&!/^(?:javascript)/i.test(r)&&(a.content=r)}if(n.title_attr){var l=i.attr(n.title_attr);l&&(a.title=l)}return c.extend(!0,a,e(s)),a}},{key:"_createItems",value:function(t){for(var e=[],o=0,n=t.length;o<n;o++)e.push(this._createItem(t[o],o));return e}},{key:"_createItem",value:function(t,e){var o=this,n=o.o,i=o._normalizeItem(t);return i.dom=o._createItemDom(i),o._insertItemContent({item:i,delayed:n.delayed}),i.toInsert=i.dom.modalOuter,o._cb("item_created",i,e),i}},{key:"_normalizeItem",value:function(t,e){var o,n=this;o="function"==typeof t.content?t.content.call(n,t):t.content;var i=o||n.o.text._missedContent;return{content:i,type:t.type||n._type(i),header:t.header,footer:t.footer,title:t.title,el:t.el||e,o:{status:"inited"},raw:t}}},{key:"_type",value:function(t){var e="html";if("object"===(void 0===t?"undefined":s(t))){if(window.jQuery&&t instanceof window.jQuery||window.j&&t instanceof window.j)return"selector"}else{if(/^[#.]\w/.test(t))return"selector";if(/\.(png|jpg|jpeg|gif|tiff|bmp|webp)(\?\S*)?$/i.test(t))return"image"}return e}},{key:"_createItemDom",value:function(t){var e,n,i=this,s=this.o,a={},r=o.createDocumentFragment();if(a.modal=n=c(s.templates.modal),n[0].tabIndex="-1",n[0].njBox=i,a.modalOuter=e=c(s.templates.modalOuter),s.role&&n.attr("role",s.role),s.label&&n.attr("aria-label",s.label),s.labelledby&&n.attr("aria-labelledby",s.labelledby),s.describedby&&n.attr("aria-describedby",s.describedby),n.length||i._e("njBox, error in o.templates.modal"),e[0].appendChild(n[0]),"template"!==t.type){if(a.body=c(s.templates.body),a.body.length||i._e("njBox, error in o.templates.body"),a.bodyInput=(0,d.getItemFromDom)(a.body,"data-njb-body"),r.appendChild(a.body[0]),t.header){a.header=c(s.templates.header);var l="njBox, error in o.templates.header";a.header.length?(a.headerInput=(0,d.getItemFromDom)(a.header,"data-njb-header"),a.headerInput.length?r.insertBefore(a.header[0],r.firstChild):i._e(l)):i._e(l)}if(t.footer){a.footer=c(s.templates.footer);var h="njBox, error in njBox.templates.footer";a.footer.length?(a.footerInput=(0,d.getItemFromDom)(a.footer,"data-njb-footer"),a.footerInput.length?r.appendChild(a.footer[0]):i._e(h)):i._e(h)}"inside"===s.close&&(a.close=c(s.templates.close),a.close.attr("title",s.text.close),r.appendChild(a.close[0])),n[0].appendChild(r)}return"image"===t.type?n.addClass("njb--image"):n.addClass("njb--content"),a}},{key:"_insertItemContent",value:function(t){function e(){s.headerInput&&n.header&&s.headerInput.html(n.header),s.footerInput&&n.footer&&s.footerInput.html(n.footer),n.o.status="loaded","shown"===o.state.status&&o._setMaxHeight(n)}var o=this,n=(o.o,t.item),i=t.delayed,s=n.dom,a=n.type,r=n.content,l=s.bodyInput;if("template"===a)s.modal.html(r);else switch(a){case"html":l.html(r),e();break;case"text":"textContent"in l[0]?l[0].textContent=r:l[0].innerText=r,e();break;case"selector":if(!i&&!n.o.contentInserted){var d=n.o.contentEl=c(n.content);d.length?(n.o.contentElStyle=d[0].style.cssText,n.o.contentElDisplayNone="none"===d.css("display"),n.o.contentElDisplayNone&&(d[0].style.display="block"),l.html(""),l[0].appendChild(d[0]),n.o.contentInserted=!0):l.html(n.content),e()}break;case"image":i||n.o.contentInserted||this._insertImage(n,e)}}},{key:"_insertImage",value:function(t,e){function n(o){r._cb("item_img_"+o,t),o!==l.img&&o!==!0||(t.o.status="loaded",r._preloader("hide",t),h.attr("width","auto"),t.dom.bodyInput[0].appendChild(d),t.o.contentInserted=!0,e())}function i(t,e){var o,n=0;!function i(s){o&&clearInterval(o),o=setInterval(function(){if(t.width>0)return e(),void clearInterval(o);n>200&&clearInterval(o),n++,5===n?i(10):40===n?i(50):100===n&&i(500)},s)}(1)}var s,a,r=this,l=this.o,d=o.createElement("img"),h=c(d);t.o.status="loading",t.dom.img=h,t._handlerError=function(){h.off("error",t._handlerError).off("abort",t._handlerError),delete t._handlerError,r._preloader("hide",t),t.dom.bodyInput.html(l.text.imageError.replace("%url%",t.content)),r._cb("img_e",t),t.o.status="error",t.o.contentInserted=!0},h.on("error",t._handlerError).on("abort",t._handlerError),t.title&&h.attr("aria-labelledby","njb-title"),d.src=t.content,s=d.width+d.height>0,a=d.complete&&d.width+d.height>0,"ready"===l.img&&s||"load"===l.img&&a?n(!0):(this._preloader("show",t),i(d,function(){n("ready")}),t._handlerLoad=function(){h.off("load",t._handlerLoad),n("load")},h.on("load",t._handlerLoad))}},{key:"_createDom",value:function(){var t=this,e=this.o,n={document:c(o),window:c(window),html:c(o.documentElement),body:c(o.body)};return n.container=c(e.container),n.container.length||(t._e("njBox, can't find container element. (we use body instead)"),n.container=n.body),n.wrap=c(e.templates.wrap),n.wrap.length||t._e("njBox, smth wrong with o.templates.wrap."),e.class&&n.wrap.addClass(e.class),n.wrap[0].njBox=t,e.zindex&&n.wrap.css("zIndex",e.zindex),n.items=n.wrap.find(".njb-items"),n.ui=c(e.templates.ui),n.wrap[0].appendChild(n.ui[0]),n.title=c(e.templates.title),n.ui[0].appendChild(n.title[0]),"outside"===e.close&&(n.close=c(e.templates.close),n.close.attr("title",e.text.close).attr("aria-label",e.text.close),n.ui[0].appendChild(n.close[0])),n.focusCatchBefore=c(e.templates.focusCatcher),n.wrap[0].insertBefore(n.focusCatchBefore[0],n.wrap[0].firstChild),n.focusCatchAfter=c(e.templates.focusCatcher),n.wrap[0].appendChild(n.focusCatchAfter[0]),n}},{key:"_getPassedOption",value:function(e){return this._g.optionsGathered[e]!==t?this._g.optionsGathered[e]:this._g.optionsPassed[e]!==t?this._g.optionsPassed[e]:void 0}},{key:"_getDimensions",value:function(){var t=this,e=(t.o,{});return e.window=t._getDomSize(t.dom.window[0]),e.container=t._getDomSize(this._g.containerIsBody?t.dom.window[0]:this.dom.container[0]),e.modal=t._getDomSize(t.items[t.state.active].dom.modal[0]),e.clickedEl=t._getDomSize(t.state.clickedEl),e.autoheight=t._g.containerIsBody?e.window.height:e.container.height,e}},{key:"_getDomSize",value:function(t){var e,n,i=c.isWindow(t),s=o,a=s.documentElement,r=s.body;return i?n={el:t,left:0,top:0,right:a.clientWidth,bottom:a.clientHeight,width:a.clientWidth,height:a.clientHeight,scrollWidth:Math.max(r.scrollWidth,a.scrollWidth,r.offsetWidth,a.offsetWidth,r.clientWidth,a.clientWidth),scrollHeight:Math.max(r.scrollHeight,a.scrollHeight,r.offsetHeight,a.offsetHeight,r.clientHeight,a.clientHeight),scrollLeft:window.pageXOffset||a.scrollLeft||r.scrollLeft,scrollTop:window.pageYOffset||a.scrollTop||r.scrollTop}:(e=t.getBoundingClientRect(),n=this.$.extend({},e),n.el=t,n.width=n.right-n.left,n.height=n.bottom-n.top,n.scrollWidth=t.scrollWidth,n.scrollHeight=t.scrollHeight,n.scrollLeft=t.scrollLeft,n.scrollTop=t.scrollTop),n.scrollLeftMax=n.scrollWidth-n.width<0?0:n.scrollWidth-n.width,n.scrollTopMax=n.scrollHeight-n.height<0?0:n.scrollHeight-n.height,n}},{key:"_setMaxHeight",value:function(t){function e(t,e){return parseInt(t.css(e+"Top"))+parseInt(t.css(e+"Bottom"))||0}var o=this.o;if(o.autoheight&&("image"!==o.autoheight||"image"===t.type)&&!this._g.popover){this.state.autoheightAdded||(o.autoheight===!0?this.dom.wrap.addClass("njb-wrap--autoheight-true"):this.dom.wrap.addClass("njb-wrap--autoheight-image"),this.state.autoheightAdded=!0);var n=t.dom,i=e(n.modal,"margin"),s=e(n.modal,"padding")+parseInt(n.modal.css("borderTopWidth"))+parseInt(n.modal.css("borderBottomWidth"))||0,a=e(n.body,"margin"),r=e(n.body,"padding")+parseInt(n.body.css("borderTopWidth"))+parseInt(n.body.css("borderBottomWidth"))||0,l=this.state.dimensions.autoheight,d=l,c="border-box"===n.body.css("boxSizing"),h=0,u=0;if(n.header&&n.header.length&&(h=n.header[0].scrollHeight+(parseInt(n.header.css("borderTopWidth"))+parseInt(n.header.css("borderBottomWidth")))||0),n.footer&&n.footer.length&&(u=n.footer[0].scrollHeight+(parseInt(n.footer.css("borderTopWidth"))+parseInt(n.footer.css("borderBottomWidth")))||0),d=l-i-s-a-h-u,c||(d-=r),"image"===t.type){var f=l-i-s-a-r-h-u;n.img&&n.img.css("maxHeight",f+"px")}else n.body.css("maxHeight",d+"px")}}},{key:"_drawItem",value:function(t,e,o){var n=this,i=n.o,s=t.toInsert[0];n._cb("item_prepare",t),!i.delayed||t.o.contentInserted||"image"!==t.type&&"selector"!==t.type||n._insertItemContent({item:t,delayed:!1}),e?o.insertBefore(s,o.firstChild):o.appendChild(s),n._cb("item_inserted",t)}},{key:"_removeSelectorItemsElement",value:function(){for(var e,o,n=this.items,i=0,s=n.length;i<s;i++)if("selector"===n[i].type&&this.o.delayed){if(e=n[i],!e.o.contentInserted)continue;o=e.o.contentEl,e.o.contentElDisplayNone&&(o[0].style.display="none",e.o.contentElDisplayNone=t),e.o.contentElStyle&&(o[0].style.cssText=e.o.contentElStyle,e.o.contentElStyle=t),this.dom.body[0].appendChild(o[0]),e.o.contentInserted=!1}}},{key:"_focus_set",value:function(t,e){var o,n,i=this.o;if(e)return o=this.dom.ui.find(this.o._focusable),void o[o.length-1].focus();i.autofocus&&(n=t.dom.modal.find(i.autofocus)[0]),n||(n=t.dom.modal.find("[autofocus]")[0]),n||(o=t.dom.modal.find(this.o._focusable),n=o[0]),n?n.focus():t.dom.modal[0].focus()}},{key:"_addClickHandler",value:function(){var t=this,e=this.o,o=t._handlers;t._removeClickHandler(),o.elsClick=t._clickHandler(),e.click&&t._g.els&&t._g.els.length&&t._g.els.on("click",o.elsClick),e.clickels&&c(e.clickels).on("click",o.elsClick)}},{key:"_clickHandler",value:function(){var t=(this.o,this);return function(e){var o=this;if(e.originalEvent&&(e=e.originalEvent),!("which"in e&&(1!==e.which||1===e.which&&e.ctrlKey&&e.shiftKey))){if(e.preventDefault?e.preventDefault():e.returnValue=!1,"inited"!==t.state.status)return void t._e("njBox, show, plugin not inited or in not inited state(probably plugin is already visible or destroyed, or smth else..)");c(o).closest(".njb-close-system, .njb-arrow").length||(t.state.clickedEvent=e,t.state.clickedEl=o,t.state.focused=o,t.show())}}}},{key:"_removeClickHandler",value:function(){var t=this.o;this._g.els&&this._g.els.length&&(this._g.els.off("click",this._handlers.elsClick),t.clickels&&c(t.clickels).off("click",this._handlers.elsClick))}},{key:"_addListeners",value:function(){var t=this.o,o=this,n=this._handlers;n.container_resize=function(t){o.position()},n.container_scroll=function(t){o.position()},n.container_out=function(n){if(o.state.clickedEl!==n.target&&"shown"===o.state.status){if(!c(n.target).closest(".njb, .njb-ui").length)if(n.preventDefault?n.preventDefault():n.returnValue=!1,t.out){if(o._cb("cancel")===!1)return;o.hide()}else o.items[o.state.active].dom.modal.addClass("njb--pulse"),o._focus_set(o.items[o.state.active]),e(function(){o.items[o.state.active].dom.modal.removeClass("njb--pulse")},o._getAnimTime(o.items[o.state.active].dom.modal[0]))}},o.dom.container.on("resize",n.container_resize).on("scroll",n.container_scroll),o.dom.container.on("click",n.container_out),n.wrap_resize=function(){o.position()},n.wrap_scroll=function(){o.position()},n.wrap_keydown=function(e){switch(o._cb("keydown",e),e.which){case 27:if(t.esc){if(o._cb("cancel")===!1)return;o.hide()}e.preventDefault?e.preventDefault():e.returnValue=!1}},n.wrap_close=function(t){t.preventDefault?t.preventDefault():t.returnValue=!1,o._cb("cancel")!==!1&&o.hide()},n.wrap_ok=function(t){t.preventDefault?t.preventDefault():t.returnValue=!1,o._cb("ok")!==!1&&o.hide()},n.wrap_cancel=function(t){t.preventDefault?t.preventDefault():t.returnValue=!1,o._cb("cancel")!==!1&&o.hide()},o.dom.wrap.on("resize",n.wrap_resize).on("scroll",n.wrap_scroll).on("keydown",n.wrap_keydown).delegate("[data-njb-close]","click",n.wrap_close).delegate("[data-njb-ok]","click",n.wrap_ok).delegate("[data-njb-cancel]","click",n.wrap_cancel),n.window_resize=function(){o.position()},n.window_scroll=function(){o.position()},n.window_orientation=function(){o.position()},o.dom.window.on("resize",n.window_resize).on("scroll",n.window_scroll).on("orientationchange",n.window_orientation),n.focusCatchBefore=function(t){var e,n=t.relatedTarget;n?(e=!!c(n).closest(".njb-ui").length,e?o._focus_set(o.items[o.state.active]):o._focus_set(o.items[o.state.active],!0)):o._focus_set(o.items[o.state.active],!0)},n.focusCatchAfter=function(t){o._focus_set(o.items[o.state.active])},this.dom.focusCatchBefore.on("focus",n.focusCatchBefore),this.dom.focusCatchAfter.on("focus",n.focusCatchAfter),this._cb("listeners_added")}},{key:"_removeListeners",value:function(){var t=this._handlers,e=this;e.dom.container.off("resize",t.container_resize).off("scroll",t.container_scroll).off("click",t.container_out),e.dom.wrap.off("resize",t.wrap_resize).off("scroll",t.wrap_scroll).off("keydown",t.wrap_keydown).undelegate("[data-njb-close]","click",t.wrap_close).undelegate("[data-njb-ok]","click",t.wrap_ok).undelegate("[data-njb-cancel]","click",t.wrap_cancel),e.dom.window.off("resize",t.window_resize).off("scroll",t.window_scroll).off("orientationchange",t.window_orientation);var o=t.elsClick;this._handlers={elsClick:o},e.dom.focusCatchBefore.off("focus",t.focusCatchBefore),e.dom.focusCatchAfter.off("focus",t.focusCatchAfter),this._cb("listeners_removed")}},{key:"_preloader",value:function(t,e){var o=this.o;switch(t){case"show":e.o.preloader=!0,e.dom.preloader=c(o.templates.preloader).attr("title",o.text.preloader),e.dom.modal.addClass("njb--loading"),e.dom.bodyInput[0].appendChild(e.dom.preloader[0]);break;case"hide":if(!e.o.preloader)return;e.dom.preloader[0].parentElement.removeChild(e.dom.preloader[0]),e.dom.modal.removeClass("njb--loading"),delete e.dom.preloader,delete e.o.preloader}}},{key:"_uiUpdate",value:function(t){t=t||this.state.active;var e=this,o=e.dom,n=(this.o,this.items[t]);if(!n)return void e._e("njBox, can't update ui info from item index - "+t);n.title?o.ui.addClass("njb-ui--title"):o.ui.removeClass("njb-ui--title"),o.wrap.find("[data-njb-title]").html(n.title||""),"image"===n.type?o.wrap.removeClass("njb-wrap--content").addClass("njb-wrap--image"):o.wrap.removeClass("njb-wrap--image").addClass("njb-wrap--content")}},{key:"_anim",value:function(t){function o(){i.animclass&&a.removeClass(i.animclass),a.removeClass(r),s._cb("shown"),s._focus_set(s.items[s.state.active])}function n(){i.animclass&&a.removeClass(i.animclass),l===r&&a.removeClass("njb-anim-reverse"),a.removeClass(l),s._clear(),s._cb("hidden")}var i=this.o,s=this,a=this.items[this.state.active].dom.modal,r=this._g.animation.show,l=this._g.animation.hide,d=this._g.animation.showDur,c=this._g.animation.hideDur;switch(t){case"show":this.dom.wrap[0].clientHeight,this.dom.wrap.addClass("njb-wrap--visible"),r?(i.animclass&&a.addClass(i.animclass),a.attr("open",""),a.addClass(r),e(o,d)):o();break;case"hide":a[0].removeAttribute("open"),this.dom.wrap.removeClass("njb-wrap--visible"),l?(i.animclass&&a.addClass(i.animclass),l===r&&a.addClass("njb-anim-reverse"),a.addClass(l),e(n,c)):n()}}},{key:"_scrollbar",value:function(e){var i=this.o;switch(e){case"hide":if("hide"===i.scrollbar){if(this.state.scrollbarHidden)return;if(this._g.containerIsBody){var s=(o.documentElement.scrollHeight||o.body.scrollHeight)>o.documentElement.clientHeight;this.dom.container[0].njb_scrollbar||this.state.scrollbarHidden||!s&&"scroll"!==this.dom.html.css("overflowY")&&"scroll"!==this.dom.body.css("overflowY")||(this.dom.html.addClass("njb-hideScrollbar"),this.dom.html.css("paddingRight",parseInt(this.dom.html.css("paddingRight"))+n.g.scrollbarSize+"px"))}else{var s=this.dom.container[0].scrollHeight>this.dom.container[0].clientHeight;this.dom.container.addClass("njb-hideScrollbar")}this.state.scrollbarHidden=!0,this.dom.container[0].njb_scrollbar?this.dom.container[0].njb_scrollbar++:this.dom.container[0].njb_scrollbar=1}break;case"show":if(!this.state.scrollbarHidden)return;if(--this.dom.container[0].njb_scrollbar)return void delete this.state.scrollbarHidden;if(this.dom.container[0].njb_scrollbar=t,this._g.containerIsBody){this.dom.html.removeClass("njb-hideScrollbar");var a=parseInt(this.dom.html.css("paddingRight"))-n.g.scrollbarSize;a?this.dom.html.css("paddingRight",a+"px"):this.dom.html[0].style.paddingRight=""}else{this.dom.container.removeClass("njb-hideScrollbar");var a=parseInt(this.dom.container.css("paddingRight"))-n.g.scrollbarSize;a?this.dom.container.css("paddingRight",a+"px"):this.dom.container[0].style.paddingRight=""}delete this.state.scrollbarHidden}}},{key:"_backdrop",value:function(t){var o=this.o,n=this;switch(t){case"show":if(this.dom.backdrop=c(o.templates.backdrop),this.state.backdropVisible)return;o.backdrop===!0&&(o.backdropassist&&this.dom.backdrop.css("transitionDuration",this._g.animation.showDur+"ms"),"absolute"===o.layout&&this.dom.backdrop.addClass("njb-absolute"),this.dom.container[0].appendChild(this.dom.backdrop[0]),e(function(){n.dom.backdrop.addClass("njb-backdrop--visible")},0),this.state.backdropVisible=!0);break;case"hide":if(!this.state.backdropVisible)return;o.backdropassist&&this.dom.backdrop.css("transitionDuration",this._g.animation.hideDur+"ms"),this.dom.backdrop.removeClass("njb-backdrop--visible"),e(function(){n.dom.backdrop[0].parentNode.removeChild(n.dom.backdrop[0]),o.backdropassist&&(n.dom.backdrop[0].style.cssText=""),delete n.state.backdropVisible},n._getAnimTime(n.dom.backdrop[0]))}}},{key:"_calculateAnimations",value:function(){var t,e,n,i,s,a=this.o,r=!1;a.anim&&(s=a.anim.split(" "),t=s[0],e=s[1]?s[1]:s[0]),a.duration&&(a.duration=a.duration.toString(),s=a.duration.split(" "),n=s[0],i=s[1]?s[1]:s[0]);var l=o.createElement("div");return l.style.cssText="visibility: hidden; position: absolute;",n&&"auto"!==n||!t?n=parseInt(n)||0:(l.className=(a.animclass||"")+" "+t,o.body.appendChild(l),r=!0,n=this._getAnimTime(l)),i&&"auto"!==i||!e?i=parseInt(i)||0:(l.className=(a.animclass||"")+" "+e,r||(o.body.appendChild(l),r=!0),i=this._getAnimTime(l)),r&&o.body.removeChild(l),{show:t,hide:e,showDur:n,hideDur:i}}},{key:"_getAnimTime",value:function(e,o){function n(e,o){var n,i,s,a,r=c(e),l=[];if(!r.length)return 0;if(!o)return 0;n=r.css(o+"Duration"),s=r.css(o+"Delay"),n&&n!==t||(n="0s"),i=n.split(", ");for(var d=0,h=i.length;d<h;d++)i[d]=i[d].indexOf("ms")>-1?parseFloat(i[d]):1e3*parseFloat(i[d]);s&&s!==t||(s="0s"),a=s.split(", ");for(var d=0,h=a.length;d<h;d++)a[d]=a[d].indexOf("ms")>-1?parseFloat(a[d]):1e3*parseFloat(a[d]);for(var d=0,h=i.length;d<h;d++)l[d]=i[d]+a[d];return Math.max.apply(Math,l)}return n(e,"animation")||n(e,"transition")}},{key:"_focusPreviousModal",value:function(){var t,e=this.dom.body.find(".njb-wrap");e.length&&(t=e[e.length-1].njBox,t._focus_set(t.items[t.state.active]))}},{key:"_clear",value:function(){function t(t){for(;t.firstChild;)t.removeChild(t.firstChild)}var e=this.o,o=this.items[this.state.active].dom.modal;this._cb("clear"),this.dom.container&&this.dom.container[0].njb_instances--,e.class&&this.dom.wrap.removeClass(e.class),this._scrollbar("show"),this._g.popover?(o[0].parentNode.removeChild(o[0]),o.css("left","0").css("top","0")):this.dom.wrap&&this.dom.wrap.length&&this.dom.wrap[0].parentNode.removeChild(this.dom.wrap[0]),this._removeSelectorItemsElement(),this.dom.items&&this.dom.items.length&&t(this.dom.items[0]);for(var n=0,i=this.items.length;n<i;n++)this.items[n].dom.modalOuter[0].style.cssText="";this.state={active:0,arguments:{},inited:!0,state:"inited"},this._cb("cleared")}},{key:"_e",value:function(t,e){t&&(console.error(t),e&&this._clear())}},{key:"_cb",value:function(t){var e,o=this.o;switch("inited"!==t&&"show"!==t&&"shown"!==t&&"hide"!==t&&"hidden"!==t&&"destroy"!==t&&"destroyed"!==t||(this.state.status=t),t){case"hidden":this.state.status="inited",o.focusprevious&&this._focusPreviousModal()}this.trigger.apply(this,arguments);var n=Array.prototype.slice.call(arguments);o.oncb&&"function"==typeof o.oncb&&(e=o.oncb.apply(this,n)),this.trigger.apply(this,["cb"].concat(n));var i=Array.prototype.slice.call(arguments,1);if("ok"===t||"cancel"===t){var s=this.items[this.state.active].dom.modal,a=s.find("[data-njb-return]"),r=void 0;a.length&&(r=a[0].value||null),i.unshift(r),this.returnValue=r}return"function"==typeof o["on"+t]&&(e=o["on"+t].apply(this,i)),e}},{key:"on",value:function(t,e){return this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(e),this}},{key:"off",value:function(t,e){if(this._events=this._events||{},t in this._events!=!1)return this._events[t].splice(this._events[t].indexOf(e),1),this}},{key:"trigger",value:function(t){if(this._events=this._events||{},t in this._events!=!1){for(var e=0;e<this._events[t].length;e++)this._events[t][e].apply(this,Array.prototype.slice.call(arguments,1));return this}}}]),n}();return o.body&&!n.g&&(n.g=(0,d.getDefaultInfo)()),n.addons={},n.defaults=d.defaults,n.addAddon=function(t,e){n.addons[t]=!0,e.options&&c.extend(!0,n.defaults,e.options),c.extend(n.prototype,e.prototype)},n.get=function(e){var o=c(e)[0];return o?o.njBox||t:t},n.autobind=function(){c(n.defaults.autobind).each(function(){new n({elem:c(this)})})},"undefined"!=typeof window&&c(function(){n.autobind()}),n.alert=function(t,e,o){return new n({content:function(e){return'<div class="njb__body">\n'+(t||this.o.text._missedContent)+'\n</div>\n<div class="njb__footer">\n  <button data-njb-ok>'+this.o.text.ok+"</button>\n</div>"},type:"template",role:"alertdialog",out:!1,onok:e,oncancel:o}).show()},n.confirm=function(t,e,o){return new n({content:function(e){return'<div class="njb__body">\n'+(t||this.o.text._missedContent)+'\n</div>\n<div class="njb__footer">\n  <button data-njb-ok>'+this.o.text.ok+"</button>\n  <button data-njb-cancel>"+this.o.text.cancel+"</button>\n</div>"},type:"template",role:"alertdialog",out:!1,onok:e,oncancel:o}).show()},n.prompt=function(t,e,o,i){return"function"==typeof e&&(i=o,o=e,e=""),new n({content:function(o){return'<div class="njb__body">\n'+(t||this.o.text._missedContent)+'\n<div>\n  <input data-njb-return type="text" placeholder="'+(e||"")+'" />\n</div>\n</div>\n<div class="njb__footer">\n  <button data-njb-ok>'+this.o.text.ok+"</button>\n  <button data-njb-cancel>"+this.o.text.cancel+"</button>\n</div>"},type:"template",role:"alertdialog",out:!1,onok:o,oncancel:i}).show()},n}(void 0,setTimeout,document);e.default=h,t.exports=e.default},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=function t(e){return new t.fn.init(e||"")};i.match=function(t,e){return t===document&&(t=document.documentElement),(t.matches||t.matchesSelector||t.oMatchesSelector||t.mozMatchesSelector||t.webkitMatchesSelector||t.msMatchesSelector).call(t,e)},i.fn=i.prototype,i.fn.init=function(t){var e;"string"==typeof t&&t.length>0?e="<"===t.charAt(0)?i.str2dom?i.str2dom(t):[]:document.querySelectorAll(t):t instanceof Array||t instanceof NodeList||t instanceof HTMLCollection||t instanceof i?e=t:t.nodeType||window.Node&&t instanceof Node||t==t.window||"object"===(void 0===t?"undefined":n(t))?e=[t]:"function"==typeof t?(e=[document],document.addEventListener("DOMContentLoaded",t)):e=[],this.length=e.length;for(var o=0,s=this.length;o<s;o++)this[o]=e[o];return this},i.fn.init.prototype=i.fn,i.fn.each=function(t){for(var e=0,o=this.length;e<o&&t.call(this[e],e,this[e])!==!1;e++);return this},i.str2dom=function(t){var e=document.createElement("div");return e.innerHTML=t,e.childNodes},i.isArray=function(t){return"array"===i.type(t)},i.isFunction=function(t){return"function"==i.type(t)},i.isPlainObject=function(t){var e,o={},n={}.hasOwnProperty;if(!t||"object"!==i.type(t)||t.nodeType||i.isWindow(t))return!1;try{if(t.constructor&&!n.call(t,"constructor")&&!n.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}if(o.ownLast)for(e in t)return n.call(t,e);for(e in t);return void 0===e||n.call(t,e)},i.isWindow=function(t){return null!=t&&t==t.window},i.type=function(t){var e=e={"[object Array]":"array","[object Boolean]":"boolean","[object Date]":"date","[object Error]":"error","[object Function]":"function","[object Number]":"number","[object Object]":"object","[object RegExp]":"regexp","[object String]":"string"},o=e.toString;return null==t?t+"":"object"===(void 0===t?"undefined":n(t))||"function"==typeof t?e[o.call(t)]||"object":void 0===t?"undefined":n(t)},i.extend=function(){var t,e,o,s,a,r,l=arguments[0]||{},d=1,c=arguments.length,h=!1;for("boolean"==typeof l&&(h=l,l=arguments[d]||{},d++),"object"===(void 0===l?"undefined":n(l))||i.isFunction(l)||(l={}),d===c&&(l=this,d--);d<c;d++)if(null!=(a=arguments[d]))for(s in a)t=l[s],o=a[s],l!==o&&(h&&o&&(i.isPlainObject(o)||(e=i.isArray(o)))?(e?(e=!1,r=t&&i.isArray(t)?t:[]):r=t&&i.isPlainObject(t)?t:{},l[s]=i.extend(h,r,o)):void 0!==o&&(l[s]=o));return l},i.inArray=function(t,e,o){return null==e?-1:e.indexOf(t,o)},i.fn.find=function(t){var e,o=[];return this.each(function(n){e=Array.prototype.slice.call(this.querySelectorAll(t),""),e.length&&(o=o.concat(e))}),i(o)},i.fn.on=function(t,e){return this.each(function(){this.addEventListener(t,e,!1)})},i.fn.off=function(t,e){return this.each(function(){this.removeEventListener(t,e)})},i.fn.delegate=function(t,e,o){return this.each(function(n){var s=this;this._events||(this._events={}),this._events[e]||(this._events[e]=[]);var a=function(e){var n=e&&e.target||window.event.srcElement,a=e.path;if(!a){a=[];for(var r=n;r;)a.push(r),r=r.parentNode}for(var l=0,d=a.length;l<d&&a[l]!==s;l++)if(a[l]!==document&&i.match(a[l],t)){o.call(a[l],e);break}};a.fn=o,this.addEventListener(e,a,!1),this._events[e].push(a)})},i.fn.undelegate=function(t,e,o){return o||(o=e,e=t),this.each(function(t){var n=this._events,i=this._events[e];if(n&&i){for(var t=0,s=i.length;t<s;t++)if(o===i[t].fn){this.removeEventListener(e,i[t]),delete i[t].fn,i.splice(t,1);break}i.length||delete n[e];var a=!0;for(var r in n)if(n.hasOwnProperty(r)){a=!1;break}a&&delete this._events}})},i.fn.data=function(t){return t?this[0].dataset[t]:this[0].dataset},i.fn.attr=function(t,e){return e?this.each(function(){this.setAttribute(t,e)}):this[0].getAttribute(t)},i.parseJSON=function(t){return JSON.parse(t)},i.fn.css=function(t,e){if(t)return"float"==t&&(t="styleFloat"),e?this.each(function(){this.style[t]=e}):getComputedStyle(this[0],null)[t]||void 0},i.fn.hasClass=function(t){return this[0].classList.contains(t)},i.fn.addClass=function(t){var e=t.split(" ");return this.each(function(){for(var t=0,o=e.length;t<o;t++)this.classList.add(e[t])})},i.fn.removeClass=function(t){var e=t.split(" ");return this.each(function(t){for(var t=0,o=e.length;t<o;t++)this.classList.remove(e[t])})},i.fn.closest=function(t){for(var e,o=[],n=0,s=this.length;n<s;n++)if(i.match(this[n],t))o.push(this[n]);else for(e=this[n].parentNode,e===document&&(e=document.documentElement);e&&"HTML"!==e.tagName;)i.match(e,t)&&i.inArray(e,o)===-1&&o.push(e),e=e.parentNode;return i(o)},i.fn.html=function(t){return this.each(function(){this.innerHTML=t})},e.default=i,t.exports=e.default},function(t,e,o){"use strict";function n(){function t(t){var o,n,i,s=["Webkit","Moz","O","ms"],a=t.charAt(0).toUpperCase()+t.slice(1),r=document.createElement("div");if(document.body.insertBefore(r,null),t in r.style)n=t,i=null;else for(var l=0;l<s.length;l++){if((o=s[l]+a)in r.style){i=s[l];break}o=void 0}var d={js:n||o,css:e(t,i)};if("transform"===t){if(void 0!==r.style[d.js]){r.style[d.js]="translate3d(1px,1px,1px)";var c=window.getComputedStyle(r)[d.js]}d["3d"]=void 0!==c&&c.length>0&&"none"!==c}return document.body.removeChild(r),d}function e(t,e){if(t=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),null===e)return t;var o=void 0;switch(e){case"Webkit":o="-webkit-"+t;break;case"Moz":o="-moz-"+t;break;case"ms":o="-ms-"+t;break;case"O":o="-o-"+t}return o}var o={},n=document.createElement("div");n.style.cssText="width: 99px; height: 99px; overflow: scroll; position: absolute; top: -99px;",document.body.appendChild(n),o.scrollbarSize=n.offsetWidth-n.clientWidth||0,document.body.removeChild(n),o.oldIE=!(!document.all||document.addEventListener),o.touch="ontouchstart"in window;var i=o;return i.nativeDialogSupport=!!document.createElement("dialog").showModal,i.transition=t("transition"),i.transitionDuration=t("transitionDuration"),i.transform=t("transform"),i.animation=t("animation"),o}function i(t,e){return null!==t.attr(e)?t:t.find("["+e+"]")}Object.defineProperty(e,"__esModule",{value:!0}),e.getDefaultInfo=n,e.getItemFromDom=i;e.defaults={elem:"",content:void 0,delayed:!0,type:"",header:void 0,footer:void 0,class:!1,zindex:!1,container:"body",layout:"fixed",placement:"center",offset:"10 10",boundary:!0,click:!0,clickels:"",backdrop:!0,backdropassist:!0,scrollbar:"hide",out:!0,esc:!0,close:"outside",autoheight:"image",autofocus:!1,focusprevious:!0,title:!1,title_attr:"title",img:"ready",anim:"scale",animclass:"animated",duration:"auto",jquery:void 0,autobind:'[data-toggle~="box"], [data-toggle~="modal"]',_focusable:'a[href], area[href], details, iframe, object, embed, input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), [tabindex]:not([tabindex="-1"]), [contenteditable]',buttonrole:"button",role:"dialog",label:!1,labelledby:!1,describedby:!1,templates:{wrap:'<div class="njb-wrap"><div class="njb-items"></div></div>',backdrop:'<div class="njb-backdrop"></div>',modalOuter:'<div class="njb-outer"></div>',modal:'<div class="njb"></div>',body:'<div class="njb__body" data-njb-body></div>',header:'<header class="njb__header" data-njb-header></header>',footer:'<footer class="njb__footer" data-njb-footer></footer>',close:'<button type="button" class="njb-ui__close" data-njb-close><span aria-hidden="true">×</span></button>',focusCatcher:'<span tabindex="0" class="njb-focus-catch" aria-hidden="true"></span>',preloader:'<div class="njb-preloader"><div class="njb-preloader__inner"><div class="njb-preloader__bar1"></div><div class="njb-preloader__bar2"></div><div class="njb-preloader__bar3"></div></div></div>',ui:'<div class="njb-ui"></div>',title:'<div class="njb-ui__title"><div class="njb-ui__title-inner" id="njb-title" data-njb-title></div></div>'},text:{_missedContent:"njBox plugin: meow, put some content here...",preloader:"Loading...",imageError:'<a href="%url%">This image</a> can not be loaded.',close:"Close dialog",ok:"Ok",cancel:"Cancel",placeholder:""}}},function(t,e,o){t.exports=o(0)}])});