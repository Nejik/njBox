!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("njBox",[],e):"object"==typeof exports?exports.njBox=e():t.njBox=e()}(this,function(){return function(t){function e(n){if(i[n])return i[n].exports;var o=i[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var i={};return e.m=t,e.c=i,e.i=function(t){return t},e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/",e(e.s=3)}([function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=i(1),l=n(a),c=i(2),d=window.jQuery||l.default,h=function(){function t(e,i){if(o(this,t),!arguments.length)return void console.error("njBox, arguments not passed.");var n=void 0;!i&&e?n=d.isPlainObject(e)?e:{elem:e}:(n=i,n.elem=e),n=n||{},this._init(n)}return r(t,[{key:"_init",value:function(e){t.g||(t.g=(0,c.getDefaultInfo)()),this.state={active:0},this._globals={},this._handlers={},this._globals.passedOptions=e;var i=this.o=d.extend({},t.defaults,e);if(i.jquery&&(d=i.jquery),this.v={document:d(document),window:d(window),html:d(document.documentElement),body:d(document.body)},!i.elem&&!i.content)return void this._error("njBox, no elements (o.elem) or content (o.content) for modal.");if(i.elem){var n=d(i.elem);if(!n.length)return void this._error("njBox, element not found ("+i.elem+")");if(n.length>1&&(n=d(n[0])),n[0].njBox)return void this._error("njBox, already inited on this element");n[0].njBox=this,this._globals.gatheredOptions=this._gatherData(n),d.extend(!0,this.o,this._globals.gatheredOptions),this.els=this._gatherElements(i.gallery)}this._postProcessOptions(),this.state.gallery&&(this.v.prev=d(i.templates.prev),this.v.prev[0].setAttribute("title",i.text.prev),this.v.next=d(i.templates.next),this.v.next[0].setAttribute("title",i.text.next)),this.items=this._createItems(this._createRawItems()),this._createDom(),this._calculateAnimations(),this._setClickHandlers(),this.state.inited=!0,this._cb("inited")}},{key:"show",value:function(t){t&&(this.state.active=parseInt(t-1));var e=this.o,i=this;if("inited"!==this.state.state)return void this._error("njBox, show, plugin not inited or in not inited state(probably plugin is already visible or destroyed, or smth else..)");if(!this.items.length)return void this._error("njBox, smth goes wrong, plugin don't create any item to show",!0);if(this._cb("show")!==!1)return this.returnValue=null,this.state.gallery&&(e.start-1&&"number"==typeof e.start&&this.items[e.start-1]&&(this.state.active=e.start-1),this.els&&this.els.length&&this.els.each(function(t,e){if(i.state.clickedEl===e)return void(i.state.active=t)})),this.v.container[0].njb_instances?this.v.container[0].njb_instances++:this.v.container[0].njb_instances=1,this.v.container.addClass("njb-open"),this._scrollbar("hide"),this._backdrop("show"),this._setEventsHandlers(),this.v.container[0].appendChild(this.v.wrap[0]),this._drawItem(this.state.active),i.state.gallery&&this._drawItemSiblings(),this.position(),this.v.wrap[0].style.display="none",this.v.wrap[0].clientHeight,this.v.wrap[0].style.display="block",this._anim("show"),this}},{key:"hide",value:function(){if("shown"!==this.state.state)return void this._error("njBox, hide, we can hide only showed modal (probably animation is still running or plugin destroyed).");this.o,this._handlers;if(this._cb("hide")!==!1)return this.state.clickedEl&&this.state.clickedEl.focus(),this._backdrop("hide"),this._removeEventsHandlers(),this._anim("hide"),this}},{key:"position",value:function(){if(this.state.inited){var t=this.o;if(this._getContainerSize(),"absolute"===t.position){var e=this.state.dimensions.containerScrollTop,i=this.state.dimensions.containerScrollLeft;e<=this.state.dimensions.containerMaxScrollTop&&this.v.wrap.css({top:e+"px",left:i+"px"}),this.v.backdrop.css({width:"auto",height:"auto"}),this.v.backdrop[0].clientHeight,this.v.backdrop.css({width:this.state.dimensions.containerScrollWidth+"px",height:this.state.dimensions.containerScrollHeight+"px"})}if(this.state.gallery)for(var n=0;n<this.state.itemsOrder.length;n++)null!==this.state.itemsOrder[n]&&this._setMaxHeight(this.items[this.state.itemsOrder[n]]);else this._setMaxHeight(this.items[this.state.active]);return this._cb("position"),this}}},{key:"prev",value:function(){this._changeItem(this.state.active-1,"prev")}},{key:"next",value:function(){this._changeItem(this.state.active+1,"next")}},{key:"destroy",value:function(){if(!this.state.inited||"inited"!==this.state.state)return void this._error("njBox, we can destroy only initialized && hidden modals.");this._removeClickHandlers(),this.v.container.removeClass("njb-relative"),this._globals=void 0,this._handlers=void 0,this.els=void 0,this.items=void 0,this.v=void 0,this.o={},this._cb("destroyed")}},{key:"update",value:function(){this.els=this._gatherElements(this.o.gallery),this.items=this._createItems(this._createRawItems()),this._setClickHandlers()}},{key:"_getContainerSize",value:function(){var t=(this.o,this.state.dimensions={});this.v.container[0]===this.v.body[0]?(t.containerWidth=document.documentElement.clientWidth,t.containerHeight=document.documentElement.clientHeight,t.containerScrollWidth=Math.max(document.body.scrollWidth,document.documentElement.scrollWidth,document.body.offsetWidth,document.documentElement.offsetWidth,document.body.clientWidth,document.documentElement.clientWidth),t.containerScrollHeight=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight),t.containerScrollTop=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,t.containerScrollLeft=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft):(t.containerWidth=this.v.container[0].clientWidth,t.containerHeight=this.v.container[0].clientHeight,t.containerScrollWidth=this.v.container[0].scrollWidth,t.containerScrollHeight=this.v.container[0].scrollHeight,t.containerScrollTop=this.v.container[0].scrollTop,t.containerScrollLeft=this.v.container[0].scrollLeft),t.containerMaxScrollTop=t.containerScrollHeight-t.containerHeight,t.winHeight=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,t.autoheight=this.v.container[0]===this.v.body[0]?t.winHeight:t.containerHeight}},{key:"_setMaxHeight",value:function(t){function e(t,e){return parseInt(t.css(e+"Top"))+parseInt(t.css(e+"Bottom"))||0}var i=this.o;if(i.autoheight&&("image"!==i.autoheight||"image"===t.type)){this.state.autoheightAdded||(this.v.wrap.addClass("njb-autoheight"),i.autoheight===!0?this.v.wrap.addClass("njb-autoheight--true"):this.v.wrap.addClass("njb-autoheight--image"),this.state.autoheightAdded=!0);var n=t.dom,o=e(n.modal,"margin"),s=e(n.modal,"padding")+parseInt(n.modal.css("borderTopWidth"))+parseInt(n.modal.css("borderBottomWidth"))||0,r=e(n.body,"margin"),a=e(n.body,"padding")+parseInt(n.body.css("borderTopWidth"))+parseInt(n.body.css("borderBottomWidth"))||0,l=this.state.dimensions.autoheight,c=l,d="border-box"===n.body.css("boxSizing"),h=0,u=0;if(n.header&&n.header.length&&(h=n.header[0].scrollHeight+(parseInt(n.header.css("borderTopWidth"))+parseInt(n.header.css("borderBottomWidth")))||0),n.footer&&n.footer.length&&(u=n.footer[0].scrollHeight+(parseInt(n.footer.css("borderTopWidth"))+parseInt(n.footer.css("borderBottomWidth")))||0),c=l-o-s-r-h-u,d||(c-=a),"image"===t.type){var m=l-o-s-r-a-h-u;n.img&&n.img.css("maxHeight",m+"px")}else n.body.css("maxHeight",c+"px")}}},{key:"_createRawItems",value:function(){this.o;if(this.state.gallery){for(var t=[],e=0;e<this.els.length;e++){var i=this.els[e];t.push(this._gatherData(i))}return t}return[this.o]}},{key:"_gatherElements",value:function(t){this.o;return t?this.o.el.find(t):this.o.el}},{key:"_postProcessOptions",value:function(){this.o.gallery&&(this.state.gallery=!0)}},{key:"_gatherData",value:function(t){function e(t){var e={};for(var n in t)if(t.hasOwnProperty(n)&&/^njb[A-Z]+/.test(n)){var o=n.match(/^njb(.*)/)[1],s=o.charAt(0).toLowerCase()+o.slice(1);e[s]=i(t[n])}return e}function i(t){var e=parseFloat(t);return"true"===t||"false"!==t&&(isNaN(e)?t:e)}var n=this.o,o=d(t),s=o.data(),r={};if(!o.length)return r;if(s.njbOptions)try{r=d.parseJSON(s.njbOptions),delete s.njbOptions}catch(t){return void this._error("njBox, fail to parse options from njb-options")}if(o.length&&(r.el=o),"a"===o[0].tagName.toLowerCase()){var a=o.attr("href");a&&"#"!==a&&"#!"!==a&&!/^(?:javascript)/i.test(a)&&(r.content=a)}if(n.title_attr){var l=o.attr(n.title_attr);l&&(r.title=l)}return d.extend(!0,r,e(s)),this._cb("data_gathered",r,o[0]),r}},{key:"_createItems",value:function(t){for(var e=[],i=0,n=t.length;i<n;i++)e.push(this._createItem(t[i],i));return e}},{key:"_createItem",value:function(t,e){var i=this._normalizeItem(t);return this._createDomForItem(i,e),i}},{key:"_normalizeItem",value:function(t,e){var i=void 0;return i="function"==typeof t.content?t.content.call(this,t):t.content,{content:i||this.o.text._missedContent,type:t.type||this._type(t.content||this.o.text._missedContent),header:t.header,footer:t.footer,title:t.title,el:t.el||e,o:{status:"inited"}}}},{key:"_type",value:function(t){var e="html";if("object"===(void 0===t?"undefined":s(t))){if(window.jQuery&&t instanceof window.jQuery||window.j&&t instanceof window.j)return"selector"}else{if(/^[#.]\w/.test(t))return"selector";if(/\.(png|jpg|jpeg|gif|tiff|bmp|webp)(\?\S*)?$/i.test(t))return"image"}return e}},{key:"_createDomForItem",value:function(t,e){var i=this.o,n=t.dom={},o=document.createDocumentFragment();if(n.modalOuter=d(i.templates.modalOuter),n.modalOuter[0].njBox=this,this.state.gallery&&n.modalOuter[0].setAttribute("data-njb-index",e),n.modal=d(i.templates.modal),n.modal[0].setAttribute("tabindex","-1"),n.modal[0].njBox=this,!n.modal.length)return void this._error("njBox, error in o.templates.modal");if(n.modalOuter[0].appendChild(n.modal[0]),"template"===t.type)n.modal[0].innerHTML=t.content;else{if(n.body=d(i.templates.body),!n.body.length)return void this._error("njBox, error in o.templates.body");if(this._insertItemBodyContent(t),o.appendChild(n.body[0]),t.header){if(n.header=d(i.templates.header),!n.header.length)return void this._error("njBox, error in o.templates.header");var s=s=null!==n.header[0].getAttribute("data-njb-header")?n.header:n.header.find("[data-njb-header]");s[0].innerHTML=t.header,o.insertBefore(n.header[0],o.firstChild)}if(t.footer){if(n.footer=d(i.templates.footer),!n.footer.length)return void this._error("njBox, error in njBox.templates.footer");var r=r=null!==n.footer[0].getAttribute("data-njb-footer")?n.footer:n.footer.find("[data-njb-footer]");r[0].innerHTML=t.footer,o.appendChild(n.footer[0])}"inside"===i.close&&(n.close=d(i.templates.close),n.close[0].setAttribute("title",i.text.close),o.appendChild(n.close[0])),n.modal[0].appendChild(o)}this._cb("item_domready",t)}},{key:"_insertItemBodyContent",value:function(t){var e=this.o;switch(t.type){case"text":"textContent"in t.dom.body[0]?t.dom.body[0].textContent=t.content:t.dom.body[0].innerText=t.content,t.o.status="loaded";break;case"html":t.dom.body[0].innerHTML=t.content,t.o.status="loaded";break;case"selector":this._getItemFromSelector(t),t.o.status="loaded";break;case"image":"init"===e.imgload&&this._insertImage(t);break;default:return this._error("njBox, seems that you use wrong type("+t.type+") of item.",!0),void(t.o.status="loaded")}"image"===t.type?t.dom.modal.addClass("njb--image"):t.dom.modal.addClass("njb--content")}},{key:"_getItemFromSelector",value:function(t){t.o.contentEl=d(t.content),t.o.contentEl.length||(t.dom.body[0].innerHTML=t.content)}},{key:"_insertImage",value:function(t){function e(e){s._cb("item_img_"+e,t),e!==r.img&&e!==!0||(t.o.status="loaded",s._preloader("hide",t),l.attr("width","auto"),t.dom.body[0].appendChild(a),t.o.imageInserted=!0)}function i(t){var e,i=0;!function n(o){e&&clearInterval(e),e=setInterval(function(){if(t.width>0)return l.triggerHandler("njb_ready"),void clearInterval(e);i>200&&clearInterval(e),i++,5===i?n(10):40===i?n(50):100===i&&n(500)},o)}(1)}var n,o,s=this,r=this.o,a=document.createElement("img"),l=d(a);t.o.status="loading",t.dom.img=l,t._handlerError=function(){l.off("error",t._handlerError).off("abort",t._handlerError),delete t._handlerError,s._preloader("hide",t),t.dom.body[0].innerHTML=r.text.imageError.replace("%url%",t.content),s._cb("img_error",t),t.o.status="error",t.o.imageInserted=!0},l.on("error",t._handlerError).on("abort",t._handlerError),t.title&&(a.title=t.title),a.src=t.content,n=a.width+a.height>0,o=a.complete&&a.width+a.height>0,"ready"===r.img&&n||"load"===r.img&&o?e(!0):(this._preloader("show",t),t._handlerImgReady=function(){l.off("njb_ready",t._handlerImgReady),e("ready")},l.on("njb_ready",t._handlerImgReady),i(a),t._handlerLoad=function(){l.off("load",t._handlerLoad),e("load")},l.on("load",t._handlerLoad))}},{key:"_createDom",value:function(){var t=this.o;if(this.v.container=d(t.container),this.v.container.length||(this._error("njBox, can't find container element. (we use body instead)"),this.v.container=this.v.body),this.v.container[0]!==this.v.body[0]&&"static"===this.v.container.css("position")&&this.v.container.addClass("njb-relative"),this.v.wrap=d(t.templates.wrap),!this.v.wrap.length)return void this._error("njBox, smth wrong with o.templates.wrap.");t.class&&this.v.wrap.addClass(t.class),this.v.wrap[0].njBox=this,t.zindex&&this.v.wrap.css("zIndex",t.zindex),this.v.items=this.v.wrap.find(".njb-items"),this.v.container[0]!==this.v.body[0]&&(t.position="absolute"),"absolute"===t.position&&this.v.wrap.addClass("njb-absolute"),t.arrows&&!this.state.arrowsInserted&&this.state.gallery&&(this.v.next[0]&&this.v.wrap[0].appendChild(this.v.next[0]),this.v.prev[0]&&this.v.wrap[0].appendChild(this.v.prev[0]),this.state.arrowsInserted=!0),"outside"===t.close&&(this.v.close=d(t.templates.close),this.v.close[0].setAttribute("title",t.text.close),this.v.wrap[0].appendChild(this.v.close[0])),this.v.focusCatcher=d(t.templates.focusCatcher),this.v.wrap[0].appendChild(this.v.focusCatcher[0])}},{key:"_drawItem",value:function(t,e){var i=(this.o,this.items[t]);if(!i)return void this._error("njBox, we have no item with this index - "+t,!0);this._cb("item_prepare",i),this._insertDelayedContent(i),e?this.v.items[0].insertBefore(i.dom.modalOuter[0],this.v.items[0].firstChild):this.v.items[0].appendChild(i.dom.modalOuter[0]),this._cb("item_inserted",i)}},{key:"_setItemsOrder",value:function(t){var e=this.o,i=this.state.active-1,n=this.state.active+1;e.loop&&this.items.length>2&&(i===-1&&(i=this.items.length-1),n===this.items.length&&(n=0)),this.items[i]||(i=null),this.items[n]||(n=null),this.state.itemsOrder=[i,t,n]}},{key:"_drawItemSiblings",value:function(){this.o;this._setItemsOrder(this.state.active),"number"==typeof this.state.itemsOrder[0]&&(this._moveItem(this.items[this.state.itemsOrder[0]],-110,"%"),this._drawItem(this.state.itemsOrder[0],!0)),"number"==typeof this.state.itemsOrder[2]&&(this._moveItem(this.items[this.state.itemsOrder[2]],110,"%"),this._drawItem(this.state.itemsOrder[2])),this.position()}},{key:"_moveItem",value:function(e,i,n){n=n||"px",t.g.transform["3d"]?e.dom.modalOuter[0].style.cssText=t.g.transform.css+": translate3d("+(i+n)+",0,0)":t.g.transform.css?e.dom.modalOuter[0].style.cssText=t.g.transform.css+": translateX("+(i+n)+")":e.dom.modalOuter[0].style.cssText="left:"+(i+n)}},{key:"_changeItem",value:function(t,e){function i(t){t.dom.modalOuter[0].parentNode.removeChild(t.dom.modalOuter[0]),t.dom.modalOuter[0].style.cssText=""}if(1!==this.items.length&&t!==this.state.active&&!this.state.itemChanging){var n=this.o,o=this;if(!this.items[t]){if(!(n.loop&&this.items.length>2))return;if("next"===e&&t===this.items.length)t=0;else{if("prev"!==e||t!==-1)return;t=this.items.length-1}}switch(this.state.direction=e,this.state.itemChanging=!0,this.state.itemsOrder_backup=this.state.itemsOrder.slice(),this._cb("change",t),this.state.active=t,this._setItemsOrder(t),e){case"prev":this.items[this.state.itemsOrder_backup[0]].dom.body[0].style.verticalAlign="middle",this._moveItem(this.items[this.state.itemsOrder_backup[1]],110,"%"),this._moveItem(this.items[this.state.itemsOrder_backup[0]],0,"%");break;case"next":this.items[this.state.itemsOrder_backup[2]].dom.body[0].style.verticalAlign="middle",this._moveItem(this.items[this.state.itemsOrder_backup[1]],-110,"%"),this._moveItem(this.items[this.state.itemsOrder_backup[2]],0,"%")}this._setFocusInPopup(this.items[this.state.active]),setTimeout(function(){if("shown"!==o.state.state)return console.log(o.state.state),void(o.state.itemChanging=!1);i(o.items[o.state.itemsOrder_backup[1]]);var t="prev"===e?o.state.itemsOrder_backup[2]:o.state.itemsOrder_backup[0];o.items[t]&&i(o.items[t]),delete o.state.itemsOrder_backup,o._drawItemSiblings(),o.state.itemChanging=!1,o._cb("changed",o.state.active)},this._getAnimTime(this.items[this.state.itemsOrder[1]].dom.modalOuter))}}},{key:"_insertDelayedContent",value:function(t){var e,i=this.o;if("image"!==t.type||"show"!==i.imgload||t.o.imageInserted){if("selector"===t.type&&!t.o.contentElInserted){if(e=t.o.contentEl,e&&e.length||(this._getItemFromSelector(t),e=t.o.contentEl),!e||!e.length)return;var n=e[0].style.cssText;n&&(t.o.contentElStyle=n);var o="none"===e.css("display");o&&(t.o.contentElDisplayNone=!0,e[0].style.display="block"),t.dom.body[0].innerHTML="",t.dom.body[0].appendChild(e[0]),t.o.contentElInserted=!0}}else this._insertImage(t)}},{key:"_removeSelectorItemsElement",value:function(){for(var t,e,i=this.items,n=0,o=i.length;n<o;n++)if("selector"===i[n].type){if(t=i[n],!t.o.contentElInserted)continue;e=t.o.contentEl,t.o.contentElDisplayNone&&(e[0].style.display="none",t.o.contentElDisplayNone=void 0),t.o.contentElStyle&&(e[0].style.cssText=t.o.contentElStyle,t.o.contentElStyle=void 0),this.v.body[0].appendChild(e[0]),t.o.contentElInserted=!1}}},{key:"_setFocusInPopup",value:function(t,e){var i,n=this.o;e&&(i=t.dom.modal.find("[autofocus]"),!i.length&&n.autofocus&&(i=t.dom.modal.find(n.autofocus))),i&&i.length||(i=t.dom.modal.find(this.o._focusable)),i&&i.length?i[0].focus():this.state.gallery?this.v.next[0].focus():"outside"===n.close?this.v.close[0].focus():"inside"===n.close&&t.dom.close?t.dom.close[0].focus():t.dom.modal[0].focus()}},{key:"_setClickHandlers",value:function(){var t=this.o;t.click&&this.els&&this.els.length&&(this.els.off("click",this._handlers.elsClick),t.clickels&&d(t.clickels).off("click",this._handlers.elsClick),this._handlers.elsClick=this._clickHandler(),this.els.on("click",this._handlers.elsClick),t.clickels&&d(t.clickels).on("click",this._handlers.elsClick))}},{key:"_clickHandler",value:function(){var t=(this.o,this);return function(e){var i=this;if(e.originalEvent&&(e=e.originalEvent),!("which"in e&&(1!==e.which||1===e.which&&e.ctrlKey&&e.shiftKey))){if(e.preventDefault?e.preventDefault():e.returnValue=!1,"inited"!==t.state.state)return void t._error("njBox, show, plugin not inited or in not inited state(probably plugin is already visible or destroyed, or smth else..)");d(i).closest(".njb-close-system, .njb-arrow").length||(t.state.clickedEvent=e,t.state.clickedEl=i,t.show())}}}},{key:"_removeClickHandlers",value:function(){this.els&&this.els.length&&(this.els.off("click",this._handlers.elsClick),this.o.clickels&&d(this.o.clickels).off("click",this._handlers.elsClick))}},{key:"_setEventsHandlers",value:function(){var t=this.o,e=this,i=this._handlers;i.container_resize=function(){e.position()},i.container_scroll=function(){e.position()},this.v.container.on("resize",i.container_resize).on("scroll",i.container_scroll),i.wrap_out=function(i){if(!d(i.target).closest(".njb, [data-njb-close], [data-njb-prev], [data-njb-next]").length)if(i.preventDefault?i.preventDefault():i.returnValue=!1,t.out){if(e._cb("cancel")===!1)return;e.hide()}else e.items[e.state.active].dom.modal.addClass("njb_pulse"),e._setFocusInPopup(this.items[this.state.active]),setTimeout(function(){e.items[e.state.active].dom.modal.removeClass("njb_pulse")},e._getAnimTime(e.items[e.state.active].dom.modal[0]))},i.wrap_resize=function(){},i.wrap_scroll=function(t){},i.wrap_keydown=function(i){switch(e._cb("keydown",i),i.which){case 27:if(t.esc){if(e._cb("cancel")===!1)return;e.hide()}i.preventDefault?i.preventDefault():i.returnValue=!1;break;case 37:e.prev(),i.preventDefault();break;case 39:e.next(),i.preventDefault()}},i.wrap_close=function(t){t.preventDefault?t.preventDefault():t.returnValue=!1,e._cb("cancel")!==!1&&e.hide()},i.wrap_ok=function(t){t.preventDefault?t.preventDefault():t.returnValue=!1,e._cb("ok")!==!1&&e.hide()},i.wrap_cancel=function(t){t.preventDefault?t.preventDefault():t.returnValue=!1,e._cb("cancel")!==!1&&e.hide()},i.wrap_prev=function(t){e.prev(),t.preventDefault()},i.wrap_next=function(t){e.next(),t.preventDefault()},this.v.wrap.on("click",i.wrap_out).on("resize",i.wrap_resize).on("scroll",i.wrap_scroll).on("keydown",i.wrap_keydown).delegate("[data-njb-close]","click",i.wrap_close).delegate("[data-njb-ok]","click",i.wrap_ok).delegate("[data-njb-cancel]","click",i.wrap_cancel).delegate("[data-njb-prev]","click",i.wrap_prev).delegate("[data-njb-next]","click",i.wrap_next),i.window_resize=function(t){e.position()},i.window_scroll=function(t){e.position()},i.window_orientation=function(t){e.position()},this.v.window.on("resize",i.window_resize).on("scroll",i.window_scroll).on("orientationchange",i.window_orientation),i.focusCatch=function(t){e._setFocusInPopup(e.items[e.state.active])},this.v.focusCatcher.on("focus",i.focusCatch),this._cb("events_setted")}},{key:"_removeEventsHandlers",value:function(){var t=this._handlers;this.v.container.off("resize",t.container_resize).off("scroll",t.container_scroll),this.v.wrap.off("click",t.wrap_out).off("resize",t.wrap_resize).off("scroll",t.wrap_scroll).off("keydown",t.wrap_keydown).undelegate("[data-njb-close]","click",t.wrap_close).undelegate("[data-njb-ok]","click",t.wrap_ok).undelegate("[data-njb-cancel]","click",t.wrap_cancel).undelegate("[data-njb-prev]","click",t.wrap_prev).undelegate("[data-njb-next]","click",t.wrap_next),this.v.window.off("resize",t.window_resize).off("scroll",t.window_scroll).off("orientationchange",t.window_orientation);var e=t.elsClick;this._handlers={elsClick:e},this.v.focusCatcher.off("focus",t.focusCatch),this._cb("events_removed")}},{key:"_preloader",value:function(t,e){var i=this.o;switch(t){case"show":e.o.preloader=!0,e.dom.preloader=d(i.templates.preloader),e.dom.preloader.attr("title",i.text.preloader),e.dom.modal.addClass("njb--loading"),e.dom.body[0].appendChild(e.dom.preloader[0]);break;case"hide":if(!e.o.preloader)return;e.dom.preloader[0].parentElement.removeChild(e.dom.preloader[0]),e.dom.modal.removeClass("njb--loading"),delete e.dom.preloader,delete e.o.preloader}}},{key:"_scrollbar",value:function(e){var i=this.o;switch(e){case"hide":if("hide"===i.scrollbar){if(this.state.scrollbarHidden)return;if(this.v.container[0]===this.v.body[0]){var n=(document.documentElement.scrollHeight||document.body.scrollHeight)>document.documentElement.clientHeight;this.v.container[0].njb_scrollbar||this.state.scrollbarHidden||!n&&"scroll"!==this.v.html.css("overflowY")&&"scroll"!==this.v.body.css("overflowY")||(this.v.html.addClass("njb-hideScrollbar"),this.v.html.css("paddingRight",parseInt(this.v.html.css("paddingRight"))+t.g.scrollbarSize+"px"))}else{var n=this.v.container[0].scrollHeight>this.v.container[0].clientHeight;this.v.container.addClass("njb-hideScrollbar")}this.state.scrollbarHidden=!0,this.v.container[0].njb_scrollbar?this.v.container[0].njb_scrollbar++:this.v.container[0].njb_scrollbar=1}break;case"show":if(!this.state.scrollbarHidden)return;if(--this.v.container[0].njb_scrollbar)return void delete this.state.scrollbarHidden;if(this.v.container[0].njb_scrollbar=null,this.v.container[0]===this.v.body[0]){this.v.html.removeClass("njb-hideScrollbar");var o=parseInt(this.v.html.css("paddingRight"))-t.g.scrollbarSize;o?this.v.html.css("paddingRight",o+"px"):this.v.html[0].style.paddingRight=""}else{this.v.container.removeClass("njb-hideScrollbar");var o=parseInt(this.v.container.css("paddingRight"))-t.g.scrollbarSize;o?this.v.container.css("paddingRight",o+"px"):this.v.container[0].style.paddingRight=""}delete this.state.scrollbarHidden}}},{key:"_backdrop",value:function(t){var e=this.o,i=this;switch(t){case"show":if(this.v.backdrop=d(e.templates.backdrop),this.state.backdropVisible)return;e.backdrop===!0&&(e.backdropassist&&this.v.backdrop.css("transitionDuration",this._globals.animShowDur+"ms"),"absolute"===e.position&&this.v.backdrop.addClass("njb-absolute"),this.v.container[0].appendChild(this.v.backdrop[0]),setTimeout(function(){i.v.backdrop.addClass("njb-visible")},0),this.state.backdropVisible=!0);break;case"hide":if(!this.state.backdropVisible)return;e.backdropassist&&this.v.backdrop.css("transitionDuration",this._globals.animHideDur+"ms"),this.v.backdrop.removeClass("njb-visible"),setTimeout(function(){i.v.backdrop[0].parentNode.removeChild(i.v.backdrop[0]),e.backdropassist&&(i.v.backdrop[0].style.cssText=""),delete i.state.backdropVisible},i._getAnimTime(i.v.backdrop[0]))}}},{key:"_calculateAnimations",value:function(){var t,e,i,n,o,s=this.o,r=!1;s.anim&&(o=s.anim.split(" "),t=o[0],e=o[1]?o[1]:o[0]),s.duration&&(s.duration=s.duration.toString(),o=s.duration.split(" "),i=o[0],n=o[1]?o[1]:o[0]);var a=document.createElement("div");a.style.cssText="visibility: hidden; position: absolute;",i&&"auto"!==i||!t?i=parseInt(i)||0:(a.className=(s.animclass||"")+" "+t,document.body.appendChild(a),r=!0,i=this._getAnimTime(a)),n&&"auto"!==n||!e?n=parseInt(n)||0:(a.className=(s.animclass||"")+" "+e,r||(document.body.appendChild(a),r=!0),n=this._getAnimTime(a)),r&&document.body.removeChild(a),this._globals.animShow=t,this._globals.animHide=e,this._globals.animShowDur=i,this._globals.animHideDur=n}},{key:"_getAnimTime",value:function(t,e){return this._getMaxTransitionDuration(t,"animation")||this._getMaxTransitionDuration(t,"transition")}},{key:"_getMaxTransitionDuration",value:function(t,e){var i,n,o,s,r=d(t),a=[];if(!r.length)return 0;if(!e)return 0;i=r.css(e+"Duration"),o=r.css(e+"Delay"),i&&void 0!==i||(i="0s"),n=i.split(", ");for(var l=0,c=n.length;l<c;l++)n[l]=n[l].indexOf("ms")>-1?parseFloat(n[l]):1e3*parseFloat(n[l]);o&&void 0!==o||(o="0s"),s=o.split(", ");for(var l=0,c=s.length;l<c;l++)s[l]=s[l].indexOf("ms")>-1?parseFloat(s[l]):1e3*parseFloat(s[l]);for(var l=0,c=n.length;l<c;l++)a[l]=n[l]+s[l];return Math.max.apply(Math,a)}},{key:"_anim",value:function(t,e){function i(){o.animclass&&r.removeClass(o.animclass),r.removeClass(a),e||s._cb("shown"),s._setFocusInPopup(s.items[s.state.active],!0)}function n(){o.animclass&&r.removeClass(o.animclass),l===a&&r.removeClass("njb-anim-reverse"),r.removeClass(l),s._clear(),e||s._cb("hidden"),s.state.state="inited"}var o=this.o,s=this,r=(this.items[this.state.active].dom.modalOuter,this.items[this.state.active].dom.modal),a=this._globals.animShow,l=this._globals.animHide,c=this._globals.animShowDur,d=this._globals.animHideDur;switch(t){case"show":this.v.wrap.addClass("njb-visible"),a?(o.animclass&&r.addClass(o.animclass),r.addClass(a),setTimeout(i,c)):i();break;case"hide":this.v.wrap.removeClass("njb-visible"),l?(o.animclass&&r.addClass(o.animclass),l===a&&r.addClass("njb-anim-reverse"),r.addClass(l),setTimeout(n,d)):n()}}},{key:"_clear",value:function(){function t(t){for(;t.firstChild;)t.removeChild(t.firstChild)}var e=this.o;this.v.container&&this.v.container[0].njb_instances--,0===this.v.container[0].njb_instances&&this.v.container.removeClass("njb-open"),e.class&&this.v.wrap.removeClass(e.class),this._scrollbar("show"),this.v.wrap&&this.v.wrap.length&&this.v.wrap[0].parentNode.removeChild(this.v.wrap[0]),this._removeSelectorItemsElement(),this.v.items&&this.v.items.length&&t(this.v.items[0]);for(var i=0,n=this.items.length;i<n;i++)this.items[i].dom.modalOuter[0].style.cssText="";var o=this.state.gallery;this.state={inited:!0,state:"inited",active:0,gallery:o},this._cb("clear")}},{key:"_error",value:function(t,e){t&&(e&&this._clear(),console.error(t))}},{key:"_cb",value:function(t){var e,i=this.o;"inited"!==t&&"show"!==t&&"shown"!==t&&"hide"!==t&&"hidden"!==t&&"destroy"!==t&&"destroyed"!==t||(this.state.state=t),this.trigger.apply(this,arguments);var n=Array.prototype.slice.call(arguments);i.oncb&&"function"==typeof i.oncb&&(e=i.oncb.apply(this,n)),this.trigger.apply(this,["cb"].concat(n));var o=Array.prototype.slice.call(arguments,1);if("ok"===t||"cancel"===t){var s=this.items[this.state.active].dom.modal,r=s.find("[data-njb-return]"),a=void 0;r.length&&(a=r[0].value||null),o.unshift(a),this.returnValue=a}return"function"==typeof i["on"+t]&&(e=i["on"+t].apply(this,o)),e}},{key:"on",value:function(t,e){return this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(e),this}},{key:"off",value:function(t,e){if(this._events=this._events||{},t in this._events!=!1)return this._events[t].splice(this._events[t].indexOf(e),1),this}},{key:"trigger",value:function(t){if(this._events=this._events||{},t in this._events!=!1){for(var e=0;e<this._events[t].length;e++)this._events[t][e].apply(this,Array.prototype.slice.call(arguments,1));return this}}}]),t}();document.body&&!h.g&&(h.g=(0,c.getDefaultInfo)()),h.a={},h.defaults=c.defaults,h.get=function(t){var e=d(t)[0];return e?e.njBox||null:null},h.autobind=function(){d(h.defaults.autobind).each(function(){if(this.njBox)return void console.error("njBox, already inited on this element");new h({elem:d(this)})})},"undefined"!=typeof window&&d(function(){h.autobind()}),h.alert=function(t,e,i){return new h({content:function(e){return'<div class="njb__body">\n                                    '+(t||this.o.text._missedContent)+'\n                                  </div>\n                                  <div class="njb__footer">\n                                    <button data-njb-ok>'+this.o.text.ok+"</button>\n                                  </div>"},type:"template",out:!1,onok:e,oncancel:i}).show()},h.confirm=function(t,e,i){return new h({content:function(e){return'<div class="njb__body">\n                                    '+(t||this.o.text._missedContent)+'\n                                  </div>\n                                  <div class="njb__footer">\n                                    <button data-njb-ok>'+this.o.text.ok+"</button>\n                                    <button data-njb-cancel>"+this.o.text.cancel+"</button>\n                                  </div>"},type:"template",out:!1,onok:e,oncancel:i}).show()},h.prompt=function(t,e,i,n){return"function"==typeof e&&(n=i,i=e,e=""),new h({content:function(i){return'<div class="njb__body">\n                                    '+(t||this.o.text._missedContent)+'\n                                    <div>\n                                      <input data-njb-return type="text" placeholder="'+(e||"")+'" />\n                                    </div>\n                                  </div>\n                                  <div class="njb__footer">\n                                    <button data-njb-ok>'+this.o.text.ok+"</button>\n                                    <button data-njb-cancel>"+this.o.text.cancel+"</button>\n                                  </div>"},type:"template",out:!1,onok:i,oncancel:n}).show()},e.default=h,t.exports=e.default},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function t(e){return e=e||"",new t.fn.init(e)};o.match=function(t,e){return t===document&&(t=document.documentElement),(t.matches||t.matchesSelector||t.oMatchesSelector||t.mozMatchesSelector||t.webkitMatchesSelector||t.msMatchesSelector).call(t,e)},o.fn=o.prototype,o.fn.init=function(t){var e;"string"==typeof t&&t.length>0?e="<"===t.charAt(0)&&">"===t.charAt(t.length-1)?o.str2dom?o.str2dom(t):[]:document.querySelectorAll(t):t instanceof Array||t instanceof NodeList||t instanceof HTMLCollection||t instanceof o?e=t:t.nodeType||window.Node&&t instanceof Node||t==t.window||"object"===(void 0===t?"undefined":n(t))?e=[t]:"function"==typeof t?(e=[document],document.addEventListener("DOMContentLoaded",t)):e=[],this.length=e.length;for(var i=0,s=this.length;i<s;i++)this[i]=e[i];return this},o.fn.init.prototype=o.fn,o.fn.each=function(t){for(var e=0,i=this.length;e<i&&t.call(this[e],e,this[e])!==!1;e++);return this},o.str2dom=function(t){var e=document.createElement("div");return e.innerHTML=t,e.childNodes},o.isArray=function(t){return"array"===o.type(t)},o.isFunction=function(t){return"function"==o.type(t)},o.isPlainObject=function(t){var e,i={},n={}.hasOwnProperty;if(!t||"object"!==o.type(t)||t.nodeType||o.isWindow(t))return!1;try{if(t.constructor&&!n.call(t,"constructor")&&!n.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}if(i.ownLast)for(e in t)return n.call(t,e);for(e in t);return void 0===e||n.call(t,e)},o.isWindow=function(t){return null!=t&&t==t.window},o.type=function(t){var e=e={"[object Array]":"array","[object Boolean]":"boolean","[object Date]":"date","[object Error]":"error","[object Function]":"function","[object Number]":"number","[object Object]":"object","[object RegExp]":"regexp","[object String]":"string"},i=e.toString;return null==t?t+"":"object"===(void 0===t?"undefined":n(t))||"function"==typeof t?e[i.call(t)]||"object":void 0===t?"undefined":n(t)},o.extend=function(){var t,e,i,s,r,a,l=arguments[0]||{},c=1,d=arguments.length,h=!1;for("boolean"==typeof l&&(h=l,l=arguments[c]||{},c++),"object"===(void 0===l?"undefined":n(l))||o.isFunction(l)||(l={}),c===d&&(l=this,c--);c<d;c++)if(null!=(r=arguments[c]))for(s in r)t=l[s],i=r[s],l!==i&&(h&&i&&(o.isPlainObject(i)||(e=o.isArray(i)))?(e?(e=!1,a=t&&o.isArray(t)?t:[]):a=t&&o.isPlainObject(t)?t:{},l[s]=o.extend(h,a,i)):void 0!==i&&(l[s]=i));return l},o.inArray=function(t,e,i){return null==e?-1:e.indexOf(t,i)},o.fn.attr=function(t){return this[0].getAttribute(t)},o.fn.find=function(t){var e,i=[];return this.each(function(n){e=Array.prototype.slice.call(this.querySelectorAll(t),""),e.length&&(i=i.concat(e))}),o(i)},o.fn.on=function(t,e){return this.each(function(){this.addEventListener(t,e,!1)})},o.fn.off=function(t,e){return this.each(function(){this.removeEventListener(t,e)})},o.fn.delegate=function(t,e,i){return this.each(function(n){var s=this;this._events||(this._events={}),this._events[e]||(this._events[e]=[]);var r=function(e){var n=e&&e.target||window.event.srcElement,r=e.path;if(!r){r=[];for(var a=n;a;)r.push(a),a=a.parentNode}for(var l=0,c=r.length;l<c&&r[l]!==s;l++)if(r[l]!==document&&o.match(r[l],t)){i.call(r[l],e);break}};r.fn=i,this.addEventListener(e,r,!1),this._events[e].push(r)})},o.fn.undelegate=function(t,e,i){return i||(i=e,e=t),this.each(function(t){var n=this._events,o=this._events[e];if(n&&o){for(var t=0,s=o.length;t<s;t++)if(i===o[t].fn){this.removeEventListener(e,o[t]),delete o[t].fn,o.splice(t,1);break}o.length||delete n[e];var r=!0;for(var a in n)if(n.hasOwnProperty(a)){r=!1;break}r&&delete this._events}})},o.fn.trigger=o.fn.triggerHandler=function(t,e){return this.each(function(i){var n=new CustomEvent(t,{detail:e||null});this.dispatchEvent(n)})},o.fn.data=function(t,e){return this[0].dataset},o.parseJSON=function(t){return JSON.parse(t)},o.fn.css=function(t,e){function i(t){var e,i,n=["Webkit","Moz","O","ms"],s=t.charAt(0).toUpperCase()+t.slice(1),r=o[0];if(t in r.style)i=t;else for(var a=0;a<n.length;a++){if((e=n[a]+s)in r.style){n[a],i=e;break}e=void 0}return i}var o=this;if(t)return"float"==t&&(t="styleFloat"),"object"===(void 0===t?"undefined":n(t))?this.each(function(){for(var e in t)this.style[i(e)]=t[e]}):e?this.each(function(){this.style[i(t)]=e}):getComputedStyle(this[0],null)[i(t)]||void 0},o.fn.hasClass=function(t){return this[0].classList.contains(t)},o.fn.addClass=function(t){var e=t.split(" ");return this.each(function(){for(var t=0,i=e.length;t<i;t++)this.classList.add(e[t])})},o.fn.removeClass=function(t){var e=t.split(" ");return this.each(function(t){for(var t=0,i=e.length;t<i;t++)this.classList.remove(e[t])})},o.fn.closest=function(t){for(var e,i=[],n=0,s=this.length;n<s;n++)if(o.match(this[n],t))i.push(this[n]);else for(e=this[n].parentNode,e===document&&(e=document.documentElement);e&&"HTML"!==e.tagName;)o.match(e,t)&&o.inArray(e,i)===-1&&i.push(e),e=e.parentNode;return o(i)},e.default=o,t.exports=e.default},function(t,e,i){"use strict";function n(){function t(t){var i,n,o,s=["Webkit","Moz","O","ms"],r=t.charAt(0).toUpperCase()+t.slice(1),a=document.createElement("div");if(document.body.insertBefore(a,null),t in a.style)n=t,o=null;else for(var l=0;l<s.length;l++){if((i=s[l]+r)in a.style){o=s[l];break}i=void 0}var c={js:n||i,css:e(t,o)};if("transform"===t){if(void 0!==a.style[c.js]){a.style[c.js]="translate3d(1px,1px,1px)";var d=window.getComputedStyle(a)[c.js]}c["3d"]=void 0!==d&&d.length>0&&"none"!==d}return document.body.removeChild(a),c}function e(t,e){if(t=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),null===e)return t;var i=void 0;switch(e){case"Webkit":i="-webkit-"+t;break;case"Moz":i="-moz-"+t;break;case"ms":i="-ms-"+t;break;case"O":i="-o-"+t}return i}var i={},n=document.createElement("div");n.style.cssText="width: 99px; height: 99px; overflow: scroll; position: absolute; top: -99px;",document.body.appendChild(n),i.scrollbarSize=n.offsetWidth-n.clientWidth||0,document.body.removeChild(n),i.oldIE=!(!document.all||document.addEventListener),i.touch="ontouchstart"in window;var o=i;return o.nativeDialogSupport=!!document.createElement("dialog").showModal,o.transition=t("transition"),o.transitionDuration=t("transitionDuration"),o.transform=t("transform"),o.animation=t("animation"),i}Object.defineProperty(e,"__esModule",{value:!0}),e.getDefaultInfo=n;e.defaults={elem:"",container:"body",position:"fixed",click:!0,clickels:"",backdrop:!0,backdropassist:!0,scrollbar:"hide",out:!0,esc:!0,close:"outside",autoheight:"image",autofocus:"",img:"ready",imgload:"show",gallery:"",arrows:!0,title:!1,title_attr:"title",start:!1,loop:!0,content:void 0,_missedContent:"njBox plugin: meow, put some content here...",type:"",header:void 0,footer:void 0,class:!1,zindex:!1,anim:"scale",animclass:"animated",duration:"auto",templates:{wrap:'<div class="njb-wrap"><div class="njb-items"></div></div>',backdrop:'<div class="njb-backdrop"></div>',modalOuter:'<div class="njb-outer" data-njb-outer></div>',modal:'<aside class="njb" tabindex="-1"></aside>',body:'<div class="njb__body" data-njb-body></div>',header:'<header class="njb__header" data-njb-header></header>',footer:'<footer class="njb__footer" data-njb-footer></footer>',close:'<button type="button" class="njb-close-system" data-njb-close>×</button>',focusCatcher:'<a href="#!" class="njb-focus-catch">This link is just focus catcher of modal window, link do nothing.</a>',preloader:'<div class="njb-preloader"><div class="njb-preloader__inner"><div class="njb-preloader__bar1"></div><div class="njb-preloader__bar2"></div><div class="njb-preloader__bar3"></div></div></div>',prev:'<button type="button" class="njb-arrow njb-arrow--prev" data-njb-prev></button>',next:'<button type="button" class="njb-arrow njb-arrow--next" data-njb-next></button>'},text:{_missedContent:"njBox plugin: meow, put some content here...",imageError:'<a href="%url%">This image</a> can not be loaded.',close:"Close (Esc)",prev:"Previous (Left arrow key)",next:"Next (Right arrow key)",ok:"Ok",cancel:"Cancel",placeholder:""},_focusable:'a[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), [tabindex]:not([tabindex="-1"]), [contenteditable]',jquery:void 0,autobind:'[data-toggle~="box"], [data-toggle~="modal"]'}},function(t,e,i){t.exports=i(0)}])});