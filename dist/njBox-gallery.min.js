!function(t){function e(s){if(i[s])return i[s].exports;var n=i[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,e),n.l=!0,n.exports}var i={};e.m=t,e.c=i,e.d=function(t,i,s){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:s})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,i){"use strict";/*!
 * njBox gallery addon
 * nejikrofl@gmail.com
 * Copyright (c) 2017 N.J.
 * MIT license
*/
!function(){function t(t){return"[object Array]"===Object.prototype.toString.call(t)}var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.njBox;e&&e.addAddon("gallery",{options:{gallery:"",arrows:!0,start:!1,loop:!0,preload:"1 1"},templates:{count:'<div class="njb-ui__count"><span data-njb-current>1</span> / <span data-njb-total>1</span></div>',prev:'<button type="button" class="njb-ui__arrow njb-ui__arrow--prev" data-njb-prev></button>',next:'<button type="button" class="njb-ui__arrow njb-ui__arrow--next" data-njb-next></button>'},text:{current:"Current slide",total:"Total slides",prev:"Previous gallery item",next:"Next gallery item"},prototype:{_gallery_init:function(){var e=this,i=this.o;i.gallery?(e._g.gallery=!0,"popover"===i.layout&&(i.layout="fixed")):t(i.content)&&(e._g.gallery=!0),e._g.gallery&&(this.on("items_gather",function(){this._g_createRawItems()}),this.on("dom_create",function(){this.$.extend(this.dom,this._g_createDom()),this.dom.ui.append(this.dom.ui_count),i.arrows&&this._g.gallery&&!this._g.arrowsInserted&&(this.dom.next[0]&&this.dom.ui.append(this.dom.next),this.dom.prev[0]&&this.dom.ui.append(this.dom.prev),this._g.arrowsInserted=!0)}),this.on("item_create",function(t,e){t.dom.modalOuter.attr("data-njb-index",e)}),this.on("item_loaded",function(t){!this.queue||t!==this.queue.prev.item&&t!==this.queue.next.item||(e._cb("item_ready",t),this.position())}),this.on("item_ready",function(t){}),this.on("dom_insert",function(){this._g_setQueue(this.state.active),e._g_uiUpdate()}),this.on("change",function(){e._g_uiUpdate()}),this.on("changed",function(){this._g_preload()}),this.on("listeners_added",function(){var t=(this.o,this),e=this._handlers;e.wrap_prev=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1,t.prev()},e.wrap_next=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1,t.next()},this.dom.wrap.delegate("[data-njb-prev]","click",e.wrap_prev).delegate("[data-njb-next]","click",e.wrap_next)}),this.on("listeners_removed",function(){var t=this._handlers;e.dom.wrap.undelegate("[data-njb-prev]","click",t.wrap_prev).undelegate("[data-njb-next]","click",t.wrap_next),delete t.wrap_prev,delete t.wrap_next}),this.on("position",function(){"shown"===this.state.status&&(null!==this.queue.prev.index&&this._setMaxHeight(this.items[this.queue.prev.index]),null!==this.queue.next.index&&this._setMaxHeight(this.items[this.queue.next.index]))}),this.on("show",function(){this.state.active=this._g_detectIndexForOpen()}),this.on("shown",function(){this._g_drawItemSiblings(),this._g_preload()}),this.on("keydown",function(t){switch(this.o,t.which){case 37:t.preventDefault?t.preventDefault():t.returnValue=!1,e.prev();break;case 39:t.preventDefault?t.preventDefault():t.returnValue=!1,e.next()}}))},prev:function(){return this._g_changeItem(this.state.active-1,"prev"),this},next:function(){return this._g_changeItem(this.state.active+1,"next"),this},goTo:function(t){if("number"!=typeof(t-=1))return void this._error("njBox, wrong index argument in goTo method.");if("inited"===this.state.status||"show"===this.state.status)return void(this.state.active=t);if("shown"!==this.state.status||t===this.state.active||t<0||t>this.items.length-1)return this._error("njBox, wrong index in goTo method."),this;var e=t>this.state.active?"next":"prev";if("next"===e&&t===this.state.active+1)this.next();else if("prev"===e&&t===this.state.active-1)this.prev();else switch(this.queue.prev.dom.modalOuter[0].parentNode.removeChild(this.queue.prev.dom.modalOuter[0]),this.queue.next.dom.modalOuter[0].parentNode.removeChild(this.queue.next.dom.modalOuter[0]),this.queue.prev.dom.modalOuter[0].style.cssText="",this.queue.next.dom.modalOuter[0].style.cssText="",e){case"next":this.queue.prev=this._g_getQueueItem(null),this.queue.next=this._g_getQueueItem(t),this._g_drawItemSiblings(),this._g_changeItem(t,"next");break;case"prev":this.queue.prev=this._g_getQueueItem(t),this.queue.next=this._g_getQueueItem(null),this._g_drawItemSiblings(),this._g_changeItem(t,"prev")}return this},_g_inQueue:function(t){},_g_createDom:function(){var t={},e=(this.o,this.$);return t.ui_count=e(this._templates.count),t.ui_current=t.ui_count.find("[data-njb-current]"),t.ui_current.attr("title",this._text.current),t.ui_total=t.ui_count.find("[data-njb-total]"),t.ui_total.attr("title",this._text.total),t.prev=e(this._templates.prev),t.prev.attr("title",this._text.prev),t.next=e(this._templates.next),t.next.attr("title",this._text.next),t},_g_makeUnfocusable:function(t,e){var i,s=this.$,n=s(t),r=[];return n.length?(i=n.find(e),i.each(function(){r.push({el:s(this),tabindex:this.tabIndex||null}),this.tabIndex="-1"}),r):r},_g_restoreUnfocusable:function(t){var e=(t.item,t.tabs);e&&e.forEach(function(t){null!==t.tabindex?t.el.attr("tabindex",t.tabindex):t.el[0].removeAttribute("tabindex")})},_g_preload:function(){function t(t){if(null!==t){var e=this.items[t],i=e.content;"loading"!==e.state.status&&"loaded"!==e.state.status&&"image"===e.type&&(document.createElement("img").src=i)}}var e=this.o;if(e.preload&&"shown"===this.state.status){for(var i=e.preload.split(" "),s=parseInt(i[0]),n=this._g_getItemsOrder(this.queue.prev.index)[0],r=parseInt(i[1]),a=this._g_getItemsOrder(this.queue.next.index)[2];r--;)t.call(this,a),a=this._g_getItemsOrder(a)[2];for(;s--;)t.call(this,n),n=this._g_getItemsOrder(n)[0]}},_g_drawItemSiblings:function(){var t=this.o,e=this;"number"==typeof e.queue.prev.index&&(e._g_moveItem(e.queue.prev.item,-110,"%"),this._drawItem({item:e.queue.prev.item,container:e.dom.items,prepend:!0}),e.queue.prev.tabs=e._g_makeUnfocusable(e.queue.prev.item.dom.modal,t._focusable)),"number"==typeof e.queue.next.index&&(e._g_moveItem(e.queue.next.item,110,"%"),this._drawItem({item:e.queue.next.item,container:e.dom.items,prepend:!1}),e.queue.next.tabs=e._g_makeUnfocusable(e.queue.next.item.dom.modal,t._focusable)),e.position()},_g_moveItem:function(t,i,s){s=s||"px",e.g.transform["3d"]?t.dom.modalOuter[0].style.cssText=e.g.transform.css+": translate3d("+(i+s)+",0,0)":e.g.transform.css?t.dom.modalOuter[0].style.cssText=e.g.transform.css+": translateX("+(i+s)+")":t.dom.modalOuter[0].style.cssText="left:"+(i+s)},_g_changeItem:function(t,e){function i(t){t.dom.modalOuter[0].parentNode.removeChild(t.dom.modalOuter[0]),t.dom.modalOuter[0].style.cssText=""}if(1!==this.items.length&&t!==this.state.active&&!this.state.itemChanging){var s=this.o,n=this,r=this.$.extend(!0,{},this.queue);if(!this.items[t]){if(!(s.loop&&this.items.length>2))return;if("next"===e&&t===this.items.length)t=0;else{if("prev"!==e||-1!==t)return;t=this.items.length-1}}switch(this.state.direction=e,this.state.itemChanging=!0,this.state.active=t,this._cb("change",t),this._uiUpdate(),this._g_setQueue(t),this._g_restoreUnfocusable(r.prev),this._g_restoreUnfocusable(r.next),e){case"prev":r.prev.item.dom.body[0].style.verticalAlign="middle",this._g_moveItem(r.current.item,110,"%"),this._g_moveItem(r.prev.item,0,"%");break;case"next":r.next.item.dom.body[0].style.verticalAlign="middle",this._g_moveItem(r.current.item,-110,"%"),this._g_moveItem(r.next.item,0,"%")}setTimeout(function(){if("shown"!==n.state.status)return void(n.state.itemChanging=!1);i(r.current.item);var t="prev"===e?r.next.index:r.prev.index;n.items[t]&&i(n.items[t]),n._g_drawItemSiblings(),n._set_focus(n.items[n.state.active]),n.state.itemChanging=!1,n._cb("changed",n.state.active)},this._getAnimTime(r.current.item.dom.modalOuter))}},_g_detectIndexForOpen:function(){var t,e=this,i=this.o,s=this.$,n=this.state.arguments.show[0],r=parseInt(i.start);return this._g.els&&this._g.els.length&&this.state.clickedEl&&this._g.els.each(function(i,s){if(e.state.clickedEl===s)return void(t=i)}),"number"!=typeof r||isNaN(r)||(t=r-1),"string"==typeof n?n=parseInt(n):s.isPlainObject(n)&&(n=parseInt(n.index)),"number"==typeof n&&(t=n-1),"number"==typeof t&&this.items[t]||(t=0),t},_g_setQueue:function(t){var e=this._g_getItemsOrder(t);this.queue={prev:this._g_getQueueItem(e[0]),current:this._g_getQueueItem(e[1]),next:this._g_getQueueItem(e[2])}},_g_getItemsOrder:function(t){var e=this.o,i=t-1,s=t+1;return e.loop&&this.items.length>2&&(-1===i&&(i=this.items.length-1),s===this.items.length&&(s=0)),this.items[i]||(i=null),this.items[s]||(s=null),[i,t,s]},_g_getQueueItem:function(t){var e;return e=null===t?null:this.items[t],{index:t,item:e}},_g_uiUpdate:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.active,e=this.dom,i=this.o;this.items[t]||this._error("njBox, can't update ui info from item index - "+t),e.wrap.find("[data-njb-current]").html(t+1||""),e.wrap.find("[data-njb-total]").html(this.items.length||""),0===t?(this.state.gallery_first=!0,e.ui.addClass("njb-ui--first")):(this.state.gallery_first=!1,e.ui.removeClass("njb-ui--first")),t===this.items.length-1?(this.state.gallery_last=!0,e.ui.addClass("njb-ui--last")):(this.state.gallery_last=!1,e.ui.removeClass("njb-ui--last")),1===this.items.length?(this.state.gallery_only=!0,e.ui.addClass("njb-ui--only")):(this.state.gallery_only=!1,e.ui.removeClass("njb-ui--only")),i.loop&&this.items.length>=3?(this.state.gallery_noloop=!1,e.ui.removeClass("njb-ui--no-loop")):(this.state.gallery_noloop=!0,e.ui.addClass("njb-ui--no-loop")),this.state.gallery_noloop&&(this.state.gallery_first?e.prev.attr("disabled",!0):e.prev[0].removeAttribute("disabled"),this.state.gallery_last?e.next.attr("disabled",!0):e.next[0].removeAttribute("disabled"))},_g_createRawItems:function(){var e=this.o;if(t(e.content))this._g.rawItems=e.content;else if(this._g.els=this._g_gatherElements(e.gallery),this._g.rawItems=[],this._g.els&&this._g.els.length)for(var i=0;i<this._g.els.length;i++){var s=this._g.els[i],n=this._gatherData(s);this._cb("item_gathered",n,s),this._g.rawItems.push(n)}},_g_gatherElements:function(t){return t?this.o.$elem.find(t):this.o.$elem}}})}()}]);