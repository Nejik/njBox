!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("njBox",[],e):"object"==typeof exports?exports.njBox=e():t.njBox=e()}(this,function(){return function(t){function e(i){if(o[i])return o[i].exports;var n=o[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,e),n.l=!0,n.exports}var o={};return e.m=t,e.c=o,e.i=function(t){return t},e.d=function(t,o,i){e.o(t,o)||Object.defineProperty(t,o,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/",e(e.s=3)}([function(t,e,o){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}(),r=o(1),l=i(r),d=o(2),c=window.jQuery||l.default,h=function(t,e,o){var i=function(){function i(t,o){if(n(this,i),!arguments.length)return void console.error("njBox, arguments not passed.");var s=void 0,a=this;!o&&t?s=c.isPlainObject(t)?t:{elem:t}:(s=o,s.elem=t),s=s||{},this.co=s,e(function(){a._init()},0)}return a(i,[{key:"_init",value:function(){if(!this.state||!this.state.inited){var t=this.co;delete this.co,i.g||(i.g=(0,d.getDefaultInfo)()),this.state={active:0},this._globals={},this._handlers={},this.data={optionsPassed:t};var e=this.o=c.extend({},i.defaults,t);e.jquery&&(c=e.jquery),this.$=c,this.dom={document:c(o),window:c(window),html:c(o.documentElement),body:c(o.body)};for(var n in i.addons)i.addons.hasOwnProperty(n)&&this["_"+n+"_init"]();if(!e.elem&&!e.content)return void this._e("njBox, no elements (o.elem) or content (o.content) for modal.");if(e.elem){var s=c(e.elem);if(!s.length)return void this._e("njBox, element not found ("+e.elem+")");if(s.length>1&&(s=c(s[0])),s[0].njBox)return void this._e("njBox, already inited on this element");s[0].njBox=this,this.data.optionsGathered=this._gatherData(s),this._cb("options_gathered",this.data.optionsGathered,s[0]),c.extend(!0,this.o,this.data.optionsGathered)}this._cb("options_setted",e),this._options_setted(),this._createDom(),this.items=this._createItems(),this._calculateAnimations(),this._addClickHandlers(),this.state.inited=!0,this._cb("inited")}}},{key:"show",value:function(e){this._init(),e!==t&&(this.state.active=e-1);this.o;if("inited"!==this.state.state)return void this._e("njBox, show, plugin not inited or in not inited state(probably plugin is already visible or destroyed, or smth else..)");if(!this.items.length)return void this._e("njBox, smth goes wrong, plugin don't create any item to show",!0);if(this._cb("show")!==!1){this.state.focused||(this.state.focused=o.activeElement),this.returnValue=null,this.dom.container[0].njb_instances?this.dom.container[0].njb_instances++:this.dom.container[0].njb_instances=1,this._scrollbar("hide"),this._backdrop("show");var i;return this._globals.popover?i=this.dom.container[0]:(this.dom.container[0].appendChild(this.dom.wrap[0]),i=this.dom.items[0]),this._addListeners(),this._drawItem(this.items[this.state.active],!1,i),this._cb("inserted"),this.position(),this.dom.wrap[0].style.display="none",this.dom.wrap[0].clientHeight,this.dom.wrap[0].style.display="block",this._uiUpdate(),this._anim("show"),this}}},{key:"hide",value:function(){if("shown"!==this.state.state)return void this._e("njBox, hide, we can hide only showed modal (probably animation is still running or plugin destroyed).");if(this._cb("hide")!==!1)return this.state.focused&&this.state.focused.focus(),this._backdrop("hide"),this._removeListeners(),this._anim("hide"),this}},{key:"position",value:function(e){if(this.state&&this.state.inited){var o,i=this.o,n=this.items[this.state.active].dom.modal,s=this.state;if(s.dimensions=this._getContainerSize(),s.dimensions.modal=this._getDomSize(this.items[this.state.active].dom.modal[0]),s.dimensions.clickedEl=this._getDomSize(this.state.clickedEl),"absolute"===i.layout){var a=this.state.dimensions.containerScrollTop,r=this.state.dimensions.containerScrollLeft;a<=this.state.dimensions.containerMaxScrollTop&&this.dom.wrap.css({top:a+"px",left:r+"px"}),this.dom.backdrop.css({width:"auto",height:"auto"}),this.dom.backdrop[0].clientHeight,this.dom.backdrop.css({width:this.state.dimensions.containerScrollWidth+"px",height:this.state.dimensions.containerScrollHeight+"px"})}this._globals.popover||this._setMaxHeight(this.items[this.state.active]),i.coords&&(o=(0,d.getArray)(i.coords)),e&&(o=(0,d.getArray)(e));var l=this._cb("position");return l!==t&&(o=(0,d.getArray)(l)),"center"===o[0]&&(o[0]=(s.dimensions.containerWidth-s.dimensions.modal.width)/2),"center"===o[1]&&(o[1]=(s.dimensions.containerHeight-s.dimensions.modal.height)/2),this.state.coords=o,this._globals.popover&&2===this.state.coords.length&&n.css("left",this.state.coords[0]+"px").css("top",this.state.coords[1]+"px"),this}}},{key:"destroy",value:function(){return this.state.inited&&"inited"===this.state.state?(this._removeClickHandlers(),this.dom.container.removeClass("njb-relative"),this._cb("destroy"),this._events=this._globals=this._handlers=this.items=this.itemsRaw=this.dom=this.$=t,this.o={},this):void this._e("njBox, we can destroy only initialized && hidden modals.")}},{key:"update",value:function(){return this.items=this._createItems(),this._addClickHandlers(),this}},{key:"_options_setted",value:function(){var t=this.o,e=this;"popover"===t.layout&&(e._globals.popover=!0,t.backdrop=e._getPassedOption("backdrop")||!1,t.scrollbar=e._getPassedOption("scrollbar")||"show",t.out=e._getPassedOption("out")||!0)}},{key:"_getPassedOption",value:function(e){return this.data.optionsGathered[e]!==t?this.data.optionsGathered[e]:this.data.optionsPassed[e]!==t?this.data.optionsPassed[e]:void 0}},{key:"_getContainerSize",value:function(){var t=(this.o,o.documentElement),e=o.body,i={};return this._globals.containerIsBody?(i.containerWidth=t.clientWidth,i.containerHeight=t.clientHeight,i.containerScrollWidth=Math.max(e.scrollWidth,t.scrollWidth,e.offsetWidth,t.offsetWidth,e.clientWidth,t.clientWidth),i.containerScrollHeight=Math.max(e.scrollHeight,t.scrollHeight,e.offsetHeight,t.offsetHeight,e.clientHeight,t.clientHeight),i.containerScrollTop=window.pageYOffset||t.scrollTop||e.scrollTop,i.containerScrollLeft=window.pageXOffset||t.scrollLeft||e.scrollLeft):(i.containerWidth=this.dom.container[0].clientWidth,i.containerHeight=this.dom.container[0].clientHeight,i.containerScrollWidth=this.dom.container[0].scrollWidth,i.containerScrollHeight=this.dom.container[0].scrollHeight,i.containerScrollTop=this.dom.container[0].scrollTop,i.containerScrollLeft=this.dom.container[0].scrollLeft),i.containerMaxScrollTop=i.containerScrollHeight-i.containerHeight,i.winWidth=window.innerWidth||t.clientWidth||e.clientWidth,i.winHeight=window.innerHeight||t.clientHeight||e.clientHeight,i.autoheight=this._globals.containerIsBody?i.winHeight:i.containerHeight,i}},{key:"_getDomSize",value:function(t){var e=t.getBoundingClientRect(),o=this.$.extend({},e);return o.el=t,o.width=o.right-o.left,o.height=o.bottom-o.top,o}},{key:"_setMaxHeight",value:function(t){function e(t,e){return parseInt(t.css(e+"Top"))+parseInt(t.css(e+"Bottom"))||0}var o=this.o;if(o.autoheight&&("image"!==o.autoheight||"image"===t.type)){this.state.autoheightAdded||(o.autoheight===!0?this.dom.wrap.addClass("njb-wrap--autoheight-true"):this.dom.wrap.addClass("njb-wrap--autoheight-image"),this.state.autoheightAdded=!0);var i=t.dom,n=e(i.modal,"margin"),s=e(i.modal,"padding")+parseInt(i.modal.css("borderTopWidth"))+parseInt(i.modal.css("borderBottomWidth"))||0,a=e(i.body,"margin"),r=e(i.body,"padding")+parseInt(i.body.css("borderTopWidth"))+parseInt(i.body.css("borderBottomWidth"))||0,l=this.state.dimensions.autoheight,d=l,c="border-box"===i.body.css("boxSizing"),h=0,u=0;if(i.header&&i.header.length&&(h=i.header[0].scrollHeight+(parseInt(i.header.css("borderTopWidth"))+parseInt(i.header.css("borderBottomWidth")))||0),i.footer&&i.footer.length&&(u=i.footer[0].scrollHeight+(parseInt(i.footer.css("borderTopWidth"))+parseInt(i.footer.css("borderBottomWidth")))||0),d=l-n-s-a-h-u,c||(d-=r),"image"===t.type){var m=l-n-s-a-r-h-u;i.img&&i.img.css("maxHeight",m+"px")}else i.body.css("maxHeight",d+"px")}}},{key:"_gatherData",value:function(t){function e(t){var e={};for(var i in t)if(t.hasOwnProperty(i)&&/^njb[A-Z]+/.test(i)){var n=i.match(/^njb(.*)/)[1],s=n.charAt(0).toLowerCase()+n.slice(1);e[s]=o(t[i])}return e}function o(t){var e=/\s/.test(t),o=e?t:parseFloat(t);return"true"===t||"false"!==t&&(isNaN(o)?t:o)}var i=this.o,n=c(t),s=c.extend(!0,{},n.data()),a={};if(!n.length)return a;if(s.njbOptions)try{a=c.parseJSON(s.njbOptions),delete s.njbOptions}catch(t){return void this._e("njBox, fail to parse options from njb-options")}if(n.length&&(a.el=n),"a"===n[0].tagName.toLowerCase()){var r=n.attr("href");r&&"#"!==r&&"#!"!==r&&!/^(?:javascript)/i.test(r)&&(a.content=r)}if(i.title_attr){var l=n.attr(i.title_attr);l&&(a.title=l)}return c.extend(!0,a,e(s)),a}},{key:"_createItems",value:function(){var t=this.o;this.data.els=this.o.el,this.data.items_raw=[this.o],this._cb("items_raw",this.data),t.buttonrole&&this.data.els&&this.data.els.attr("role",t.buttonrole);for(var e=[],o=0,i=this.data.items_raw.length;o<i;o++)e.push(this._createItem(this.data.items_raw[o],o));return e}},{key:"_createItem",value:function(t,e){var o=this._normalizeItem(t);return this._createDomForItem(o,e),o}},{key:"_normalizeItem",value:function(t,e){var o=void 0;o="function"==typeof t.content?t.content.call(this,t):t.content;var i=o||this.o.text._missedContent;return{content:i,type:t.type||this._type(i),header:t.header,footer:t.footer,title:t.title,el:t.el||e,o:{status:"inited"},raw:t}}},{key:"_type",value:function(t){var e="html";if("object"===(void 0===t?"undefined":s(t))){if(window.jQuery&&t instanceof window.jQuery||window.j&&t instanceof window.j)return"selector"}else{if(/^[#.]\w/.test(t))return"selector";if(/\.(png|jpg|jpeg|gif|tiff|bmp|webp)(\?\S*)?$/i.test(t))return"image"}return e}},{key:"_createDomForItem",value:function(t,e){var i,n,s=this.o,a=t.dom={},r=o.createDocumentFragment();if(a.modal=n=c(s.templates.modal),n[0].tabIndex="-1",n[0].njBox=this,a.modalOuter=i=c(s.templates.modalOuter),s.role&&n.attr("role",s.role),s.label&&n.attr("aria-label",s.label),s.labelledby&&n.attr("aria-labelledby",s.labelledby),s.describedby&&n.attr("aria-describedby",s.describedby),!n.length)return void this._e("njBox, error in o.templates.modal");if(i[0].appendChild(n[0]),"template"===t.type)n.html(t.content);else{if(a.body=c(s.templates.body),!a.body.length)return void this._e("njBox, error in o.templates.body");if(a.bodyInput=(0,d.getItemFromDom)(a.body,"data-njb-body"),this._insertItemBodyContent(t),r.appendChild(a.body[0]),t.header){if(a.header=c(s.templates.header),!a.header.length)return void this._e("njBox, error in o.templates.header");(0,d.getItemFromDom)(a.header,"data-njb-header").html(t.header),r.insertBefore(a.header[0],r.firstChild)}if(t.footer){if(a.footer=c(s.templates.footer),!a.footer.length)return void this._e("njBox, error in njBox.templates.footer");(0,d.getItemFromDom)(a.footer,"data-njb-footer").html(t.footer),r.appendChild(a.footer[0])}"inside"===s.close&&(a.close=c(s.templates.close),a.close.attr("title",s.text.close),r.appendChild(a.close[0])),n[0].appendChild(r)}"image"===t.type?n.addClass("njb--image"):n.addClass("njb--content"),this._globals.popover&&n.addClass("njb--popover"),this._cb("item_domready",t,e)}},{key:"_insertItemBodyContent",value:function(t){var e=this.o;switch(t.type){case"text":"textContent"in t.dom.bodyInput[0]?t.dom.bodyInput[0].textContent=t.content:t.dom.bodyInput[0].innerText=t.content,t.o.status="loaded";break;case"html":t.dom.bodyInput.html(t.content),t.o.status="loaded";break;case"selector":this._getItemFromSelector(t),t.o.status="loaded";break;case"image":"init"===e.imgload&&this._insertImage(t);break;default:return this._e("njBox, seems that you use wrong type("+t.type+") of item.",!0),void(t.o.status="loaded")}}},{key:"_getItemFromSelector",value:function(t){t.o.contentEl=c(t.content),t.o.contentEl.length||t.dom.bodyInput.html(t.content)}},{key:"_createDom",value:function(){var t=this.o;if(this.dom.container=c(t.container),this.dom.container.length||(this._e("njBox, can't find container element. (we use body instead)"),this.dom.container=this.dom.body),this._globals.containerIsBody=this.dom.container[0]===this.dom.body[0],this._globals.containerIsBody||"static"!==this.dom.container.css("position")||this.dom.container.addClass("njb-relative"),this.dom.wrap=c(t.templates.wrap),!this.dom.wrap.length)return void this._e("njBox, smth wrong with o.templates.wrap.");t.class&&this.dom.wrap.addClass(t.class),this.dom.wrap[0].njBox=this,t.zindex&&this.dom.wrap.css("zIndex",t.zindex),this.dom.items=this.dom.wrap.find(".njb-items"),this._globals.containerIsBody||"popover"===t.layout||(t.layout="absolute",this.dom.wrap.addClass("njb-absolute")),this.dom.ui=c(t.templates.ui),this.dom.wrap[0].appendChild(this.dom.ui[0]),this.dom.title=c(t.templates.title),this.dom.ui[0].appendChild(this.dom.title[0]),"outside"===t.close&&(this.dom.close=c(t.templates.close),this.dom.close.attr("title",t.text.close).attr("aria-label",t.text.close),this.dom.ui[0].appendChild(this.dom.close[0])),this.dom.focusCatchFirst=c(t.templates.focusCatcher),this.dom.wrap[0].insertBefore(this.dom.focusCatchFirst[0],this.dom.wrap[0].firstChild),this.dom.focusCatchLast=c(t.templates.focusCatcher),this.dom.wrap[0].appendChild(this.dom.focusCatchLast[0]),this._cb("domready")}},{key:"_drawItem",value:function(t,e,o){var i=(this.o,this._globals.popover?t.dom.modal[0]:t.dom.modalOuter[0]);this._cb("item_prepare",t),this._insertDelayedContent(t),e?o.insertBefore(i,o.firstChild):o.appendChild(i),this._cb("item_inserted",t)}},{key:"_insertDelayedContent",value:function(t){var e,o=this.o;if("image"!==t.type||"show"!==o.imgload||t.o.imageInserted){if("selector"===t.type&&!t.o.contentElInserted){if(e=t.o.contentEl,e&&e.length||(this._getItemFromSelector(t),e=t.o.contentEl),!e||!e.length)return;var i=e[0].style.cssText;i&&(t.o.contentElStyle=i);var n="none"===e.css("display");n&&(t.o.contentElDisplayNone=!0,e[0].style.display="block"),t.dom.bodyInput.html(""),t.dom.bodyInput[0].appendChild(e[0]),t.o.contentElInserted=!0}}else this._insertImage(t)}},{key:"_removeSelectorItemsElement",value:function(){for(var e,o,i=this.items,n=0,s=i.length;n<s;n++)if("selector"===i[n].type){if(e=i[n],!e.o.contentElInserted)continue;o=e.o.contentEl,e.o.contentElDisplayNone&&(o[0].style.display="none",e.o.contentElDisplayNone=t),e.o.contentElStyle&&(o[0].style.cssText=e.o.contentElStyle,e.o.contentElStyle=t),this.dom.body[0].appendChild(o[0]),e.o.contentElInserted=!1}}},{key:"_focus_set",value:function(t,e){var o,i,n=this.o;if(e)return o=this.dom.ui.find(this.o._focusable),void o[o.length-1].focus();n.autofocus&&(i=t.dom.modal.find(n.autofocus)[0]),i||(i=t.dom.modal.find("[autofocus]")[0]),i||(o=t.dom.modal.find(this.o._focusable),i=o[0]),i?i.focus():t.dom.modal[0].focus()}},{key:"_addClickHandlers",value:function(){var t=this.o;this._removeClickHandlers(),this._handlers.elsClick=this._clickHandler(),t.click&&this.data.els&&this.data.els.length&&this.data.els.on("click",this._handlers.elsClick),t.clickels&&c(t.clickels).on("click",this._handlers.elsClick)}},{key:"_clickHandler",value:function(){var t=(this.o,this);return function(e){var o=this;if(e.originalEvent&&(e=e.originalEvent),!("which"in e&&(1!==e.which||1===e.which&&e.ctrlKey&&e.shiftKey))){if(e.preventDefault?e.preventDefault():e.returnValue=!1,"inited"!==t.state.state)return void t._e("njBox, show, plugin not inited or in not inited state(probably plugin is already visible or destroyed, or smth else..)");c(o).closest(".njb-close-system, .njb-arrow").length||(t.state.clickedEvent=e,t.state.clickedEl=o,t.state.focused=o,t.show())}}}},{key:"_removeClickHandlers",value:function(){var t=this.o;this.data.els&&this.data.els.length&&(this.data.els.off("click",this._handlers.elsClick),t.clickels&&c(t.clickels).off("click",this._handlers.elsClick))}},{key:"_addListeners",value:function(){var t=this.o,o=this,i=this._handlers,n=o._globals.popover?o.dom.container:o.dom.wrap;i.container_resize=function(t){o.position()},i.container_scroll=function(t){o.position()},i.container_out=function(i){if(o.state.clickedEl!==i.target&&"shown"===o.state.state){if(!c(i.target).closest(".njb, .njb-ui").length)if(i.preventDefault?i.preventDefault():i.returnValue=!1,t.out){if(o._cb("cancel")===!1)return;o.hide()}else o.items[o.state.active].dom.modal.addClass("njb--pulse"),o._focus_set(o.items[o.state.active]),e(function(){o.items[o.state.active].dom.modal.removeClass("njb--pulse")},o._getAnimTime(o.items[o.state.active].dom.modal[0]))}},this.dom.container.on("resize",i.container_resize).on("scroll",i.container_scroll).on("click",i.container_out),i.wrap_resize=function(){o.position()},i.wrap_scroll=function(t){o.position()},i.wrap_keydown=function(e){switch(o._cb("keydown",e),e.which){case 27:if(t.esc){if(o._cb("cancel")===!1)return;o.hide()}e.preventDefault?e.preventDefault():e.returnValue=!1}},i.wrap_close=function(t){t.preventDefault?t.preventDefault():t.returnValue=!1,o._cb("cancel")!==!1&&o.hide()},i.wrap_ok=function(t){t.preventDefault?t.preventDefault():t.returnValue=!1,o._cb("ok")!==!1&&o.hide()},i.wrap_cancel=function(t){t.preventDefault?t.preventDefault():t.returnValue=!1,o._cb("cancel")!==!1&&o.hide()},n.on("resize",i.wrap_resize).on("scroll",i.wrap_scroll).on("keydown",i.wrap_keydown).delegate("[data-njb-close]","click",i.wrap_close).delegate("[data-njb-ok]","click",i.wrap_ok).delegate("[data-njb-cancel]","click",i.wrap_cancel),i.window_resize=function(t){o.position()},i.window_scroll=function(t){o.position()},i.window_orientation=function(t){o.position()},this.dom.window.on("resize",i.window_resize).on("scroll",i.window_scroll).on("orientationchange",i.window_orientation),i.focusCatchFirst=function(t){var e,i=t.relatedTarget;i?(e=!!c(i).closest(".njb-ui").length,e?o._focus_set(o.items[o.state.active]):o._focus_set(o.items[o.state.active],!0)):o._focus_set(o.items[o.state.active],!0)},i.focusCatchLast=function(t){o._focus_set(o.items[o.state.active])},this.dom.focusCatchFirst.on("focus",i.focusCatchFirst),this.dom.focusCatchLast.on("focus",i.focusCatchLast),this._cb("listerens_added")}},{key:"_removeListeners",value:function(){var t=this._handlers,e=this,o=e._globals.popover?e.dom.container:e.dom.wrap;this.dom.container.off("resize",t.container_resize).off("scroll",t.container_scroll).off("click",t.container_out),o.off("resize",t.wrap_resize).off("scroll",t.wrap_scroll).off("keydown",t.wrap_keydown).undelegate("[data-njb-close]","click",t.wrap_close).undelegate("[data-njb-ok]","click",t.wrap_ok).undelegate("[data-njb-cancel]","click",t.wrap_cancel),this.dom.window.off("resize",t.window_resize).off("scroll",t.window_scroll).off("orientationchange",t.window_orientation);var i=t.elsClick;this._handlers={elsClick:i},this.dom.focusCatchFirst.off("focus",t.focusCatchFirst),this.dom.focusCatchLast.off("focus",t.focusCatchLast),this._cb("listeners_removed")}},{key:"_insertImage",value:function(t){function e(e){a._cb("item_img_"+e,t),e!==r.img&&e!==!0||(t.o.status="loaded",a._preloader("hide",t),d.attr("width","auto"),t.dom.bodyInput[0].appendChild(l),t.o.imageInserted=!0)}function i(t,e){var o,i=0;!function n(s){o&&clearInterval(o),o=setInterval(function(){if(t.width>0)return e(),void clearInterval(o);i>200&&clearInterval(o),i++,5===i?n(10):40===i?n(50):100===i&&n(500)},s)}(1)}var n,s,a=this,r=this.o,l=o.createElement("img"),d=c(l);t.o.status="loading",t.dom.img=d,t._handlerError=function(){d.off("error",t._handlerError).off("abort",t._handlerError),delete t._handlerError,a._preloader("hide",t),t.dom.bodyInput.html(r.text.imageError.replace("%url%",t.content)),a._cb("img_e",t),t.o.status="error",t.o.imageInserted=!0},d.on("error",t._handlerError).on("abort",t._handlerError),t.title&&d.attr("aria-labelledby","njb-title"),l.src=t.content,n=l.width+l.height>0,s=l.complete&&l.width+l.height>0,"ready"===r.img&&n||"load"===r.img&&s?e(!0):(this._preloader("show",t),t._handlerImgReady=function(){e("ready")},i(l,t._handlerImgReady),t._handlerLoad=function(){d.off("load",t._handlerLoad),e("load")},d.on("load",t._handlerLoad))}},{key:"_preloader",value:function(t,e){var o=this.o;switch(t){case"show":e.o.preloader=!0,e.dom.preloader=c(o.templates.preloader).attr("title",o.text.preloader),e.dom.modal.addClass("njb--loading"),e.dom.bodyInput[0].appendChild(e.dom.preloader[0]);break;case"hide":if(!e.o.preloader)return;e.dom.preloader[0].parentElement.removeChild(e.dom.preloader[0]),e.dom.modal.removeClass("njb--loading"),delete e.dom.preloader,delete e.o.preloader}}},{key:"_uiUpdate",value:function(t){t=t||this.state.active;var e=(this.o,this.items[t]);if(!e)return void this._e("njBox, can't update ui info from item index - "+t);e.title?this.dom.ui.addClass("njb-ui--title"):this.dom.ui.removeClass("njb-ui--title"),this.dom.wrap.find("[data-njb-title]").html(e.title||""),"image"===e.type?this.dom.wrap.removeClass("njb-wrap--content").addClass("njb-wrap--image"):this.dom.wrap.removeClass("njb-wrap--image").addClass("njb-wrap--content")}},{key:"_scrollbar",value:function(e){var n=this.o;switch(e){case"hide":if("hide"===n.scrollbar){if(this.state.scrollbarHidden)return;if(this._globals.containerIsBody){var s=(o.documentElement.scrollHeight||o.body.scrollHeight)>o.documentElement.clientHeight;this.dom.container[0].njb_scrollbar||this.state.scrollbarHidden||!s&&"scroll"!==this.dom.html.css("overflowY")&&"scroll"!==this.dom.body.css("overflowY")||(this.dom.html.addClass("njb-hideScrollbar"),this.dom.html.css("paddingRight",parseInt(this.dom.html.css("paddingRight"))+i.g.scrollbarSize+"px"))}else{var s=this.dom.container[0].scrollHeight>this.dom.container[0].clientHeight;this.dom.container.addClass("njb-hideScrollbar")}this.state.scrollbarHidden=!0,this.dom.container[0].njb_scrollbar?this.dom.container[0].njb_scrollbar++:this.dom.container[0].njb_scrollbar=1}break;case"show":if(!this.state.scrollbarHidden)return;if(--this.dom.container[0].njb_scrollbar)return void delete this.state.scrollbarHidden;if(this.dom.container[0].njb_scrollbar=t,this._globals.containerIsBody){this.dom.html.removeClass("njb-hideScrollbar");var a=parseInt(this.dom.html.css("paddingRight"))-i.g.scrollbarSize;a?this.dom.html.css("paddingRight",a+"px"):this.dom.html[0].style.paddingRight=""}else{this.dom.container.removeClass("njb-hideScrollbar");var a=parseInt(this.dom.container.css("paddingRight"))-i.g.scrollbarSize;a?this.dom.container.css("paddingRight",a+"px"):this.dom.container[0].style.paddingRight=""}delete this.state.scrollbarHidden}}},{key:"_backdrop",value:function(t){var o=this.o,i=this;switch(t){case"show":if(this.dom.backdrop=c(o.templates.backdrop),this.state.backdropVisible)return;o.backdrop===!0&&(o.backdropassist&&this.dom.backdrop.css("transitionDuration",this._globals.animShowDur+"ms"),"absolute"===o.layout&&this.dom.backdrop.addClass("njb-absolute"),this.dom.container[0].appendChild(this.dom.backdrop[0]),e(function(){i.dom.backdrop.addClass("njb-backdrop--visible")},0),this.state.backdropVisible=!0);break;case"hide":if(!this.state.backdropVisible)return;o.backdropassist&&this.dom.backdrop.css("transitionDuration",this._globals.animHideDur+"ms"),this.dom.backdrop.removeClass("njb-backdrop--visible"),e(function(){i.dom.backdrop[0].parentNode.removeChild(i.dom.backdrop[0]),o.backdropassist&&(i.dom.backdrop[0].style.cssText=""),delete i.state.backdropVisible},i._getAnimTime(i.dom.backdrop[0]))}}},{key:"_calculateAnimations",value:function(){var t,e,i,n,s,a=this.o,r=!1;a.anim&&(s=a.anim.split(" "),t=s[0],e=s[1]?s[1]:s[0]),a.duration&&(a.duration=a.duration.toString(),s=a.duration.split(" "),i=s[0],n=s[1]?s[1]:s[0]);var l=o.createElement("div");l.style.cssText="visibility: hidden; position: absolute;",i&&"auto"!==i||!t?i=parseInt(i)||0:(l.className=(a.animclass||"")+" "+t,o.body.appendChild(l),r=!0,i=this._getAnimTime(l)),n&&"auto"!==n||!e?n=parseInt(n)||0:(l.className=(a.animclass||"")+" "+e,r||(o.body.appendChild(l),r=!0),n=this._getAnimTime(l)),r&&o.body.removeChild(l),this._globals.animShow=t,this._globals.animHide=e,this._globals.animShowDur=i,this._globals.animHideDur=n}},{key:"_getAnimTime",value:function(e,o){function i(e,o){var i,n,s,a,r=c(e),l=[];if(!r.length)return 0;if(!o)return 0;i=r.css(o+"Duration"),s=r.css(o+"Delay"),i&&i!==t||(i="0s"),n=i.split(", ");for(var d=0,h=n.length;d<h;d++)n[d]=n[d].indexOf("ms")>-1?parseFloat(n[d]):1e3*parseFloat(n[d]);s&&s!==t||(s="0s"),a=s.split(", ");for(var d=0,h=a.length;d<h;d++)a[d]=a[d].indexOf("ms")>-1?parseFloat(a[d]):1e3*parseFloat(a[d]);for(var d=0,h=n.length;d<h;d++)l[d]=n[d]+a[d];return Math.max.apply(Math,l)}return i(e,"animation")||i(e,"transition")}},{key:"_anim",value:function(t){function o(){n.animclass&&a.removeClass(n.animclass),a.removeClass(r),s._cb("shown"),s._focus_set(s.items[s.state.active])}function i(){n.animclass&&a.removeClass(n.animclass),l===r&&a.removeClass("njb-anim-reverse"),a.removeClass(l),s._clear(),s._cb("hidden")}var n=this.o,s=this,a=this.items[this.state.active].dom.modal,r=this._globals.animShow,l=this._globals.animHide,d=this._globals.animShowDur,c=this._globals.animHideDur;switch(t){case"show":this.dom.wrap[0].clientHeight,this.dom.wrap.addClass("njb-wrap--visible"),r?(n.animclass&&a.addClass(n.animclass),a.attr("open",""),a.addClass(r),e(o,d)):o();break;case"hide":a[0].removeAttribute("open"),this.dom.wrap.removeClass("njb-wrap--visible"),l?(n.animclass&&a.addClass(n.animclass),l===r&&a.addClass("njb-anim-reverse"),a.addClass(l),e(i,c)):i()}}},{key:"_focusPreviousModal",value:function(){var t,e=this.dom.body.find(".njb-wrap");e.length&&(t=e[e.length-1].njBox,t._focus_set(t.items[t.state.active]))}},{key:"_clear",value:function(){function t(t){for(;t.firstChild;)t.removeChild(t.firstChild)}var e=this.o,o=this.items[this.state.active].dom.modal;this._cb("clear"),this.dom.container&&this.dom.container[0].njb_instances--,e.class&&this.dom.wrap.removeClass(e.class),this._scrollbar("show"),this._globals.popover?o[0].parentNode.removeChild(o[0]):this.dom.wrap&&this.dom.wrap.length&&this.dom.wrap[0].parentNode.removeChild(this.dom.wrap[0]),this._removeSelectorItemsElement(),this.dom.items&&this.dom.items.length&&t(this.dom.items[0]);for(var i=0,n=this.items.length;i<n;i++)this.items[i].dom.modalOuter[0].style.cssText="";this.state={inited:!0,state:"inited",active:0},this._cb("cleared")}},{key:"_e",value:function(t,e){t&&e&&this._clear()}},{key:"_cb",value:function(t){var e,o=this.o;switch("inited"!==t&&"show"!==t&&"shown"!==t&&"hide"!==t&&"hidden"!==t&&"destroy"!==t&&"destroyed"!==t||(this.state.state=t),t){case"hidden":this.state.state="inited",o.focusprevious&&this._focusPreviousModal()}this.trigger.apply(this,arguments);var i=Array.prototype.slice.call(arguments);o.oncb&&"function"==typeof o.oncb&&(e=o.oncb.apply(this,i)),this.trigger.apply(this,["cb"].concat(i));var n=Array.prototype.slice.call(arguments,1);if("ok"===t||"cancel"===t){var s=this.items[this.state.active].dom.modal,a=s.find("[data-njb-return]"),r=void 0;a.length&&(r=a[0].value||null),n.unshift(r),this.returnValue=r}return"function"==typeof o["on"+t]&&(e=o["on"+t].apply(this,n)),e}},{key:"on",value:function(t,e){return this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(e),this}},{key:"off",value:function(t,e){if(this._events=this._events||{},t in this._events!=!1)return this._events[t].splice(this._events[t].indexOf(e),1),this}},{key:"trigger",value:function(t){if(this._events=this._events||{},t in this._events!=!1){for(var e=0;e<this._events[t].length;e++)this._events[t][e].apply(this,Array.prototype.slice.call(arguments,1));return this}}}]),i}();return o.body&&!i.g&&(i.g=(0,d.getDefaultInfo)()),i.addons={},i.defaults=d.defaults,i.addAddon=function(t,e){i.addons[t]=!0,e.options&&c.extend(!0,i.defaults,e.options),c.extend(i.prototype,e.prototype)},i.get=function(e){var o=c(e)[0];return o?o.njBox||t:t},i.autobind=function(){c(i.defaults.autobind).each(function(){new i({elem:c(this)})}),c('[data-toggle~="popover"]').each(function(){new i({elem:c(this),layout:"popover"})})},"undefined"!=typeof window&&c(function(){i.autobind()}),i.alert=function(t,e,o){return new i({content:function(e){return'<div class="njb__body">\n'+(t||this.o.text._missedContent)+'\n</div>\n<div class="njb__footer">\n  <button data-njb-ok>'+this.o.text.ok+"</button>\n</div>"},type:"template",role:"alertdialog",out:!1,onok:e,oncancel:o}).show()},i.confirm=function(t,e,o){return new i({content:function(e){return'<div class="njb__body">\n'+(t||this.o.text._missedContent)+'\n</div>\n<div class="njb__footer">\n  <button data-njb-ok>'+this.o.text.ok+"</button>\n  <button data-njb-cancel>"+this.o.text.cancel+"</button>\n</div>"},type:"template",role:"alertdialog",out:!1,onok:e,oncancel:o}).show()},i.prompt=function(t,e,o,n){return"function"==typeof e&&(n=o,o=e,e=""),new i({content:function(o){return'<div class="njb__body">\n'+(t||this.o.text._missedContent)+'\n<div>\n  <input data-njb-return type="text" placeholder="'+(e||"")+'" />\n</div>\n</div>\n<div class="njb__footer">\n  <button data-njb-ok>'+this.o.text.ok+"</button>\n  <button data-njb-cancel>"+this.o.text.cancel+"</button>\n</div>"},type:"template",role:"alertdialog",out:!1,onok:o,oncancel:n}).show()},i}(void 0,setTimeout,document);e.default=h,t.exports=e.default},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n=function t(e){return new t.fn.init(e||"")};n.match=function(t,e){return t===document&&(t=document.documentElement),(t.matches||t.matchesSelector||t.oMatchesSelector||t.mozMatchesSelector||t.webkitMatchesSelector||t.msMatchesSelector).call(t,e)},n.fn=n.prototype,n.fn.init=function(t){var e;"string"==typeof t&&t.length>0?e="<"===t.charAt(0)?n.str2dom?n.str2dom(t):[]:document.querySelectorAll(t):t instanceof Array||t instanceof NodeList||t instanceof HTMLCollection||t instanceof n?e=t:t.nodeType||window.Node&&t instanceof Node||t==t.window||"object"===(void 0===t?"undefined":i(t))?e=[t]:"function"==typeof t?(e=[document],document.addEventListener("DOMContentLoaded",t)):e=[],this.length=e.length;for(var o=0,s=this.length;o<s;o++)this[o]=e[o];return this},n.fn.init.prototype=n.fn,n.fn.each=function(t){for(var e=0,o=this.length;e<o&&t.call(this[e],e,this[e])!==!1;e++);return this},n.str2dom=function(t){var e=document.createElement("div");return e.innerHTML=t,e.childNodes},n.isArray=function(t){return"array"===n.type(t)},n.isFunction=function(t){return"function"==n.type(t)},n.isPlainObject=function(t){var e,o={},i={}.hasOwnProperty;if(!t||"object"!==n.type(t)||t.nodeType||n.isWindow(t))return!1;try{if(t.constructor&&!i.call(t,"constructor")&&!i.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}if(o.ownLast)for(e in t)return i.call(t,e);for(e in t);return void 0===e||i.call(t,e)},n.isWindow=function(t){return null!=t&&t==t.window},n.type=function(t){var e=e={"[object Array]":"array","[object Boolean]":"boolean","[object Date]":"date","[object Error]":"error","[object Function]":"function","[object Number]":"number","[object Object]":"object","[object RegExp]":"regexp","[object String]":"string"},o=e.toString;return null==t?t+"":"object"===(void 0===t?"undefined":i(t))||"function"==typeof t?e[o.call(t)]||"object":void 0===t?"undefined":i(t)},n.extend=function(){var t,e,o,s,a,r,l=arguments[0]||{},d=1,c=arguments.length,h=!1;for("boolean"==typeof l&&(h=l,l=arguments[d]||{},d++),"object"===(void 0===l?"undefined":i(l))||n.isFunction(l)||(l={}),d===c&&(l=this,d--);d<c;d++)if(null!=(a=arguments[d]))for(s in a)t=l[s],o=a[s],l!==o&&(h&&o&&(n.isPlainObject(o)||(e=n.isArray(o)))?(e?(e=!1,r=t&&n.isArray(t)?t:[]):r=t&&n.isPlainObject(t)?t:{},l[s]=n.extend(h,r,o)):void 0!==o&&(l[s]=o));return l},n.inArray=function(t,e,o){return null==e?-1:e.indexOf(t,o)},n.fn.find=function(t){var e,o=[];return this.each(function(i){e=Array.prototype.slice.call(this.querySelectorAll(t),""),e.length&&(o=o.concat(e))}),n(o)},n.fn.on=function(t,e){return this.each(function(){this.addEventListener(t,e,!1)})},n.fn.off=function(t,e){return this.each(function(){this.removeEventListener(t,e)})},n.fn.delegate=function(t,e,o){return this.each(function(i){var s=this;this._events||(this._events={}),this._events[e]||(this._events[e]=[]);var a=function(e){var i=e&&e.target||window.event.srcElement,a=e.path;if(!a){a=[];for(var r=i;r;)a.push(r),r=r.parentNode}for(var l=0,d=a.length;l<d&&a[l]!==s;l++)if(a[l]!==document&&n.match(a[l],t)){o.call(a[l],e);break}};a.fn=o,this.addEventListener(e,a,!1),this._events[e].push(a)})},n.fn.undelegate=function(t,e,o){return o||(o=e,e=t),this.each(function(t){var i=this._events,n=this._events[e];if(i&&n){for(var t=0,s=n.length;t<s;t++)if(o===n[t].fn){this.removeEventListener(e,n[t]),delete n[t].fn,n.splice(t,1);break}n.length||delete i[e];var a=!0;for(var r in i)if(i.hasOwnProperty(r)){a=!1;break}a&&delete this._events}})},n.fn.data=function(t){return t?this[0].dataset[t]:this[0].dataset},n.fn.attr=function(t,e){return e?this.each(function(){this.setAttribute(t,e)}):this[0].getAttribute(t)},n.parseJSON=function(t){return JSON.parse(t)},n.fn.css=function(t,e){if(t)return"float"==t&&(t="styleFloat"),e?this.each(function(){this.style[t]=e}):getComputedStyle(this[0],null)[t]||void 0},n.fn.hasClass=function(t){return this[0].classList.contains(t)},n.fn.addClass=function(t){var e=t.split(" ");return this.each(function(){for(var t=0,o=e.length;t<o;t++)this.classList.add(e[t])})},n.fn.removeClass=function(t){var e=t.split(" ");return this.each(function(t){for(var t=0,o=e.length;t<o;t++)this.classList.remove(e[t])})},n.fn.closest=function(t){for(var e,o=[],i=0,s=this.length;i<s;i++)if(n.match(this[i],t))o.push(this[i]);else for(e=this[i].parentNode,e===document&&(e=document.documentElement);e&&"HTML"!==e.tagName;)n.match(e,t)&&n.inArray(e,o)===-1&&o.push(e),e=e.parentNode;return n(o)},n.fn.html=function(t){return this.each(function(){this.innerHTML=t})},e.default=n,t.exports=e.default},function(t,e,o){"use strict";function i(){function t(t){var o,i,n,s=["Webkit","Moz","O","ms"],a=t.charAt(0).toUpperCase()+t.slice(1),r=document.createElement("div");if(document.body.insertBefore(r,null),t in r.style)i=t,n=null;else for(var l=0;l<s.length;l++){if((o=s[l]+a)in r.style){n=s[l];break}o=void 0}var d={js:i||o,css:e(t,n)};if("transform"===t){if(void 0!==r.style[d.js]){r.style[d.js]="translate3d(1px,1px,1px)";var c=window.getComputedStyle(r)[d.js]}d["3d"]=void 0!==c&&c.length>0&&"none"!==c}return document.body.removeChild(r),d}function e(t,e){if(t=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),null===e)return t;var o=void 0;switch(e){case"Webkit":o="-webkit-"+t;break;case"Moz":o="-moz-"+t;break;case"ms":o="-ms-"+t;break;case"O":o="-o-"+t}return o}var o={},i=document.createElement("div");i.style.cssText="width: 99px; height: 99px; overflow: scroll; position: absolute; top: -99px;",document.body.appendChild(i),o.scrollbarSize=i.offsetWidth-i.clientWidth||0,document.body.removeChild(i),o.oldIE=!(!document.all||document.addEventListener),o.touch="ontouchstart"in window;var n=o;return n.nativeDialogSupport=!!document.createElement("dialog").showModal,n.transition=t("transition"),n.transitionDuration=t("transitionDuration"),n.transform=t("transform"),n.animation=t("animation"),o}function n(t,e){return null!==t.attr(e)?t:t.find("["+e+"]")}function s(t){return"string"==typeof t?t.split(" "):"object"===(void 0===t?"undefined":a(t))?t:void 0}Object.defineProperty(e,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.getDefaultInfo=i,e.getItemFromDom=n,e.getArray=s;e.defaults={elem:"",content:void 0,type:"",header:void 0,footer:void 0,class:!1,zindex:!1,container:"body",layout:"fixed",coords:"center center",click:!0,clickels:"",backdrop:!0,backdropassist:!0,scrollbar:"hide",out:!0,esc:!0,close:"outside",autoheight:"image",autofocus:!1,focusprevious:!0,title:!1,title_attr:"title",img:"ready",imgload:"show",anim:"scale",animclass:"animated",duration:"auto",jquery:void 0,autobind:'[data-toggle~="box"], [data-toggle~="modal"]',_focusable:'a[href], area[href], details, iframe, object, embed, input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), [tabindex]:not([tabindex="-1"]), [contenteditable]',buttonrole:"button",role:"dialog",label:!1,labelledby:!1,describedby:!1,templates:{wrap:'<div class="njb-wrap"><div class="njb-items"></div></div>',backdrop:'<div class="njb-backdrop"></div>',modalOuter:'<div class="njb-outer"></div>',modal:'<div class="njb"></div>',body:'<div class="njb__body" data-njb-body></div>',header:'<header class="njb__header" data-njb-header></header>',footer:'<footer class="njb__footer" data-njb-footer></footer>',close:'<button type="button" class="njb-ui__close" data-njb-close><span aria-hidden="true">Ã—</span></button>',focusCatcher:'<i tabindex="0" class="njb-focus-catch" aria-hidden="true"></i>',preloader:'<div class="njb-preloader"><div class="njb-preloader__inner"><div class="njb-preloader__bar1"></div><div class="njb-preloader__bar2"></div><div class="njb-preloader__bar3"></div></div></div>',ui:'<div class="njb-ui"></div>',title:'<div class="njb-ui__title"><div class="njb-ui__title-inner" id="njb-title" data-njb-title></div></div>'},text:{_missedContent:"njBox plugin: meow, put some content here...",preloader:"Loading...",imageError:'<a href="%url%">This image</a> can not be loaded.',close:"Close dialog",ok:"Ok",cancel:"Cancel",placeholder:""}}},function(t,e,o){t.exports=o(0)}])});