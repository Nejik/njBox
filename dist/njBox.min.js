!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("njBox",[],e):"object"==typeof exports?exports.njBox=e():t.njBox=e()}(this,function(){return function(t){function e(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};return e.m=t,e.c=n,e.i=function(t){return t},e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:o})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/",e(e.s=3)}([function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),a=n(1),l=o(a),c=n(2),d=window.jQuery||l.default,h=function(){function t(e,n){if(i(this,t),!arguments.length)return void console.error("njBox, arguments not passed.");var o=void 0;!n&&e?o=d.isPlainObject(e)?e:{elem:e}:(o=n,o.elem=e),o=o||{},this._init(o)}return r(t,[{key:"_init",value:function(e){t.g||(t.g=(0,c.getDefaultInfo)()),this.active=0,this.state={},this._globals={},this._handlers={},this._globals.passedOptions=e;var n=this.o=d.extend({},t.defaults,e);if(n.jquery&&(d=n.jquery),this.v={document:d(document),window:d(window),html:d(document.documentElement),body:d(document.body)},!n.elem&&!n.content)return void this._error("njBox, no elements (o.elem) or content (o.content) for modal.");if(n.elem){var o=d(n.elem);if(!o.length)return void this._error("njBox, element not found ("+n.elem+")");if(o.length>1&&(o=d(o[0])),o[0].njBox)return void this._error("njBox, already inited on this element");o[0].njBox=this,this._globals.gatheredOptions=this._gatherData(o),d.extend(!0,this.o,this._globals.gatheredOptions),this.els=this._gatherElements()}this.items=this._createItems(this._createRawItems()),this._createDom(),this._calculateAnimations(),this._setClickHandlers(),this.state.inited=!0,this._cb("inited")}},{key:"show",value:function(t){t&&(this.active=parseInt(t));this.o;if("inited"!==this.state.state)return void this._error("njBox, show, plugin not inited or in not inited state(probably plugin is already visible or destroyed, or smth else..)");if(!this.items.length)return void this._error("njBox, smth goes wrong, plugin don't create any item to show",!0);if(this._cb("show")!==!1)return this.returnValue=null,this.v.container[0].njb_instances?this.v.container[0].njb_instances++:this.v.container[0].njb_instances=1,this.v.container.addClass("njb-open"),this._scrollbar("hide"),this._backdrop("show"),this._setEventsHandlers(),this.v.container[0].appendChild(this.v.wrap[0]),this._drawItem(this.active),this.position(),this._anim("show"),this}},{key:"hide",value:function(){if("shown"!==this.state.state)return void this._error("njBox, hide, we can hide only showed modal (probably animation is still running or plugin destroyed).");this.o,this._handlers;if(this._cb("hide")!==!1)return this.state.clickedEl&&this.state.clickedEl.focus(),this._backdrop("hide"),this._removeEventsHandlers(),this._anim("hide"),this}},{key:"position",value:function(){if(this.state.inited){var t=this.o;if(this._getContainerSize(),"absolute"===t.position){var e=this.state.dimensions.containerScrollTop,n=this.state.dimensions.containerScrollLeft;e<=this.state.dimensions.containerMaxScrollTop&&this.v.wrap.css({top:e+"px",left:n+"px"}),this.v.backdrop.css({width:"auto",height:"auto"}),this.v.backdrop[0].clientHeight,this.v.backdrop.css({width:this.state.dimensions.containerScrollWidth+"px",height:this.state.dimensions.containerScrollHeight+"px"})}return this._setMaxHeight(this.items[this.active]),this._cb("position"),this}}},{key:"destroy",value:function(){if(!this.state.inited||"inited"!==this.state.state)return void this._error("njBox, we can destroy only initialized && hidden modals.");this.els&&this.els.length&&(this.els.off("click",this._handlers.elsClick),this.o.clickels&&d(this.o.clickels).off("click",this._handlers.elsClick)),this.v.container.removeClass("njb-relative"),this._globals=void 0,this._handlers=void 0,this.els=void 0,this.items=void 0,this.v=void 0,this.o={},this._cb("destroyed")}},{key:"_getContainerSize",value:function(){var t=(this.o,this.state.dimensions={});this.v.container[0]===this.v.body[0]?(t.containerWidth=document.documentElement.clientWidth,t.containerHeight=document.documentElement.clientHeight,t.containerScrollWidth=Math.max(document.body.scrollWidth,document.documentElement.scrollWidth,document.body.offsetWidth,document.documentElement.offsetWidth,document.body.clientWidth,document.documentElement.clientWidth),t.containerScrollHeight=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight),t.containerScrollTop=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,t.containerScrollLeft=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft):(t.containerWidth=this.v.container[0].clientWidth,t.containerHeight=this.v.container[0].clientHeight,t.containerScrollWidth=this.v.container[0].scrollWidth,t.containerScrollHeight=this.v.container[0].scrollHeight,t.containerScrollTop=this.v.container[0].scrollTop,t.containerScrollLeft=this.v.container[0].scrollLeft),t.containerMaxScrollTop=t.containerScrollHeight-t.containerHeight,t.winHeight=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,t.autoheight=this.v.container[0]===this.v.body[0]?t.winHeight:t.containerHeight}},{key:"_setMaxHeight",value:function(t){function e(t,e){return parseInt(t.css(e+"Top"))+parseInt(t.css(e+"Bottom"))||0}var n=this.o;if(n.autoheight&&("image"!==n.autoheight||"image"===t.type)){this.state.autoheightAdded||(this.v.wrap.addClass("njb-autoheight"),n.autoheight===!0?this.v.wrap.addClass("njb-autoheight--true"):this.v.wrap.addClass("njb-autoheight--image"),this.state.autoheightAdded=!0);var o=t.dom,i=e(o.modal,"margin"),s=e(o.modal,"padding")+parseInt(o.modal.css("borderTopWidth"))+parseInt(o.modal.css("borderBottomWidth"))||0,r=e(o.body,"margin"),a=e(o.body,"padding")+parseInt(o.body.css("borderTopWidth"))+parseInt(o.body.css("borderBottomWidth"))||0,l=this.state.dimensions.autoheight,c=l,d="border-box"===o.body.css("boxSizing"),h=0,u=0;if(o.header&&o.header.length&&(h=o.header[0].scrollHeight+(parseInt(o.header.css("borderTopWidth"))+parseInt(o.header.css("borderBottomWidth")))||0),o.footer&&o.footer.length&&(u=o.footer[0].scrollHeight+(parseInt(o.footer.css("borderTopWidth"))+parseInt(o.footer.css("borderBottomWidth")))||0),c=l-i-s-r-h-u,d||(c-=a),"image"===t.type){var f=l-i-s-r-a-h-u;o.img&&o.img.css("maxHeight",f+"px")}else o.body.css("maxHeight",c+"px")}}},{key:"_createRawItems",value:function(){return[this.o]}},{key:"_gatherElements",value:function(){return this.o.el}},{key:"_gatherData",value:function(t){function e(t){var e={};for(var o in t)if(t.hasOwnProperty(o)&&/^njb[A-Z]+/.test(o)){var i=o.match(/^njb(.*)/)[1],s=i.charAt(0).toLowerCase()+i.slice(1);e[s]=n(t[o])}return e}function n(t){var e=parseFloat(t);return"true"===t||"false"!==t&&(isNaN(e)?t:e)}var o=this.o,i=d(t),s=i.data(),r={};if(!i.length)return r;if(s.njbOptions)try{r=d.parseJSON(s.njbOptions),delete s.njbOptions}catch(t){return void this._error("njBox, fail to parse options from njb-options")}if(i.length&&(r.el=i),"a"===i[0].tagName.toLowerCase()){var a=i.attr("href");a&&"#"!==a&&"#!"!==a&&!/^(?:javascript)/i.test(a)&&(r.content=a)}if(o.title_attr){var l=i.attr(o.title_attr);l&&(r.title=l)}return d.extend(!0,r,e(s)),this._cb("data_gathered",r,i[0]),r}},{key:"_createItems",value:function(t){for(var e=[],n=0,o=t.length;n<o;n++)e.push(this._createItem(t[n]));return e}},{key:"_createItem",value:function(t){var e=this._normalizeItem(t);return this._createDomForItem(e),e}},{key:"_normalizeItem",value:function(t,e){var n=void 0;return n="function"==typeof t.content?t.content.call(this,t):t.content,{content:n||this.o.text._missedContent,type:t.type||this._type(t.content||this.o.text._missedContent),header:t.header,footer:t.footer,title:t.title,el:t.el||e,o:{status:"inited"}}}},{key:"_type",value:function(t){var e="html";if("object"===(void 0===t?"undefined":s(t))){if(window.jQuery&&t instanceof window.jQuery||window.j&&t instanceof window.j)return"selector"}else{if(/^[#.]\w/.test(t))return"selector";if(/\.(png|jpg|jpeg|gif|tiff|bmp|webp)(\?\S*)?$/i.test(t))return"image"}return e}},{key:"_createDomForItem",value:function(t){var e=this.o,n=t.dom={},o=document.createDocumentFragment();if(n.modalOuter=d(e.templates.modalOuter),n.modalOuter[0].njBox=this,n.modal=d(e.templates.modal),n.modal[0].setAttribute("tabindex","-1"),n.modal[0].njBox=this,!n.modal.length)return void this._error("njBox, error in o.templates.modal");if(n.modalOuter[0].appendChild(n.modal[0]),"template"===t.type)n.modal[0].innerHTML=t.content;else{if(n.body=d(e.templates.body),!n.body.length)return void this._error("njBox, error in o.templates.body");if(this._insertItemBodyContent(t),o.appendChild(n.body[0]),t.header){if(n.header=d(e.templates.header),!n.header.length)return void this._error("njBox, error in o.templates.header");var i=i=null!==n.header[0].getAttribute("data-njb-header")?n.header:n.header.find("[data-njb-header]");i[0].innerHTML=t.header,o.insertBefore(n.header[0],o.firstChild)}if(t.footer){if(n.footer=d(e.templates.footer),!n.footer.length)return void this._error("njBox, error in njBox.templates.footer");var s=s=null!==n.footer[0].getAttribute("data-njb-footer")?n.footer:n.footer.find("[data-njb-footer]");s[0].innerHTML=t.footer,o.appendChild(n.footer[0])}"inside"===e.close&&(n.close=d(e.templates.close),n.close[0].setAttribute("title",e.text.close),o.appendChild(n.close[0])),n.modal[0].appendChild(o)}this._cb("item_domready",t)}},{key:"_insertItemBodyContent",value:function(t){var e=this.o;switch(t.type){case"text":"textContent"in t.dom.body[0]?t.dom.body[0].textContent=t.content:t.dom.body[0].innerText=t.content,t.o.status="loaded";break;case"html":t.dom.body[0].innerHTML=t.content,t.o.status="loaded";break;case"selector":this._getItemFromSelector(t),t.o.status="loaded";break;case"image":"init"===e.imgload&&this._insertImage(t);break;default:return this._error("njBox, seems that you use wrong type("+t.type+") of item.",!0),void(t.o.status="loaded")}"image"===t.type?t.dom.modal.addClass("njb--image"):t.dom.modal.addClass("njb--content")}},{key:"_getItemFromSelector",value:function(t){t.o.contentEl=d(t.content),t.o.contentEl.length||(t.dom.body[0].innerHTML=t.content)}},{key:"_insertImage",value:function(t){function e(e){s._cb("item_img_"+e,t),e!==r.img&&e!==!0||(t.o.status="loaded",s._preloader("hide",t),l.attr("width","auto"),t.dom.body[0].appendChild(a),t.o.imageInserted=!0)}function n(t){var e,n=0;!function o(i){e&&clearInterval(e),e=setInterval(function(){if(t.width>0)return l.triggerHandler("njb_ready"),void clearInterval(e);n>200&&clearInterval(e),n++,5===n?o(10):40===n?o(50):100===n&&o(500)},i)}(1)}var o,i,s=this,r=this.o,a=document.createElement("img"),l=d(a);t.o.status="loading",t.dom.img=l,t._handlerError=function(){l.off("error",t._handlerError).off("abort",t._handlerError),delete t._handlerError,s._preloader("hide",t),t.dom.body[0].innerHTML=r.text.imageError.replace("%url%",t.content),s._cb("img_error",t),t.o.status="error",t.o.imageInserted=!0},l.on("error",t._handlerError).on("abort",t._handlerError),t.title&&(a.title=t.title),a.src=t.content,o=a.width+a.height>0,i=a.complete&&a.width+a.height>0,"ready"===r.img&&o||"load"===r.img&&i?e(!0):(this._preloader("show",t),t._handlerImgReady=function(){l.off("njb_ready",t._handlerImgReady),e("ready")},l.on("njb_ready",t._handlerImgReady),n(a),t._handlerLoad=function(){l.off("load",t._handlerLoad),e("load")},l.on("load",t._handlerLoad))}},{key:"_createDom",value:function(){var t=this.o;if(this.v.container=d(t.container),this.v.container.length||(this._error("njBox, can't find container element. (we use body instead)"),this.v.container=this.v.body),this.v.container[0]!==this.v.body[0]&&"static"===this.v.container.css("position")&&this.v.container.addClass("njb-relative"),this.v.wrap=d(t.templates.wrap),!this.v.wrap.length)return void this._error("njBox, smth wrong with o.templates.wrap.");if(t.class&&this.v.wrap.addClass(t.class),this.v.wrap[0].njBox=this,t.zindex&&this.v.wrap.css("zIndex",t.zindex),this.v.items=this.v.wrap.find(".njb-items"),this.v.container[0]!==this.v.body[0]&&(t.position="absolute"),"absolute"===t.position&&this.v.wrap.addClass("njb-absolute"),"outside"===t.close){var e=this.v.close=d(t.templates.close),e=e[0];e.setAttribute("title",t.text.close),this.v.wrap[0].appendChild(e)}this.v.focusCatcher=d(t.templates.focusCatcher),this.v.wrap[0].appendChild(this.v.focusCatcher[0])}},{key:"_drawItem",value:function(t){var e=this.o,n=this.items[t];if(!n)return void this._error("njBox, we have no item with this index - "+t,!0);this._cb("item_prepare",n),this._insertSelectorElements(),"show"===e.imgload&&this._insertImageElements(),this.v.items[0].appendChild(n.dom.modalOuter[0]),this._cb("item_inserted",n)}},{key:"_insertSelectorElements",value:function(){for(var t,e,n=this.items,o=0,i=n.length;o<i;o++)if("selector"===n[o].type){if(t=n[o],t.o.contentElInserted)continue;if(e=t.o.contentEl,e&&e.length||(this._getItemFromSelector(t),e=t.o.contentEl),!e||!e.length)continue;var s=e[0].style.cssText;s&&(t.o.contentElStyle=s);var r="none"===e.css("display");r&&(t.o.contentElDisplayNone=!0,e[0].style.display="block"),t.dom.body[0].innerHTML="",t.dom.body[0].appendChild(e[0]),t.o.contentElInserted=!0}}},{key:"_insertImageElements",value:function(){for(var t,e=this.items,n=0,o=e.length;n<o;n++)if("image"===e[n].type){if(t=e[n],t.o.imageInserted)continue;this._insertImage(t)}}},{key:"_removeSelectorItemsElement",value:function(){for(var t,e,n=this.items,o=0,i=n.length;o<i;o++)if("selector"===n[o].type){if(t=n[o],!t.o.contentElInserted)continue;e=t.o.contentEl,t.o.contentElDisplayNone&&(e[0].style.display="none",t.o.contentElDisplayNone=void 0),t.o.contentElStyle&&(e[0].style.cssText=t.o.contentElStyle,t.o.contentElStyle=void 0),this.v.body[0].appendChild(e[0]),t.o.contentElInserted=!1}}},{key:"_setFocusInPopup",value:function(t,e){var n,o=this.o;e&&((n=t.dom.modal.find("[autofocus]"))||n.length||!o.focus||(n=t.dom.modal.find(o.focus))),n&&n.length||(n=t.dom.modal.find(this.o._focusable)),n&&n.length?n[0].focus():"outside"===o.close?this.v.close[0].focus():"inside"===o.close&&t.dom.close?t.dom.close[0].focus():t.dom.modal[0].focus()}},{key:"_setClickHandlers",value:function(){var t=this.o;t.click&&this.els&&this.els.length&&(this._handlers.elsClick=this._clickHandler(),this.els.off("click",this._handlers.elsClick).on("click",this._handlers.elsClick),t.clickels&&d(t.clickels).off("click",this._handlers.elsClick).on("click",this._handlers.elsClick))}},{key:"_clickHandler",value:function(){var t=(this.o,this);return function(e){var n=this;if(e.originalEvent&&(e=e.originalEvent),!("which"in e&&(1!==e.which||1===e.which&&e.ctrlKey&&e.shiftKey))){if(e.preventDefault?e.preventDefault():e.returnValue=!1,"inited"!==t.state.state)return void t._error("njBox, show, plugin not inited or in not inited state(probably plugin is already visible or destroyed, or smth else..)");d(n).closest(".njb-close-system, .njb-arrow").length||(t.state.clickedEvent=e,t.state.clickedEl=n,t.show())}}}},{key:"_setEventsHandlers",value:function(){var t=this.o,e=this,n=this._handlers;n.container_resize=function(){e.position()},n.container_scroll=function(){e.position()},this.v.container.on("resize",n.container_resize).on("scroll",n.container_scroll),n.wrap_out=function(n){if(!d(n.target).closest(".njb, [data-njb-close]").length)if(n.preventDefault?n.preventDefault():n.returnValue=!1,t.out){if(e._cb("cancel")===!1)return;e.hide()}else e.items[e.active].dom.modal.addClass("njb_pulse"),e._setFocusInPopup(this.items[this.active]),setTimeout(function(){e.items[e.active].dom.modal.removeClass("njb_pulse")},e._getAnimTime(e.items[e.active].dom.modal[0]))},n.wrap_resize=function(){},n.wrap_scroll=function(t){},n.wrap_keydown=function(n){switch(e._cb("keydown",n),n.which){case 27:if(t.esc){if(e._cb("cancel")===!1)return;e.hide()}n.preventDefault?n.preventDefault():n.returnValue=!1}},n.wrap_close=function(t){t.preventDefault?t.preventDefault():t.returnValue=!1,e._cb("cancel")!==!1&&e.hide()},n.wrap_ok=function(t){t.preventDefault?t.preventDefault():t.returnValue=!1,e._cb("ok")!==!1&&e.hide()},n.wrap_cancel=function(t){t.preventDefault?t.preventDefault():t.returnValue=!1,e._cb("cancel")!==!1&&e.hide()},this.v.wrap.on("click",n.wrap_out).on("resize",n.wrap_resize).on("scroll",n.wrap_scroll).on("keydown",n.wrap_keydown).delegate("[data-njb-close]","click",n.wrap_close).delegate("[data-njb-ok]","click",n.wrap_ok).delegate("[data-njb-cancel]","click",n.wrap_cancel),n.window_resize=function(t){e.position()},n.window_scroll=function(t){e.position()},n.window_orientation=function(t){e.position()},this.v.window.on("resize",n.window_resize).on("scroll",n.window_scroll).on("orientationchange",n.window_orientation),n.focusCatch=function(t){e._setFocusInPopup(e.items[e.active])},this.v.focusCatcher.on("focus",n.focusCatch),this._cb("events_setted")}},{key:"_removeEventsHandlers",value:function(){var t=this._handlers;this.v.container.off("resize",t.container_resize).off("scroll",t.container_scroll),this.v.wrap.off("click",t.wrap_out).off("resize",t.wrap_resize).off("scroll",t.wrap_scroll).off("keydown",t.wrap_keydown).undelegate("[data-njb-close]","click",t.wrap_close).undelegate("[data-njb-ok]","click",t.wrap_ok).undelegate("[data-njb-cancel]","click",t.wrap_cancel),this.v.window.off("resize",t.window_resize).off("scroll",t.window_scroll).off("orientationchange",t.window_orientation);var e=t.elsClick;this._handlers={elsClick:e},this.v.focusCatcher.off("focus",t.focusCatch),this._cb("events_removed")}},{key:"_preloader",value:function(t,e){var n=this.o;switch(t){case"show":e.o.preloader=!0,e.dom.preloader=d(n.templates.preloader),e.dom.preloader.attr("title",n.text.preloader),e.dom.modal.addClass("njb--loading"),e.dom.body[0].appendChild(e.dom.preloader[0]);break;case"hide":if(!e.o.preloader)return;e.dom.preloader[0].parentElement.removeChild(e.dom.preloader[0]),e.dom.modal.removeClass("njb--loading"),delete e.dom.preloader,delete e.o.preloader}}},{key:"_scrollbar",value:function(e){var n=this.o;switch(e){case"hide":if("hide"===n.scrollbar){if(this.state.scrollbarHidden)return;if(this.v.container[0]===this.v.body[0]){var o=(document.documentElement.scrollHeight||document.body.scrollHeight)>document.documentElement.clientHeight;this.v.container[0].njb_scrollbar||this.state.scrollbarHidden||!o&&"scroll"!==this.v.html.css("overflowY")&&"scroll"!==this.v.body.css("overflowY")||(this.v.html.addClass("njb-hideScrollbar"),this.v.html.css("paddingRight",parseInt(this.v.html.css("paddingRight"))+t.g.scrollbarSize+"px"))}else{var o=this.v.container[0].scrollHeight>this.v.container[0].clientHeight;this.v.container.addClass("njb-hideScrollbar")}this.state.scrollbarHidden=!0,this.v.container[0].njb_scrollbar?this.v.container[0].njb_scrollbar++:this.v.container[0].njb_scrollbar=1}break;case"show":if(!this.state.scrollbarHidden)return;if(--this.v.container[0].njb_scrollbar)return void delete this.state.scrollbarHidden;if(this.v.container[0].njb_scrollbar=null,this.v.container[0]===this.v.body[0]){this.v.html.removeClass("njb-hideScrollbar");var i=parseInt(this.v.html.css("paddingRight"))-t.g.scrollbarSize;i?this.v.html.css("paddingRight",i+"px"):this.v.html[0].style.paddingRight=""}else{this.v.container.removeClass("njb-hideScrollbar");var i=parseInt(this.v.container.css("paddingRight"))-t.g.scrollbarSize;i?this.v.container.css("paddingRight",i+"px"):this.v.container[0].style.paddingRight=""}delete this.state.scrollbarHidden}}},{key:"_backdrop",value:function(t){var e=this.o,n=this;switch(t){case"show":if(this.v.backdrop=d(e.templates.backdrop),this.state.backdropVisible)return;e.backdrop===!0&&(e.backdropassist&&this.v.backdrop.css("transitionDuration",this._globals.animShowDur+"ms"),"absolute"===e.position&&this.v.backdrop.addClass("njb-absolute"),this.v.container[0].appendChild(this.v.backdrop[0]),setTimeout(function(){n.v.backdrop.addClass("njb-visible")},0),this.state.backdropVisible=!0);break;case"hide":if(!this.state.backdropVisible)return;e.backdropassist&&this.v.backdrop.css("transitionDuration",this._globals.animHideDur+"ms"),this.v.backdrop.removeClass("njb-visible"),setTimeout(function(){n.v.backdrop[0].parentNode.removeChild(n.v.backdrop[0]),e.backdropassist&&(n.v.backdrop[0].style.cssText=""),delete n.state.backdropVisible},n._getAnimTime(n.v.backdrop[0]))}}},{key:"_calculateAnimations",value:function(){var t,e,n,o,i,s=this.o,r=!1;s.anim&&(i=s.anim.split(" "),t=i[0],e=i[1]?i[1]:i[0]),s.duration&&(s.duration=s.duration.toString(),i=s.duration.split(" "),n=i[0],o=i[1]?i[1]:i[0]);var a=document.createElement("div");a.style.cssText="visibility: hidden; position: absolute;",n&&"auto"!==n||!t?n=parseInt(n)||0:(a.className=(s.animclass||"")+" "+t,document.body.appendChild(a),r=!0,n=this._getAnimTime(a)),o&&"auto"!==o||!e?o=parseInt(o)||0:(a.className=(s.animclass||"")+" "+e,r||(document.body.appendChild(a),r=!0),o=this._getAnimTime(a)),r&&document.body.removeChild(a),this._globals.animShow=t,this._globals.animHide=e,this._globals.animShowDur=n,this._globals.animHideDur=o}},{key:"_getAnimTime",value:function(t,e){return this._getMaxTransitionDuration(t,"animation")||this._getMaxTransitionDuration(t,"transition")}},{key:"_getMaxTransitionDuration",value:function(t,e){var n,o,i,s,r=d(t),a=[];if(!r.length)return 0;if(!e)return 0;n=r.css(e+"Duration"),i=r.css(e+"Delay"),n&&void 0!==n||(n="0s"),o=n.split(", ");for(var l=0,c=o.length;l<c;l++)o[l]=o[l].indexOf("ms")>-1?parseFloat(o[l]):1e3*parseFloat(o[l]);i&&void 0!==i||(i="0s"),s=i.split(", ");for(var l=0,c=s.length;l<c;l++)s[l]=s[l].indexOf("ms")>-1?parseFloat(s[l]):1e3*parseFloat(s[l]);for(var l=0,c=o.length;l<c;l++)a[l]=o[l]+s[l];return Math.max.apply(Math,a)}},{key:"_anim",value:function(t,e){function n(){i.animclass&&r.removeClass(i.animclass),r.removeClass(a),s._cb("shown"),s._setFocusInPopup(s.items[s.active],!0)}function o(){i.animclass&&r.removeClass(i.animclass),l===a&&r.removeClass("njb-anim-reverse"),r.removeClass(l),s._clear(),s._cb("hidden"),s.state.state="inited"}var i=this.o,s=this,r=(this.items[this.active].dom.modalOuter,this.items[this.active].dom.modal),a=this._globals.animShow,l=this._globals.animHide,c=this._globals.animShowDur,d=this._globals.animHideDur;switch(t){case"show":this.v.wrap.addClass("njb-visible"),a?(i.animclass&&r.addClass(i.animclass),r.addClass(a),setTimeout(n,c)):n();break;case"hide":this.v.wrap.removeClass("njb-visible"),l?(i.animclass&&r.addClass(i.animclass),l===a&&r.addClass("njb-anim-reverse"),r.addClass(l),setTimeout(o,d)):o()}}},{key:"_clear",value:function(){function t(t){for(;t.firstChild;)t.removeChild(t.firstChild)}var e=this.o;this.v.container&&this.v.container[0].njb_instances--,0===this.v.container[0].njb_instances&&this.v.container.removeClass("njb-open"),e.class&&this.v.wrap.removeClass(e.class),this._scrollbar("show"),this.v.wrap&&this.v.wrap.length&&this.v.wrap[0].parentNode.removeChild(this.v.wrap[0]),this._removeSelectorItemsElement(),this.active=0,this.v.items&&this.v.items.length&&t(this.v.items[0]),this.state={inited:!0,state:"inited"},this._cb("clear")}},{key:"_error",value:function(t,e){t&&(e&&this._clear(),console.error(t))}},{key:"_cb",value:function(t){var e,n=this.o;"inited"!==t&&"show"!==t&&"shown"!==t&&"hide"!==t&&"hidden"!==t&&"change"!==t&&"changed"!==t&&"destroy"!==t&&"destroyed"!==t||(this.state.state=t),this.trigger.apply(this,arguments);var o=Array.prototype.slice.call(arguments);n.oncb&&"function"==typeof n.oncb&&(e=n.oncb.apply(this,o)),this.trigger.apply(this,["cb"].concat(o));var i=Array.prototype.slice.call(arguments,1);if("ok"===t||"cancel"===t){var s=this.items[this.active].dom.modal,r=s.find("[data-njb-return]"),a=void 0;r.length&&(a=r[0].value||null),i.unshift(a),this.returnValue=a}return"function"==typeof n["on"+t]&&(e=n["on"+t].apply(this,i)),e}},{key:"on",value:function(t,e){return this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(e),this}},{key:"off",value:function(t,e){if(this._events=this._events||{},t in this._events!=!1)return this._events[t].splice(this._events[t].indexOf(e),1),this}},{key:"trigger",value:function(t){if(this._events=this._events||{},t in this._events!=!1){for(var e=0;e<this._events[t].length;e++)this._events[t][e].apply(this,Array.prototype.slice.call(arguments,1));return this}}}]),t}();h.prototype.showModal=h.prototype.show,h.a={},h.defaults=c.defaults,h.get=function(t){var e=d(t)[0];return e?e.njBox||null:null},h.autobind=function(){d(h.defaults.autobind).each(function(){if(this.njBox)return void console.error("njBox, already inited on this element");new h({elem:d(this)})})},"undefined"!=typeof window&&d(function(){h.autobind()}),h.alert=function(t,e,n){return new h({content:function(e){return'<div class="njb__body">\n                                    '+(t||this.o.text._missedContent)+'\n                                  </div>\n                                  <div class="njb__footer">\n                                    <button data-njb-ok>'+this.o.text.ok+"</button>\n                                  </div>"},type:"template",out:!1,onok:e,oncancel:n}).show()},h.confirm=function(t,e,n){return new h({content:function(e){return'<div class="njb__body">\n                                    '+(t||this.o.text._missedContent)+'\n                                  </div>\n                                  <div class="njb__footer">\n                                    <button data-njb-ok>'+this.o.text.ok+"</button>\n                                    <button data-njb-cancel>"+this.o.text.cancel+"</button>\n                                  </div>"},type:"template",out:!1,onok:e,oncancel:n}).show()},h.prompt=function(t,e,n,o){return"function"==typeof e&&(o=n,n=e,e=""),new h({content:function(n){return'<div class="njb__body">\n                                    '+(t||this.o.text._missedContent)+'\n                                    <div>\n                                      <input data-njb-return type="text" placeholder="'+(e||"")+'" />\n                                    </div>\n                                  </div>\n                                  <div class="njb__footer">\n                                    <button data-njb-ok>'+this.o.text.ok+"</button>\n                                    <button data-njb-cancel>"+this.o.text.cancel+"</button>\n                                  </div>"},type:"template",out:!1,onok:n,oncancel:o}).show()},e.default=h,t.exports=e.default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=function t(e){return e=e||"",new t.fn.init(e)};i.match=function(t,e){return t===document&&(t=document.documentElement),(t.matches||t.matchesSelector||t.oMatchesSelector||t.mozMatchesSelector||t.webkitMatchesSelector||t.msMatchesSelector).call(t,e)},i.fn=i.prototype,i.fn.init=function(t){var e;"string"==typeof t&&t.length>0?e="<"===t.charAt(0)&&">"===t.charAt(t.length-1)?i.str2dom?i.str2dom(t):[]:document.querySelectorAll(t):t instanceof Array||t instanceof NodeList||t instanceof HTMLCollection||t instanceof i?e=t:t.nodeType||window.Node&&t instanceof Node||t==t.window||"object"===(void 0===t?"undefined":o(t))?e=[t]:"function"==typeof t?(e=[document],document.addEventListener("DOMContentLoaded",t)):e=[],this.length=e.length;for(var n=0,s=this.length;n<s;n++)this[n]=e[n];return this},i.fn.init.prototype=i.fn,i.fn.each=function(t){for(var e=0,n=this.length;e<n&&t.call(this[e],e,this[e])!==!1;e++);return this},i.str2dom=function(t){var e=document.createElement("div");return e.innerHTML=t,e.childNodes},i.isArray=function(t){return"array"===i.type(t)},i.isFunction=function(t){return"function"==i.type(t)},i.isPlainObject=function(t){var e,n={},o={}.hasOwnProperty;if(!t||"object"!==i.type(t)||t.nodeType||i.isWindow(t))return!1;try{if(t.constructor&&!o.call(t,"constructor")&&!o.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}if(n.ownLast)for(e in t)return o.call(t,e);for(e in t);return void 0===e||o.call(t,e)},i.isWindow=function(t){return null!=t&&t==t.window},i.type=function(t){var e=e={"[object Array]":"array","[object Boolean]":"boolean","[object Date]":"date","[object Error]":"error","[object Function]":"function","[object Number]":"number","[object Object]":"object","[object RegExp]":"regexp","[object String]":"string"},n=e.toString;return null==t?t+"":"object"===(void 0===t?"undefined":o(t))||"function"==typeof t?e[n.call(t)]||"object":void 0===t?"undefined":o(t)},i.extend=function(){var t,e,n,s,r,a,l=arguments[0]||{},c=1,d=arguments.length,h=!1;for("boolean"==typeof l&&(h=l,l=arguments[c]||{},c++),"object"===(void 0===l?"undefined":o(l))||i.isFunction(l)||(l={}),c===d&&(l=this,c--);c<d;c++)if(null!=(r=arguments[c]))for(s in r)t=l[s],n=r[s],l!==n&&(h&&n&&(i.isPlainObject(n)||(e=i.isArray(n)))?(e?(e=!1,a=t&&i.isArray(t)?t:[]):a=t&&i.isPlainObject(t)?t:{},l[s]=i.extend(h,a,n)):void 0!==n&&(l[s]=n));return l},i.inArray=function(t,e,n){return null==e?-1:e.indexOf(t,n)},i.fn.attr=function(t){return this[0].getAttribute(t)},i.fn.find=function(t){var e,n=[];return this.each(function(o){e=Array.prototype.slice.call(this.querySelectorAll(t),""),e.length&&(n=n.concat(e))}),i(n)},i.fn.on=function(t,e){return this.each(function(){this.addEventListener(t,e,!1)})},i.fn.off=function(t,e){return this.each(function(){this.removeEventListener(t,e)})},i.fn.delegate=function(t,e,n){return this.each(function(o){var s=this;this._events||(this._events={}),this._events[e]||(this._events[e]=[]);var r=function(e){var o=e&&e.target||window.event.srcElement,r=e.path;if(!r){r=[];for(var a=o;a;)r.push(a),a=a.parentNode}for(var l=0,c=r.length;l<c&&r[l]!==s;l++)if(r[l]!==document&&i.match(r[l],t)){n.call(r[l],e);break}};r.fn=n,this.addEventListener(e,r,!1),this._events[e].push(r)})},i.fn.undelegate=function(t,e,n){return n||(n=e,e=t),this.each(function(t){var o=this._events,i=this._events[e];if(o&&i){for(var t=0,s=i.length;t<s;t++)if(n===i[t].fn){this.removeEventListener(e,i[t]),delete i[t].fn,i.splice(t,1);break}i.length||delete o[e];var r=!0;for(var a in o)if(o.hasOwnProperty(a)){r=!1;break}r&&delete this._events}})},i.fn.trigger=i.fn.triggerHandler=function(t,e){return this.each(function(n){var o=new CustomEvent(t,{detail:e||null});this.dispatchEvent(o)})},i.fn.data=function(t,e){return this[0].dataset},i.parseJSON=function(t){return JSON.parse(t)},i.fn.css=function(t,e){function n(t){var e,n,o=["Webkit","Moz","O","ms"],s=t.charAt(0).toUpperCase()+t.slice(1),r=i[0];if(t in r.style)n=t;else for(var a=0;a<o.length;a++){if((e=o[a]+s)in r.style){o[a],n=e;break}e=void 0}return n}var i=this;if(t)return"float"==t&&(t="styleFloat"),"object"===(void 0===t?"undefined":o(t))?this.each(function(){for(var e in t)this.style[n(e)]=t[e]}):e?this.each(function(){this.style[n(t)]=e}):getComputedStyle(this[0],null)[n(t)]||void 0},i.fn.hasClass=function(t){return this[0].classList.contains(t)},i.fn.addClass=function(t){var e=t.split(" ");return this.each(function(){for(var t=0,n=e.length;t<n;t++)this.classList.add(e[t])})},i.fn.removeClass=function(t){var e=t.split(" ");return this.each(function(t){for(var t=0,n=e.length;t<n;t++)this.classList.remove(e[t])})},i.fn.closest=function(t){for(var e,n=[],o=0,s=this.length;o<s;o++)if(i.match(this[o],t))n.push(this[o]);else for(e=this[o].parentNode,e===document&&(e=document.documentElement);e&&"HTML"!==e.tagName;)i.match(e,t)&&i.inArray(e,n)===-1&&n.push(e),e=e.parentNode;return i(n)},e.default=i,t.exports=e.default},function(t,e,n){"use strict";function o(){function t(t){var n,o,i,s=["Webkit","Moz","O","ms"],r=t.charAt(0).toUpperCase()+t.slice(1),a=document.createElement("div");if(document.body.insertBefore(a,null),t in a.style)o=t,i=null;else for(var l=0;l<s.length;l++){if((n=s[l]+r)in a.style){i=s[l];break}n=void 0}var c={js:o||n,css:e(t,i)};if("transform"===t){if(void 0!==a.style[c.js]){a.style[c.js]="translate3d(1px,1px,1px)";var d=window.getComputedStyle(a)[c.js]}c["3d"]=void 0!==d&&d.length>0&&"none"!==d}return document.body.removeChild(a),c}function e(t,e){if(t=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),null===e)return t;var n=void 0;switch(e){case"Webkit":n="-webkit-"+t;break;case"Moz":n="-moz-"+t;break;case"ms":n="-ms-"+t;break;case"O":n="-o-"+t}return n}var n={},o=document.createElement("div");o.style.cssText="width: 99px; height: 99px; overflow: scroll; position: absolute; top: -99px;",document.body.appendChild(o),n.scrollbarSize=o.offsetWidth-o.clientWidth||0,document.body.removeChild(o),n.oldIE=!(!document.all||document.addEventListener),n.touch="ontouchstart"in window;var i=n;return i.nativeDialogSupport=!!document.createElement("dialog").showModal,i.transition=t("transition"),i.transitionDuration=t("transitionDuration"),i.transform=t("transform"),i.animation=t("animation"),n}Object.defineProperty(e,"__esModule",{value:!0}),e.getDefaultInfo=o;e.defaults={elem:"",container:"body",position:"fixed",click:!0,clickels:"",backdrop:!0,backdropassist:!0,scrollbar:"hide",out:!0,esc:!0,close:"outside",autoheight:!1,focus:"",img:"ready",imgload:"show",preload:"2 2",content:void 0,_missedContent:"njBox plugin: meow, put some content here...",type:"",header:void 0,footer:void 0,class:!1,zindex:!1,anim:"scale",animclass:"animated",duration:"auto",templates:{wrap:'<div class="njb-wrap"><div class="njb-items"></div></div>',backdrop:'<div class="njb-backdrop"></div>',modalOuter:'<div class="njb-outer" data-njb-outer></div>',modal:'<aside class="njb" tabindex="-1"></aside>',body:'<div class="njb__body" data-njb-body></div>',header:'<header class="njb__header" data-njb-header></header>',footer:'<footer class="njb__footer" data-njb-footer></footer>',close:'<button type="button" class="njb-close-system" data-njb-close>Ã—</button>',focusCatcher:'<a href="#!" class="njb-focus-catch">This link is just focus catcher of modal window, link do nothing.</a>',preloader:'<div class="njb-preloader"><div class="njb-preloader__inner"><div class="njb-preloader__bar1"></div><div class="njb-preloader__bar2"></div><div class="njb-preloader__bar3"></div></div></div>'},text:{_missedContent:"njBox plugin: meow, put some content here...",imageError:'<a href="%url%">This image</a> can not be loaded.',close:"Close (Esc)",ok:"Ok",cancel:"Cancel",placeholder:""},_focusable:'a[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), *[tabindex]:not(*[tabindex="-1"]), *[contenteditable]',jquery:void 0,autobind:'[data-toggle~="box"], [data-toggle~="modal"]'}},function(t,e,n){t.exports=n(0)}])});