!function(t){function e(s){if(i[s])return i[s].exports;var n=i[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,e),n.l=!0,n.exports}var i={};e.m=t,e.c=i,e.i=function(t){return t},e.d=function(t,i,s){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:s})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/",e(e.s=2)}([function(t,e,i){"use strict";/*!
 * njBox gallery addon
 * nejikrofl@gmail.com
 * Copyright (c) 2017 N.J.
*/
!function(){window.njBox&&njBox.addAddon("gallery",{options:{gallery:"",arrows:!0,start:!1,loop:!0,preload:"1 1",templates:{count:'<div class="njb-ui__count"><span data-njb-current>1</span> / <span data-njb-total>1</span></div>',prev:'<button type="button" class="njb-ui__arrow njb-ui__arrow--prev" data-njb-prev></button>',next:'<button type="button" class="njb-ui__arrow njb-ui__arrow--next" data-njb-next></button>'},text:{current:"Current slide",total:"Total slides",prev:"Previous gallery item",next:"Next gallery item"}},prototype:{_gallery_init:function(){var t=this,e=this.o,i=this.$;e.gallery&&(t._g.gallery=!0,"popover"===e.layout&&(e.layout="fixed")),i.isArray(e.content)&&(t._g.gallery=!0),t._g.gallery&&(this.on("items_raw",function(){this._g_createRawItems()}),this.on("domready",function(){this._g.gallery&&(this.dom.ui_count=i(e.templates.count),this.dom.ui[0].appendChild(this.dom.ui_count[0]),this.dom.ui_current=this.dom.ui_count.find("[data-njb-current]"),this.dom.ui_current[0].setAttribute("title",e.text.current),this.dom.ui_total=this.dom.ui_count.find("[data-njb-total]"),this.dom.ui_total[0].setAttribute("title",e.text.total),this.dom.prev=i(e.templates.prev),this.dom.prev[0].setAttribute("title",e.text.prev),this.dom.next=i(e.templates.next),this.dom.next[0].setAttribute("title",e.text.next),e.arrows&&!this.state.arrowsInserted&&this._g.gallery&&(this.dom.next[0]&&this.dom.ui[0].appendChild(this.dom.next[0]),this.dom.prev[0]&&this.dom.ui[0].appendChild(this.dom.prev[0]),this.state.arrowsInserted=!0))}),this.on("item_created",function(t,e){this._g.gallery&&t.dom.modalOuter[0].setAttribute("data-njb-index",e)}),this.on("inserted",function(){t._g.gallery&&(this._setQueue(this.state.active),t._g__uiUpdate())}),this.on("change",function(){t._g__uiUpdate()}),this.on("changed",function(){this._preload()}),this.on("listeners_added",function(){var t=(this.o,this),e=this._handlers;e.wrap_prev=function(e){t.prev(),e.preventDefault()},e.wrap_next=function(e){t.next(),e.preventDefault()},this.dom.wrap.delegate("[data-njb-prev]","click",e.wrap_prev).delegate("[data-njb-next]","click",e.wrap_next)}),this.on("listeners_removed",function(){var e=this._handlers;t._g.gallery&&t.dom.wrap.undelegate("[data-njb-prev]","click",e.wrap_prev).undelegate("[data-njb-next]","click",e.wrap_next)}),this.on("positioned",function(){this._g.gallery&&"shown"===this.state.status&&(null!==this.queue.prev.index&&this._setMaxHeight(this.items[this.queue.prev.index]),null!==this.queue.next.index&&this._setMaxHeight(this.items[this.queue.next.index]))}),this.on("show",function(){this.state.active=this._detectIndexForOpen()}),this.on("shown",function(){this._g.gallery&&(this._drawItemSiblings(),this._preload())}),this.on("keydown",function(e){this.o;switch(e.which){case 37:t.prev(),e.preventDefault();break;case 39:t.next(),e.preventDefault()}}))},prev:function(){return this._changeItem(this.state.active-1,"prev"),this},next:function(){return this._changeItem(this.state.active+1,"next"),this},goTo:function(t){if("number"!=typeof(t-=1))return void this._error("njBox, wrong index argument in goTo method.");if("inited"===this.state.status||"show"===this.state.status)return void(this.state.active=t);if("shown"!==this.state.status||t===this.state.active||t<0||t>this.items.length-1)return this._error("njBox, wrong index in goTo method."),this;var e=t>this.state.active?"next":"prev";if("next"===e&&t===this.state.active+1)this.next();else if("prev"===e&&t===this.state.active-1)this.prev();else switch(this.queue.prev.dom.modalOuter[0].parentNode.removeChild(this.queue.prev.dom.modalOuter[0]),this.queue.next.dom.modalOuter[0].parentNode.removeChild(this.queue.next.dom.modalOuter[0]),this.queue.prev.dom.modalOuter[0].style.cssText="",this.queue.next.dom.modalOuter[0].style.cssText="",e){case"next":this.queue.prev=this._getQueueItem(null),this.queue.next=this._getQueueItem(t),this._drawItemSiblings(),this._changeItem(t,"next");break;case"prev":this.queue.prev=this._getQueueItem(t),this.queue.next=this._getQueueItem(null),this._drawItemSiblings(),this._changeItem(t,"prev")}return this},_makeUnfocusable:function(t,e){var i,s=this.$(t),n=[];return s.length?(i=s.find(e),i.each(function(){n.push({el:this,tabindex:this.tabIndex||null}),this.tabIndex="-1"}),n):n},_restoreUnfocusable:function(t){var e=(t.item,t.tabs);e&&e.forEach(function(t){null!==t.tabindex?t.el.setAttribute("tabindex",t.tabindex):t.el.removeAttribute("tabindex")})},_preload:function(){function t(t){if(null!==t){var e=this.items[t],i=e.content;"loading"!==e.o.status&&"loaded"!==e.o.status&&"image"===e.type&&(document.createElement("img").src=i)}}var e=this.o;if(e.preload&&"shown"===this.state.status){for(var i=e.preload.split(" "),s=parseInt(i[0]),n=this._getItemsOrder(this.queue.prev.index)[0],r=parseInt(i[1]),a=this._getItemsOrder(this.queue.next.index)[2];r--;)t.call(this,a),a=this._getItemsOrder(a)[2];for(;s--;)t.call(this,n),n=this._getItemsOrder(n)[0]}},_drawItemSiblings:function(){var t=this.o,e=this;"number"==typeof e.queue.prev.index&&(e._moveItem(e.queue.prev.item,-110,"%"),e._drawItem(e.queue.prev.item,!0,e.dom.items[0]),null!==e.queue.prev.index&&e._setMaxHeight(e.items[e.queue.prev.index]),e.queue.prev.tabs=e._makeUnfocusable(e.queue.prev.item.dom.modal,t._focusable)),"number"==typeof e.queue.next.index&&(e._moveItem(e.queue.next.item,110,"%"),e._drawItem(e.queue.next.item,!1,e.dom.items[0]),null!==e.queue.next.index&&e._setMaxHeight(e.items[e.queue.next.index]),e.queue.next.tabs=e._makeUnfocusable(e.queue.next.item.dom.modal,t._focusable))},_moveItem:function(t,e,i){i=i||"px",njBox.g.transform["3d"]?t.dom.modalOuter[0].style.cssText=njBox.g.transform.css+": translate3d("+(e+i)+",0,0)":njBox.g.transform.css?t.dom.modalOuter[0].style.cssText=njBox.g.transform.css+": translateX("+(e+i)+")":t.dom.modalOuter[0].style.cssText="left:"+(e+i)},_changeItem:function(t,e){function i(t){t.dom.modalOuter[0].parentNode.removeChild(t.dom.modalOuter[0]),t.dom.modalOuter[0].style.cssText=""}if(1!==this.items.length&&t!==this.state.active&&!this.state.itemChanging){var s=this.o,n=this,r=this.$.extend(!0,{},this.queue);if(!this.items[t]){if(!(s.loop&&this.items.length>2))return;if("next"===e&&t===this.items.length)t=0;else{if("prev"!==e||t!==-1)return;t=this.items.length-1}}switch(this.state.direction=e,this.state.itemChanging=!0,this.state.active=t,this._cb("change",t),this._uiUpdate(),this._setQueue(t),this._restoreUnfocusable(r.prev),this._restoreUnfocusable(r.next),e){case"prev":r.prev.item.dom.body[0].style.verticalAlign="middle",this._moveItem(r.current.item,110,"%"),this._moveItem(r.prev.item,0,"%");break;case"next":r.next.item.dom.body[0].style.verticalAlign="middle",this._moveItem(r.current.item,-110,"%"),this._moveItem(r.next.item,0,"%")}setTimeout(function(){if("shown"!==n.state.status)return void(n.state.itemChanging=!1);i(r.current.item);var t="prev"===e?r.next.index:r.prev.index;n.items[t]&&i(n.items[t]),n._drawItemSiblings(),n._focus_set(n.items[n.state.active]),n.state.itemChanging=!1,n._cb("changed",n.state.active)},this._getAnimTime(r.current.item.dom.modalOuter))}},_detectIndexForOpen:function(){var t,e=this.o,i=this,s=this.state.arguments.show.index;return void 0!==s&&(this.state.active=s-1),t=this.state.active||0,this._g.gallery&&e.start-1&&this.items[e.start-1]&&(t=e.start-1),this._g.gallery&&this._g.els&&this._g.els.length&&i.state.clickedEl&&e.click&&this._g.els.each(function(e,s){if(i.state.clickedEl===s)return void(t=e)}),t},_setQueue:function(t){var e=this._getItemsOrder(t);this.queue={prev:this._getQueueItem(e[0]),current:this._getQueueItem(e[1]),next:this._getQueueItem(e[2])}},_getItemsOrder:function(t){var e=this.o,i=t-1,s=t+1;return e.loop&&this.items.length>2&&(i===-1&&(i=this.items.length-1),s===this.items.length&&(s=0)),this.items[i]||(i=null),this.items[s]||(s=null),[i,t,s]},_getQueueItem:function(t){var e;return null===t?(t=null,e=null):e=this.items[t],{index:t,item:e}},_g__uiUpdate:function(t){t=t||this.state.active;var e=this.o;this.items[t]||this._error("njBox, can't update ui info from item index - "+t),this.dom.wrap.find("[data-njb-current]").html(t+1||""),this.dom.wrap.find("[data-njb-total]").html(this.items.length||""),0===t?(this.state.gallery_first=!0,this.dom.ui.addClass("njb-ui--first")):(this.state.gallery_first=!1,this.dom.ui.removeClass("njb-ui--first")),t===this.items.length-1?(this.state.gallery_last=!0,this.dom.ui.addClass("njb-ui--last")):(this.state.gallery_last=!1,this.dom.ui.removeClass("njb-ui--last")),1===this.items.length?(this.state.gallery_only=!0,this.dom.ui.addClass("njb-ui--only")):(this.state.gallery_only=!1,this.dom.ui.removeClass("njb-ui--only")),e.loop&&this.items.length>=3?(this.state.gallery_noloop=!1,this.dom.ui.removeClass("njb-ui--no-loop")):(this.state.gallery_noloop=!0,this.dom.ui.addClass("njb-ui--no-loop")),this.state.gallery_noloop&&(this.state.gallery_first?this.dom.prev[0].setAttribute("disabled",!0):this.dom.prev[0].removeAttribute("disabled"),this.state.gallery_last?this.dom.next[0].setAttribute("disabled",!0):this.dom.next[0].removeAttribute("disabled"))},_g_createRawItems:function(){var t=this.o;if(this._g.gallery)if(this.$.isArray(t.content))this._g.items_raw=t.content;else if(this._g.els=this._gatherElements(t.gallery),this._g.items_raw=[],this._g.els&&this._g.els.length)for(var e=0;e<this._g.els.length;e++){var i=this._g.els[e],s=this._gatherData(i);this._cb("item_gathered",s,i),this._g.items_raw.push(s)}},_gatherElements:function(t){return t?this.o.el.find(t):this.o.el}}})}()},,function(t,e,i){t.exports=i(0)}]);