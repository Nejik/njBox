!function(t){function e(i){if(s[i])return s[i].exports;var a=s[i]={i:i,l:!1,exports:{}};return t[i].call(a.exports,a,a.exports,e),a.l=!0,a.exports}var s={};e.m=t,e.c=s,e.i=function(t){return t},e.d=function(t,s,i){e.o(t,s)||Object.defineProperty(t,s,{configurable:!1,enumerable:!0,get:i})},e.n=function(t){var s=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(s,"a",s),s},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/",e(e.s=1)}([function(t,e,s){"use strict";/*!
 * njBox gallery addon
 * nejikrofl@gmail.com
 * Copyright (c) 2017 N.J.
*/
!function(){window.njBox&&njBox.addAddon("gallery",{options:{gallery:"",arrows:!0,start:!1,loop:!0,preload:"1 1",templates:{count:'<div class="njb-ui__count"><span data-njb-current>1</span> / <span data-njb-total>1</span></div>',prev:'<button type="button" class="njb-ui__arrow njb-ui__arrow--prev" data-njb-prev></button>',next:'<button type="button" class="njb-ui__arrow njb-ui__arrow--next" data-njb-next></button>'},text:{current:"Current slide",total:"Total slides",prev:"Previous (Left arrow key)",next:"Next (Right arrow key)"}},prototype:{_gallery_init:function(){var t=this,e=this.o,s=this.$;this.on("options_setted",function(){var t=this.o;t.gallery&&(this.state.gallery=!0),s.isArray(t.content)&&(this.state.gallery=!0)}),this.on("items_raw",function(){this._gallery_createRawItems()}),this.on("domready",function(){this.state.gallery&&(this.dom.ui_count=s(e.templates.count),this.dom.ui[0].appendChild(this.dom.ui_count[0]),this.dom.ui_current=this.dom.ui_count.find("[data-njb-current]"),this.dom.ui_current[0].setAttribute("title",e.text.current),this.dom.ui_total=this.dom.ui_count.find("[data-njb-total]"),this.dom.ui_total[0].setAttribute("title",e.text.total),this.dom.prev=s(e.templates.prev),this.dom.prev[0].setAttribute("title",e.text.prev),this.dom.next=s(e.templates.next),this.dom.next[0].setAttribute("title",e.text.next),e.arrows&&!this.state.arrowsInserted&&this.state.gallery&&(this.dom.next[0]&&this.dom.ui[0].appendChild(this.dom.next[0]),this.dom.prev[0]&&this.dom.ui[0].appendChild(this.dom.prev[0]),this.state.arrowsInserted=!0))}),this.on("item_domready",function(t,e){this.state.gallery&&t.dom.modalOuter[0].setAttribute("data-njb-index",e)}),this.on("inserted",function(){t.state.gallery&&(this._setItemsOrder(this.state.active),t._gallery__uiUpdate())}),this.on("change",function(){t._gallery__uiUpdate()}),this.on("events_setted",function(){var t=(this.o,this),e=this._handlers;e.wrap_prev=function(e){t.prev(),e.preventDefault()},e.wrap_next=function(e){t.next(),e.preventDefault()},this.dom.wrap.delegate("[data-njb-prev]","click",e.wrap_prev).delegate("[data-njb-next]","click",e.wrap_next)}),this.on("events_removed",function(){var t=this._handlers;this.dom.wrap.undelegate("[data-njb-prev]","click",t.wrap_prev).undelegate("[data-njb-next]","click",t.wrap_next)}),this.on("position",function(){this.state.gallery&&(null!==this.state.itemsOrder[0]&&this._setMaxHeight(this.items[this.state.itemsOrder[0]]),null!==this.state.itemsOrder[2]&&this._setMaxHeight(this.items[this.state.itemsOrder[2]]))}),this.on("show",function(){this.state.active=this._detectIndexForOpen()}),this.on("shown",function(){this.state.gallery&&(t._drawItemSiblings(),this._preload())}),this.on("keydown",function(e){this.o;switch(e.which){case 37:t.prev(),e.preventDefault();break;case 39:t.next(),e.preventDefault()}});var i;this.on("clear",function(){i=this.state.gallery}),this.on("cleared",function(){this.state.gallery=i})},prev:function(){return this._changeItem(this.state.active-1,"prev"),this},next:function(){return this._changeItem(this.state.active+1,"next"),this},goTo:function(t){if("number"!=typeof(t-=1))return void this._error("njBox, wrong index argument in goTo method.");if("inited"===this.state.state||"show"===this.state.state)return void(this.state.active=t);if("shown"!==this.state.state||t===this.state.active||t<0||t>this.items.length-1)return this._error("njBox, wrong index in goTo method."),this;var e=t>this.state.active?"next":"prev";if("next"===e&&t===this.state.active+1)this.next();else if("prev"===e&&t===this.state.active-1)this.prev();else switch(this.items[this.state.itemsOrder[0]].dom.modalOuter[0].parentNode.removeChild(this.items[this.state.itemsOrder[0]].dom.modalOuter[0]),this.items[this.state.itemsOrder[2]].dom.modalOuter[0].parentNode.removeChild(this.items[this.state.itemsOrder[2]].dom.modalOuter[0]),this.items[this.state.itemsOrder[0]].dom.modalOuter[0].style.cssText="",this.items[this.state.itemsOrder[2]].dom.modalOuter[0].style.cssText="",e){case"next":this.state.itemsOrder[0]=null,this.state.itemsOrder[2]=t,this._drawItemSiblings(),this._changeItem(t,"next");break;case"prev":this.state.itemsOrder[0]=t,this.state.itemsOrder[2]=null,this._drawItemSiblings(),this._changeItem(t,"prev")}return this},_preload:function(){function t(t){if(null!==t){var e=this.items[t],s=e.content;"loading"!==e.o.status&&"loaded"!==e.o.status&&"image"===e.type&&(document.createElement("img").src=s)}}var e=this.o;if(e.preload&&"shown"===this.state.state){for(var s=e.preload.split(" "),i=parseInt(s[0]),a=this._getItemsOrder(this.state.itemsOrder[0])[0],r=parseInt(s[1]),n=this._getItemsOrder(this.state.itemsOrder[2])[2];r--;)t.call(this,n),n=this._getItemsOrder(n)[2];for(;i--;)t.call(this,a),a=this._getItemsOrder(a)[0]}},_drawItemSiblings:function(){this.o;"number"==typeof this.state.itemsOrder[0]&&(this._moveItem(this.items[this.state.itemsOrder[0]],-110,"%"),this._drawItem(this.state.itemsOrder[0],!0)),"number"==typeof this.state.itemsOrder[2]&&(this._moveItem(this.items[this.state.itemsOrder[2]],110,"%"),this._drawItem(this.state.itemsOrder[2])),this.position(),this._preload()},_moveItem:function(t,e,s){s=s||"px",njBox.g.transform["3d"]?t.dom.modalOuter[0].style.cssText=njBox.g.transform.css+": translate3d("+(e+s)+",0,0)":njBox.g.transform.css?t.dom.modalOuter[0].style.cssText=njBox.g.transform.css+": translateX("+(e+s)+")":t.dom.modalOuter[0].style.cssText="left:"+(e+s)},_changeItem:function(t,e){function s(t){t.dom.modalOuter[0].parentNode.removeChild(t.dom.modalOuter[0]),t.dom.modalOuter[0].style.cssText=""}if(1!==this.items.length&&t!==this.state.active&&!this.state.itemChanging){var i=this.o,a=this;if(!this.items[t]){if(!(i.loop&&this.items.length>2))return;if("next"===e&&t===this.items.length)t=0;else{if("prev"!==e||t!==-1)return;t=this.items.length-1}}switch(this.state.direction=e,this.state.itemChanging=!0,this.state.itemsOrder_backup=this.state.itemsOrder.slice(),this.state.active=t,this._cb("change",t),this._uiUpdate(),this._setItemsOrder(t),e){case"prev":this.items[this.state.itemsOrder_backup[0]].dom.body[0].style.verticalAlign="middle",this._moveItem(this.items[this.state.itemsOrder_backup[1]],110,"%"),this._moveItem(this.items[this.state.itemsOrder_backup[0]],0,"%");break;case"next":this.items[this.state.itemsOrder_backup[2]].dom.body[0].style.verticalAlign="middle",this._moveItem(this.items[this.state.itemsOrder_backup[1]],-110,"%"),this._moveItem(this.items[this.state.itemsOrder_backup[2]],0,"%")}setTimeout(function(){if("shown"!==a.state.state)return void(a.state.itemChanging=!1);s(a.items[a.state.itemsOrder_backup[1]]);var t="prev"===e?a.state.itemsOrder_backup[2]:a.state.itemsOrder_backup[0];a.items[t]&&s(a.items[t]),delete a.state.itemsOrder_backup,a._setItemsOrder(a.state.active),a._drawItemSiblings(),a._setFocusInPopup(a.items[a.state.active]),a.state.itemChanging=!1,a._cb("changed",a.state.active)},this._getAnimTime(this.items[this.state.itemsOrder[1]].dom.modalOuter))}},_detectIndexForOpen:function(){var t=this.o,e=this,s=this.state.active||0;return this.state.gallery&&t.start-1&&this.items[t.start-1]&&(s=t.start-1),this.state.gallery&&this.data.els&&this.data.els.length&&e.state.clickedEl&&t.click&&this.data.els.each(function(t,i){if(e.state.clickedEl===i)return void(s=t)}),s},_setItemsOrder:function(t){this.state.itemsOrder=this._getItemsOrder(t)},_getItemsOrder:function(t){var e=this.o,s=t-1,i=t+1;return e.loop&&this.items.length>2&&(s===-1&&(s=this.items.length-1),i===this.items.length&&(i=0)),this.items[s]||(s=null),this.items[i]||(i=null),[s,t,i]},_gallery__uiUpdate:function(t){t=t||this.state.active;var e=this.o;this.items[t]||this._error("njBox, can't update ui info from item index - "+t),this.dom.wrap.find("[data-njb-current]").html(t+1||""),this.dom.wrap.find("[data-njb-total]").html(this.items.length||""),e.loop&&this.items.length>=3?this.dom.ui.removeClass("njb-ui--no-loop"):this.dom.ui.addClass("njb-ui--no-loop"),0===t?this.dom.ui.addClass("njb-ui--first"):this.dom.ui.removeClass("njb-ui--first"),t===this.items.length-1?this.dom.ui.addClass("njb-ui--last"):this.dom.ui.removeClass("njb-ui--last"),1===this.items.length?this.dom.ui.addClass("njb-ui--only"):this.dom.ui.removeClass("njb-ui--only")},_gallery_createRawItems:function(){var t=this.o;if(this.state.gallery)if(this.$.isArray(t.content))this.data.items_raw=t.content;else if(this.data.els=this._gatherElements(t.gallery),this.data.items_raw=[],this.data.els&&this.data.els.length)for(var e=0;e<this.data.els.length;e++){var s=this.data.els[e],i=this._gatherData(s);this._cb("item_gathered",i,s),this.data.items_raw.push(i)}},_gatherElements:function(t){return t?this.o.el.find(t):this.o.el}}})}()},function(t,e,s){t.exports=s(0)}]);