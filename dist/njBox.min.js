!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("njBox",[],e):"object"==typeof exports?exports.njBox=e():t.njBox=e()}(this,function(){return function(t){function e(n){if(o[n])return o[n].exports;var i=o[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var o={};return e.m=t,e.c=o,e.i=function(t){return t},e.d=function(t,o,n){e.o(t,o)||Object.defineProperty(t,o,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/",e(e.s=3)}([function(t,e,o){"use strict";function n(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),a=o(1),d=n(a),l=o(2),c=window.jQuery||d.default,h=function(){function t(e,o){if(i(this,t),!arguments.length)return void console.error("njBox, arguments not passed.");var n=void 0,s=this;!o&&e?n=c.isPlainObject(e)?e:{elem:e}:(n=o,n.elem=e),n=n||{},this.constructorOptions=n,setTimeout(function(){s._init()},0)}return r(t,[{key:"_init",value:function(){if(!this.state||!this.state.inited){var e=this.constructorOptions;delete this.constructorOptions,t.g||(t.g=(0,l.getDefaultInfo)()),this.state={active:0},this._globals={},this._handlers={},this.data={optionsPassed:e};var o=this.o=c.extend({},t.defaults,e);o.jquery&&(c=o.jquery),this.$=c,this.dom={document:c(document),window:c(window),html:c(document.documentElement),body:c(document.body)};for(var n in t.addons)t.addons.hasOwnProperty(n)&&this["_"+n+"_init"]();if(!o.elem&&!o.content)return void this._error("njBox, no elements (o.elem) or content (o.content) for modal.");if(o.elem){var i=c(o.elem);if(!i.length)return void this._error("njBox, element not found ("+o.elem+")");if(i.length>1&&(i=c(i[0])),i[0].njBox)return void this._error("njBox, already inited on this element");i[0].njBox=this,this.data.optionsGathered=this._gatherData(i),this._cb("options_gathered",this.data.optionsGathered,i[0]),c.extend(!0,this.o,this.data.optionsGathered)}this._cb("options_setted",o),this._options_setted(),this._createDom(),this.items=this._createItems(),this._calculateAnimations(),this._setClickHandlers(),this.state.inited=!0,this._cb("inited")}}},{key:"show",value:function(t){this._init(),void 0!==t&&(this.state.active=t-1);this.o;return"inited"!==this.state.state?void this._error("njBox, show, plugin not inited or in not inited state(probably plugin is already visible or destroyed, or smth else..)"):this.items.length?this._cb("show")!==!1?(this.returnValue=null,this.dom.container[0].njb_instances?this.dom.container[0].njb_instances++:this.dom.container[0].njb_instances=1,this._scrollbar("hide"),this._backdrop("show"),this.dom.container[0].appendChild(this.dom.wrap[0]),this._setEventsHandlers(),this._drawItem(this.state.active),this._cb("inserted"),this.position(),this.dom.wrap[0].style.display="none",this.dom.wrap[0].clientHeight,this.dom.wrap[0].style.display="block",this._uiUpdate(),this._anim("show"),this):void 0:void this._error("njBox, smth goes wrong, plugin don't create any item to show",!0)}},{key:"hide",value:function(){if("shown"!==this.state.state)return void this._error("njBox, hide, we can hide only showed modal (probably animation is still running or plugin destroyed).");this.o,this._handlers;if(this._cb("hide")!==!1)return this.state.clickedEl&&this.state.clickedEl.focus(),this._backdrop("hide"),this._removeEventsHandlers(),this._anim("hide"),this}},{key:"position",value:function(){if(this.state.inited){var t=this.o;if(this._getContainerSize(),"absolute"===t.position){var e=this.state.dimensions.containerScrollTop,o=this.state.dimensions.containerScrollLeft;e<=this.state.dimensions.containerMaxScrollTop&&this.dom.wrap.css({top:e+"px",left:o+"px"}),this.dom.backdrop.css({width:"auto",height:"auto"}),this.dom.backdrop[0].clientHeight,this.dom.backdrop.css({width:this.state.dimensions.containerScrollWidth+"px",height:this.state.dimensions.containerScrollHeight+"px"})}return this._setMaxHeight(this.items[this.state.active]),this._cb("position"),this}}},{key:"destroy",value:function(){return this.state.inited&&"inited"===this.state.state?(this._removeClickHandlers(),this.dom.container.removeClass("njb-relative"),this._cb("destroy"),this._events=this._globals=this._handlers=this.items=this.itemsRaw=this.dom=this.$=void 0,this.o={},this):void this._error("njBox, we can destroy only initialized && hidden modals.")}},{key:"update",value:function(){return this.items=this._createItems(),this._setClickHandlers(),this}},{key:"_getContainerSize",value:function(){var t=(this.o,this.state.dimensions={});this.dom.container[0]===this.dom.body[0]?(t.containerWidth=document.documentElement.clientWidth,t.containerHeight=document.documentElement.clientHeight,t.containerScrollWidth=Math.max(document.body.scrollWidth,document.documentElement.scrollWidth,document.body.offsetWidth,document.documentElement.offsetWidth,document.body.clientWidth,document.documentElement.clientWidth),t.containerScrollHeight=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight),t.containerScrollTop=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop,t.containerScrollLeft=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft):(t.containerWidth=this.dom.container[0].clientWidth,t.containerHeight=this.dom.container[0].clientHeight,t.containerScrollWidth=this.dom.container[0].scrollWidth,t.containerScrollHeight=this.dom.container[0].scrollHeight,t.containerScrollTop=this.dom.container[0].scrollTop,t.containerScrollLeft=this.dom.container[0].scrollLeft),t.containerMaxScrollTop=t.containerScrollHeight-t.containerHeight,t.winHeight=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,t.autoheight=this.dom.container[0]===this.dom.body[0]?t.winHeight:t.containerHeight}},{key:"_setMaxHeight",value:function(t){function e(t,e){return parseInt(t.css(e+"Top"))+parseInt(t.css(e+"Bottom"))||0}var o=this.o;if(o.autoheight&&("image"!==o.autoheight||"image"===t.type)){this.state.autoheightAdded||(o.autoheight===!0?this.dom.wrap.addClass("njb-wrap--autoheight-true"):this.dom.wrap.addClass("njb-wrap--autoheight-image"),this.state.autoheightAdded=!0);var n=t.dom,i=e(n.modal,"margin"),s=e(n.modal,"padding")+parseInt(n.modal.css("borderTopWidth"))+parseInt(n.modal.css("borderBottomWidth"))||0,r=e(n.body,"margin"),a=e(n.body,"padding")+parseInt(n.body.css("borderTopWidth"))+parseInt(n.body.css("borderBottomWidth"))||0,d=this.state.dimensions.autoheight,l=d,c="border-box"===n.body.css("boxSizing"),h=0,u=0;if(n.header&&n.header.length&&(h=n.header[0].scrollHeight+(parseInt(n.header.css("borderTopWidth"))+parseInt(n.header.css("borderBottomWidth")))||0),n.footer&&n.footer.length&&(u=n.footer[0].scrollHeight+(parseInt(n.footer.css("borderTopWidth"))+parseInt(n.footer.css("borderBottomWidth")))||0),l=d-i-s-r-h-u,c||(l-=a),"image"===t.type){var m=d-i-s-r-a-h-u;n.img&&n.img.css("maxHeight",m+"px")}else n.body.css("maxHeight",l+"px")}}},{key:"_gatherData",value:function(t){function e(t){var e={};for(var n in t)if(t.hasOwnProperty(n)&&/^njb[A-Z]+/.test(n)){var i=n.match(/^njb(.*)/)[1],s=i.charAt(0).toLowerCase()+i.slice(1);e[s]=o(t[n])}return e}function o(t){var e=parseFloat(t);return"true"===t||"false"!==t&&(isNaN(e)?t:e)}var n=this.o,i=c(t),s=c.extend(!0,{},i.data()),r={};if(!i.length)return r;if(s.njbOptions)try{r=c.parseJSON(s.njbOptions),delete s.njbOptions}catch(t){return void this._error("njBox, fail to parse options from njb-options")}if(i.length&&(r.el=i),"a"===i[0].tagName.toLowerCase()){var a=i[0].getAttribute("href");a&&"#"!==a&&"#!"!==a&&!/^(?:javascript)/i.test(a)&&(r.content=a)}if(n.title_attr){var d=i[0].getAttribute(n.title_attr);d&&(r.title=d)}return c.extend(!0,r,e(s)),r}},{key:"_createItems",value:function(){this.o;this.data.els=this.o.el,this.data.items_raw=[this.o],this._cb("items_raw",this.data);for(var t=[],e=0,o=this.data.items_raw.length;e<o;e++)t.push(this._createItem(this.data.items_raw[e],e));return t}},{key:"_createItem",value:function(t,e){var o=this._normalizeItem(t);return this._createDomForItem(o,e),o}},{key:"_normalizeItem",value:function(t,e){var o=void 0;o="function"==typeof t.content?t.content.call(this,t):t.content;var n=o||this.o.text._missedContent;return{content:n,type:t.type||this._type(n),header:t.header,footer:t.footer,title:t.title,el:t.el||e,o:{status:"inited"},raw:t}}},{key:"_type",value:function(t){var e="html";if("object"===(void 0===t?"undefined":s(t))){if(window.jQuery&&t instanceof window.jQuery||window.j&&t instanceof window.j)return"selector"}else{if(/^[#.]\w/.test(t))return"selector";if(/\.(png|jpg|jpeg|gif|tiff|bmp|webp)(\?\S*)?$/i.test(t))return"image"}return e}},{key:"_createDomForItem",value:function(t,e){var o=this.o,n=t.dom={},i=document.createDocumentFragment();if(n.modalOuter=c(o.templates.modalOuter),n.modalOuter[0].njBox=this,n.modal=c(o.templates.modal),n.modal[0].setAttribute("tabindex","-1"),n.modal[0].njBox=this,!n.modal.length)return void this._error("njBox, error in o.templates.modal");if(n.modalOuter[0].appendChild(n.modal[0]),"template"===t.type)n.modal[0].innerHTML=t.content;else{if(n.body=c(o.templates.body),!n.body.length)return void this._error("njBox, error in o.templates.body");if(n.bodyInput=null!==n.body[0].getAttribute("data-njb-body")?n.body:n.body.find("[data-njb-body]"),this._insertItemBodyContent(t),i.appendChild(n.body[0]),t.header){if(n.header=c(o.templates.header),!n.header.length)return void this._error("njBox, error in o.templates.header");(null!==n.header[0].getAttribute("data-njb-header")?n.header:n.header.find("[data-njb-header]"))[0].innerHTML=t.header,i.insertBefore(n.header[0],i.firstChild)}if(t.footer){if(n.footer=c(o.templates.footer),!n.footer.length)return void this._error("njBox, error in njBox.templates.footer");(null!==n.footer[0].getAttribute("data-njb-footer")?n.footer:n.footer.find("[data-njb-footer]"))[0].innerHTML=t.footer,i.appendChild(n.footer[0])}"inside"===o.close&&(n.close=c(o.templates.close),n.close[0].setAttribute("title",o.text.close),i.appendChild(n.close[0])),n.modal[0].appendChild(i)}"image"===t.type?t.dom.modal.addClass("njb--image"):t.dom.modal.addClass("njb--content"),this._cb("item_domready",t,e)}},{key:"_insertItemBodyContent",value:function(t){var e=this.o;switch(t.type){case"text":"textContent"in t.dom.bodyInput[0]?t.dom.bodyInput[0].textContent=t.content:t.dom.bodyInput[0].innerText=t.content,t.o.status="loaded";break;case"html":t.dom.bodyInput[0].innerHTML=t.content,t.o.status="loaded";break;case"selector":this._getItemFromSelector(t),t.o.status="loaded";break;case"image":"init"===e.imgload&&this._insertImage(t);break;default:return this._error("njBox, seems that you use wrong type("+t.type+") of item.",!0),void(t.o.status="loaded")}}},{key:"_getItemFromSelector",value:function(t){t.o.contentEl=c(t.content),t.o.contentEl.length||(t.dom.bodyInput[0].innerHTML=t.content)}},{key:"_createDom",value:function(){var t=this.o;if(this.dom.container=c(t.container),this.dom.container.length||(this._error("njBox, can't find container element. (we use body instead)"),this.dom.container=this.dom.body),this.dom.container[0]!==this.dom.body[0]&&"static"===this.dom.container.css("position")&&this.dom.container.addClass("njb-relative"),this.dom.wrap=c(t.templates.wrap),!this.dom.wrap.length)return void this._error("njBox, smth wrong with o.templates.wrap.");t.class&&this.dom.wrap.addClass(t.class),this.dom.wrap[0].njBox=this,t.zindex&&this.dom.wrap.css("zIndex",t.zindex),this.dom.items=this.dom.wrap.find(".njb-items"),this.dom.container[0]!==this.dom.body[0]&&(t.position="absolute"),"absolute"===t.position&&this.dom.wrap.addClass("njb-absolute"),this.dom.ui=c(t.templates.ui),this.dom.wrap[0].appendChild(this.dom.ui[0]),this.dom.title=c(t.templates.title),this.dom.ui[0].appendChild(this.dom.title[0]),"outside"===t.close&&(this.dom.close=c(t.templates.close),this.dom.close[0].setAttribute("title",t.text.close),this.dom.close[0].setAttribute("aria-label",t.text.close),this.dom.ui[0].appendChild(this.dom.close[0])),this.dom.focusCatcher=c(t.templates.focusCatcher),this.dom.wrap[0].appendChild(this.dom.focusCatcher[0]),this._cb("domready")}},{key:"_drawItem",value:function(t,e){var o=(this.o,this.items[t]);if(!o)return void this._error("njBox, we have no item with this index - "+t,!0);this._cb("item_prepare",o),this._insertDelayedContent(o),e?this.dom.items[0].insertBefore(o.dom.modalOuter[0],this.dom.items[0].firstChild):this.dom.items[0].appendChild(o.dom.modalOuter[0]),this._cb("item_inserted",o)}},{key:"_insertDelayedContent",value:function(t){var e,o=this.o;if("image"!==t.type||"show"!==o.imgload||t.o.imageInserted){if("selector"===t.type&&!t.o.contentElInserted){if(e=t.o.contentEl,e&&e.length||(this._getItemFromSelector(t),e=t.o.contentEl),!e||!e.length)return;var n=e[0].style.cssText;n&&(t.o.contentElStyle=n);var i="none"===e.css("display");i&&(t.o.contentElDisplayNone=!0,e[0].style.display="block"),t.dom.bodyInput[0].innerHTML="",t.dom.bodyInput[0].appendChild(e[0]),t.o.contentElInserted=!0}}else this._insertImage(t)}},{key:"_removeSelectorItemsElement",value:function(){for(var t,e,o=this.items,n=0,i=o.length;n<i;n++)if("selector"===o[n].type){if(t=o[n],!t.o.contentElInserted)continue;e=t.o.contentEl,t.o.contentElDisplayNone&&(e[0].style.display="none",t.o.contentElDisplayNone=void 0),t.o.contentElStyle&&(e[0].style.cssText=t.o.contentElStyle,t.o.contentElStyle=void 0),this.dom.body[0].appendChild(e[0]),t.o.contentElInserted=!1}}},{key:"_getFocusableElement",value:function(t){var e=this.o,o=void 0;if(e.autofocus)return o=t.dom.modal.find(e.autofocus),o&&o.length||(o=t.dom.modal.find("[autofocus]")),o&&o.length||(o=t.dom.modal.find(this.o._focusable)),o}},{key:"_setFocusInPopup",value:function(t,e){var o=(this.o,this._getFocusableElement(t));o&&o.length?o[0].focus():t.dom.modal[0].focus()}},{key:"_setClickHandlers",value:function(){var t=this.o;this._removeClickHandlers(),this._handlers.elsClick=this._clickHandler(),t.click&&this.data.els&&this.data.els.length&&this.data.els.on("click",this._handlers.elsClick),t.clickels&&c(t.clickels).on("click",this._handlers.elsClick)}},{key:"_clickHandler",value:function(){var t=(this.o,this);return function(e){var o=this;if(e.originalEvent&&(e=e.originalEvent),!("which"in e&&(1!==e.which||1===e.which&&e.ctrlKey&&e.shiftKey))){if(e.preventDefault?e.preventDefault():e.returnValue=!1,e.njb_stopPropagation=!0,"inited"!==t.state.state)return void t._error("njBox, show, plugin not inited or in not inited state(probably plugin is already visible or destroyed, or smth else..)");c(o).closest(".njb-close-system, .njb-arrow").length||(t.state.clickedEvent=e,t.state.clickedEl=o,t.show())}}}},{key:"_removeClickHandlers",value:function(){var t=this.o;this.data.els&&this.data.els.length&&(this.data.els.off("click",this._handlers.elsClick),t.clickels&&c(t.clickels).off("click",this._handlers.elsClick))}},{key:"_setEventsHandlers",value:function(){var t=this.o,e=this,o=this._handlers;o.container_resize=function(){e.position()},o.container_scroll=function(){e.position()},o.container_out=function(o){if(!o.njb_stopPropagation){if(!c(o.target).closest(".njb, .njb-ui").length)if(o.preventDefault?o.preventDefault():o.returnValue=!1,t.out){if(e._cb("cancel")===!1)return;e.hide()}else e.items[e.state.active].dom.modal.addClass("njb_pulse"),e._setFocusInPopup(e.items[e.state.active]),setTimeout(function(){e.items[e.state.active].dom.modal.removeClass("njb_pulse")},e._getAnimTime(e.items[e.state.active].dom.modal[0]))}},this.dom.container.on("resize",o.container_resize).on("scroll",o.container_scroll).on("click",o.container_out),o.wrap_resize=function(){},o.wrap_scroll=function(t){},o.wrap_keydown=function(o){switch(e._cb("keydown",o),o.which){case 27:if(t.esc){if(e._cb("cancel")===!1)return;e.hide()}o.preventDefault?o.preventDefault():o.returnValue=!1}},o.wrap_close=function(t){t.preventDefault?t.preventDefault():t.returnValue=!1,e._cb("cancel")!==!1&&e.hide()},o.wrap_ok=function(t){t.preventDefault?t.preventDefault():t.returnValue=!1,e._cb("ok")!==!1&&e.hide()},o.wrap_cancel=function(t){t.preventDefault?t.preventDefault():t.returnValue=!1,e._cb("cancel")!==!1&&e.hide()},this.dom.wrap.on("resize",o.wrap_resize).on("scroll",o.wrap_scroll).on("keydown",o.wrap_keydown).delegate("[data-njb-close]","click",o.wrap_close).delegate("[data-njb-ok]","click",o.wrap_ok).delegate("[data-njb-cancel]","click",o.wrap_cancel),o.window_resize=function(t){e.position()},o.window_scroll=function(t){e.position()},o.window_orientation=function(t){e.position()},this.dom.window.on("resize",o.window_resize).on("scroll",o.window_scroll).on("orientationchange",o.window_orientation),o.focusCatch=function(t){e._setFocusInPopup(e.items[e.state.active])},this.dom.focusCatcher.on("focus",o.focusCatch),this._cb("events_setted")}},{key:"_removeEventsHandlers",value:function(){var t=this._handlers;this.dom.container.off("resize",t.container_resize).off("scroll",t.container_scroll).off("click",t.container_out),this.dom.wrap.off("resize",t.wrap_resize).off("scroll",t.wrap_scroll).off("keydown",t.wrap_keydown).undelegate("[data-njb-close]","click",t.wrap_close).undelegate("[data-njb-ok]","click",t.wrap_ok).undelegate("[data-njb-cancel]","click",t.wrap_cancel),this.dom.window.off("resize",t.window_resize).off("scroll",t.window_scroll).off("orientationchange",t.window_orientation);var e=t.elsClick;this._handlers={elsClick:e},this.dom.focusCatcher.off("focus",t.focusCatch),this._cb("events_removed")}},{key:"_insertImage",value:function(t){function e(e){s._cb("item_img_"+e,t),e!==r.img&&e!==!0||(t.o.status="loaded",s._preloader("hide",t),d[0].setAttribute("width","auto"),t.dom.bodyInput[0].appendChild(a),t.o.imageInserted=!0)}function o(t){var e,o=0;!function n(i){e&&clearInterval(e),e=setInterval(function(){if(t.width>0)return d.triggerHandler("njb_ready"),void clearInterval(e);o>200&&clearInterval(e),o++,5===o?n(10):40===o?n(50):100===o&&n(500)},i)}(1)}var n,i,s=this,r=this.o,a=document.createElement("img"),d=c(a);t.o.status="loading",t.dom.img=d,t._handlerError=function(){d.off("error",t._handlerError).off("abort",t._handlerError),delete t._handlerError,s._preloader("hide",t),t.dom.bodyInput[0].innerHTML=r.text.imageError.replace("%url%",t.content),s._cb("img_error",t),t.o.status="error",t.o.imageInserted=!0},d.on("error",t._handlerError).on("abort",t._handlerError),t.title&&a.setAttribute("aria-labelledby","njb-title"),a.src=t.content,n=a.width+a.height>0,i=a.complete&&a.width+a.height>0,"ready"===r.img&&n||"load"===r.img&&i?e(!0):(this._preloader("show",t),t._handlerImgReady=function(){d.off("njb_ready",t._handlerImgReady),e("ready")},d.on("njb_ready",t._handlerImgReady),o(a),t._handlerLoad=function(){d.off("load",t._handlerLoad),e("load")},d.on("load",t._handlerLoad))}},{key:"_preloader",value:function(t,e){var o=this.o;switch(t){case"show":e.o.preloader=!0,e.dom.preloader=c(o.templates.preloader),e.dom.preloader[0].setAttribute("title",o.text.preloader),e.dom.modal.addClass("njb--loading"),e.dom.bodyInput[0].appendChild(e.dom.preloader[0]);break;case"hide":if(!e.o.preloader)return;e.dom.preloader[0].parentElement.removeChild(e.dom.preloader[0]),e.dom.modal.removeClass("njb--loading"),delete e.dom.preloader,delete e.o.preloader}}},{key:"_uiUpdate",value:function(t){t=t||this.state.active;var e=(this.o,this.items[t]);if(!e)return void this._error("njBox, can't update ui info from item index - "+t);e.title?this.dom.ui.addClass("njb-ui--title"):this.dom.ui.removeClass("njb-ui--title"),this.dom.wrap.find("[data-njb-title]").html(e.title||""),"image"===e.type?this.dom.wrap.removeClass("njb-wrap--content").addClass("njb-wrap--image"):this.dom.wrap.removeClass("njb-wrap--image").addClass("njb-wrap--content")}},{key:"_scrollbar",value:function(e){var o=this.o;switch(e){case"hide":if("hide"===o.scrollbar){if(this.state.scrollbarHidden)return;if(this.dom.container[0]===this.dom.body[0]){var n=(document.documentElement.scrollHeight||document.body.scrollHeight)>document.documentElement.clientHeight;this.dom.container[0].njb_scrollbar||this.state.scrollbarHidden||!n&&"scroll"!==this.dom.html.css("overflowY")&&"scroll"!==this.dom.body.css("overflowY")||(this.dom.html.addClass("njb-hideScrollbar"),this.dom.html.css("paddingRight",parseInt(this.dom.html.css("paddingRight"))+t.g.scrollbarSize+"px"))}else{var n=this.dom.container[0].scrollHeight>this.dom.container[0].clientHeight;this.dom.container.addClass("njb-hideScrollbar")}this.state.scrollbarHidden=!0,this.dom.container[0].njb_scrollbar?this.dom.container[0].njb_scrollbar++:this.dom.container[0].njb_scrollbar=1}break;case"show":if(!this.state.scrollbarHidden)return;if(--this.dom.container[0].njb_scrollbar)return void delete this.state.scrollbarHidden;if(this.dom.container[0].njb_scrollbar=null,this.dom.container[0]===this.dom.body[0]){this.dom.html.removeClass("njb-hideScrollbar");var i=parseInt(this.dom.html.css("paddingRight"))-t.g.scrollbarSize;i?this.dom.html.css("paddingRight",i+"px"):this.dom.html[0].style.paddingRight=""}else{this.dom.container.removeClass("njb-hideScrollbar");var i=parseInt(this.dom.container.css("paddingRight"))-t.g.scrollbarSize;i?this.dom.container.css("paddingRight",i+"px"):this.dom.container[0].style.paddingRight=""}delete this.state.scrollbarHidden}}},{key:"_backdrop",value:function(t){var e=this.o,o=this;switch(t){case"show":if(this.dom.backdrop=c(e.templates.backdrop),this.state.backdropVisible)return;e.backdrop===!0&&(e.backdropassist&&this.dom.backdrop.css("transitionDuration",this._globals.animShowDur+"ms"),"absolute"===e.position&&this.dom.backdrop.addClass("njb-absolute"),this.dom.container[0].appendChild(this.dom.backdrop[0]),setTimeout(function(){o.dom.backdrop.addClass("njb-backdrop--visible")},0),this.state.backdropVisible=!0);break;case"hide":if(!this.state.backdropVisible)return;e.backdropassist&&this.dom.backdrop.css("transitionDuration",this._globals.animHideDur+"ms"),this.dom.backdrop.removeClass("njb-backdrop--visible"),setTimeout(function(){o.dom.backdrop[0].parentNode.removeChild(o.dom.backdrop[0]),e.backdropassist&&(o.dom.backdrop[0].style.cssText=""),delete o.state.backdropVisible},o._getAnimTime(o.dom.backdrop[0]))}}},{key:"_calculateAnimations",value:function(){var t,e,o,n,i,s=this.o,r=!1;s.anim&&(i=s.anim.split(" "),t=i[0],e=i[1]?i[1]:i[0]),s.duration&&(s.duration=s.duration.toString(),i=s.duration.split(" "),o=i[0],n=i[1]?i[1]:i[0]);var a=document.createElement("div");a.style.cssText="visibility: hidden; position: absolute;",o&&"auto"!==o||!t?o=parseInt(o)||0:(a.className=(s.animclass||"")+" "+t,document.body.appendChild(a),r=!0,o=this._getAnimTime(a)),n&&"auto"!==n||!e?n=parseInt(n)||0:(a.className=(s.animclass||"")+" "+e,r||(document.body.appendChild(a),r=!0),n=this._getAnimTime(a)),r&&document.body.removeChild(a),this._globals.animShow=t,this._globals.animHide=e,this._globals.animShowDur=o,this._globals.animHideDur=n}},{key:"_getAnimTime",value:function(t,e){function o(t,e){var o,n,i,s,r=c(t),a=[];if(!r.length)return 0;if(!e)return 0;o=r.css(e+"Duration"),i=r.css(e+"Delay"),o&&void 0!==o||(o="0s"),n=o.split(", ");for(var d=0,l=n.length;d<l;d++)n[d]=n[d].indexOf("ms")>-1?parseFloat(n[d]):1e3*parseFloat(n[d]);i&&void 0!==i||(i="0s"),s=i.split(", ");for(var d=0,l=s.length;d<l;d++)s[d]=s[d].indexOf("ms")>-1?parseFloat(s[d]):1e3*parseFloat(s[d]);for(var d=0,l=n.length;d<l;d++)a[d]=n[d]+s[d];return Math.max.apply(Math,a)}return o(t,"animation")||o(t,"transition")}},{key:"_anim",value:function(t){function e(){n.animclass&&s.removeClass(n.animclass),s.removeClass(r),i._cb("shown"),i._setFocusInPopup(i.items[i.state.active],!0)}function o(){n.animclass&&s.removeClass(n.animclass),a===r&&s.removeClass("njb-anim-reverse"),s.removeClass(a),i._clear(),i._cb("hidden")}var n=this.o,i=this,s=this.items[this.state.active].dom.modal,r=this._globals.animShow,a=this._globals.animHide,d=this._globals.animShowDur,l=this._globals.animHideDur;switch(t){case"show":this.dom.wrap[0].clientHeight,this.dom.wrap.addClass("njb-wrap--visible"),r?(n.animclass&&s.addClass(n.animclass),s[0].setAttribute("open",""),s.addClass(r),setTimeout(e,d)):e();break;case"hide":s[0].removeAttribute("open"),this.dom.wrap.removeClass("njb-wrap--visible"),a?(n.animclass&&s.addClass(n.animclass),a===r&&s.addClass("njb-anim-reverse"),s.addClass(a),setTimeout(o,l)):o()}}},{key:"_focusPreviousModal",value:function(){var t,e=this.dom.body.find(".njb-wrap");e.length&&(t=e[e.length-1].njBox,t._setFocusInPopup(t.items[t.state.active]))}},{key:"_options_setted",value:function(){}},{key:"_clear",value:function(){function t(t){for(;t.firstChild;)t.removeChild(t.firstChild)}var e=this.o;this._cb("clear"),this.dom.container&&this.dom.container[0].njb_instances--,e.class&&this.dom.wrap.removeClass(e.class),this._scrollbar("show"),this.dom.wrap&&this.dom.wrap.length&&this.dom.wrap[0].parentNode.removeChild(this.dom.wrap[0]),this._removeSelectorItemsElement(),this.dom.items&&this.dom.items.length&&t(this.dom.items[0]);for(var o=0,n=this.items.length;o<n;o++)this.items[o].dom.modalOuter[0].style.cssText="";this.state={inited:!0,state:"inited",active:0},this._cb("cleared")}},{key:"_error",value:function(t,e){t&&(e&&this._clear(),console.error(t))}},{key:"_cb",value:function(t){var e,o=this.o;switch("inited"!==t&&"show"!==t&&"shown"!==t&&"hide"!==t&&"hidden"!==t&&"destroy"!==t&&"destroyed"!==t||(this.state.state=t),t){case"hidden":this.state.state="inited",o.focusprevious&&this._focusPreviousModal()}this.trigger.apply(this,arguments);var n=Array.prototype.slice.call(arguments);o.oncb&&"function"==typeof o.oncb&&(e=o.oncb.apply(this,n)),this.trigger.apply(this,["cb"].concat(n));var i=Array.prototype.slice.call(arguments,1);if("ok"===t||"cancel"===t){var s=this.items[this.state.active].dom.modal,r=s.find("[data-njb-return]"),a=void 0;r.length&&(a=r[0].value||null),i.unshift(a),this.returnValue=a}return"function"==typeof o["on"+t]&&(e=o["on"+t].apply(this,i)),e}},{key:"on",value:function(t,e){return this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(e),this}},{key:"off",value:function(t,e){if(this._events=this._events||{},t in this._events!=!1)return this._events[t].splice(this._events[t].indexOf(e),1),this}},{key:"trigger",value:function(t){if(this._events=this._events||{},t in this._events!=!1){for(var e=0;e<this._events[t].length;e++)this._events[t][e].apply(this,Array.prototype.slice.call(arguments,1));return this}}}]),t}();document.body&&!h.g&&(h.g=(0,l.getDefaultInfo)()),h.addons={},h.defaults=l.defaults,h.addAddon=function(t,e){h.addons[t]=!0,e.options&&c.extend(!0,h.defaults,e.options),c.extend(h.prototype,e.prototype)},h.get=function(t){var e=c(t)[0];return e?e.njBox||null:null},h.autobind=function(){c(h.defaults.autobind).each(function(){new h({elem:c(this)})})},"undefined"!=typeof window&&c(function(){h.autobind()}),h.alert=function(t,e,o){return new h({content:function(e){return'<div class="njb__body">\n'+(t||this.o.text._missedContent)+'\n</div>\n<div class="njb__footer">\n  <button data-njb-ok>'+this.o.text.ok+"</button>\n</div>"},type:"template",out:!1,onok:e,oncancel:o}).show()},h.confirm=function(t,e,o){return new h({content:function(e){return'<div class="njb__body">\n'+(t||this.o.text._missedContent)+'\n</div>\n<div class="njb__footer">\n  <button data-njb-ok>'+this.o.text.ok+"</button>\n  <button data-njb-cancel>"+this.o.text.cancel+"</button>\n</div>"},type:"template",out:!1,onok:e,oncancel:o}).show()},h.prompt=function(t,e,o,n){return"function"==typeof e&&(n=o,o=e,e=""),new h({content:function(o){return'<div class="njb__body">\n'+(t||this.o.text._missedContent)+'\n<div>\n  <input data-njb-return type="text" placeholder="'+(e||"")+'" />\n</div>\n</div>\n<div class="njb__footer">\n  <button data-njb-ok>'+this.o.text.ok+"</button>\n  <button data-njb-cancel>"+this.o.text.cancel+"</button>\n</div>"},type:"template",out:!1,onok:o,oncancel:n}).show()},e.default=h,t.exports=e.default},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i=function t(e){return new t.fn.init(e||"")};i.match=function(t,e){return t===document&&(t=document.documentElement),(t.matches||t.matchesSelector||t.oMatchesSelector||t.mozMatchesSelector||t.webkitMatchesSelector||t.msMatchesSelector).call(t,e)},i.fn=i.prototype,i.fn.init=function(t){var e;"string"==typeof t&&t.length>0?e="<"===t.charAt(0)&&">"===t.charAt(t.length-1)?i.str2dom?i.str2dom(t):[]:document.querySelectorAll(t):t instanceof Array||t instanceof NodeList||t instanceof HTMLCollection||t instanceof i?e=t:t.nodeType||window.Node&&t instanceof Node||t==t.window||"object"===(void 0===t?"undefined":n(t))?e=[t]:"function"==typeof t?(e=[document],document.addEventListener("DOMContentLoaded",t)):e=[],this.length=e.length;for(var o=0,s=this.length;o<s;o++)this[o]=e[o];return this},i.fn.init.prototype=i.fn,i.fn.each=function(t){for(var e=0,o=this.length;e<o&&t.call(this[e],e,this[e])!==!1;e++);return this},i.str2dom=function(t){var e=document.createElement("div");return e.innerHTML=t,e.childNodes},i.isArray=function(t){return"array"===i.type(t)},i.isFunction=function(t){return"function"==i.type(t)},i.isPlainObject=function(t){var e,o={},n={}.hasOwnProperty;if(!t||"object"!==i.type(t)||t.nodeType||i.isWindow(t))return!1;try{if(t.constructor&&!n.call(t,"constructor")&&!n.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}if(o.ownLast)for(e in t)return n.call(t,e);for(e in t);return void 0===e||n.call(t,e)},i.isWindow=function(t){return null!=t&&t==t.window},i.type=function(t){var e=e={"[object Array]":"array","[object Boolean]":"boolean","[object Date]":"date","[object Error]":"error","[object Function]":"function","[object Number]":"number","[object Object]":"object","[object RegExp]":"regexp","[object String]":"string"},o=e.toString;return null==t?t+"":"object"===(void 0===t?"undefined":n(t))||"function"==typeof t?e[o.call(t)]||"object":void 0===t?"undefined":n(t)},i.extend=function(){var t,e,o,s,r,a,d=arguments[0]||{},l=1,c=arguments.length,h=!1;for("boolean"==typeof d&&(h=d,d=arguments[l]||{},l++),"object"===(void 0===d?"undefined":n(d))||i.isFunction(d)||(d={}),l===c&&(d=this,l--);l<c;l++)if(null!=(r=arguments[l]))for(s in r)t=d[s],o=r[s],d!==o&&(h&&o&&(i.isPlainObject(o)||(e=i.isArray(o)))?(e?(e=!1,a=t&&i.isArray(t)?t:[]):a=t&&i.isPlainObject(t)?t:{},d[s]=i.extend(h,a,o)):void 0!==o&&(d[s]=o));return d},i.inArray=function(t,e,o){return null==e?-1:e.indexOf(t,o)},i.fn.find=function(t){var e,o=[];return this.each(function(n){e=Array.prototype.slice.call(this.querySelectorAll(t),""),e.length&&(o=o.concat(e))}),i(o)},i.fn.on=function(t,e){return this.each(function(){this.addEventListener(t,e,!1)})},i.fn.off=function(t,e){return this.each(function(){this.removeEventListener(t,e)})},i.fn.delegate=function(t,e,o){return this.each(function(n){var s=this;this._events||(this._events={}),this._events[e]||(this._events[e]=[]);var r=function(e){var n=e&&e.target||window.event.srcElement,r=e.path;if(!r){r=[];for(var a=n;a;)r.push(a),a=a.parentNode}for(var d=0,l=r.length;d<l&&r[d]!==s;d++)if(r[d]!==document&&i.match(r[d],t)){o.call(r[d],e);break}};r.fn=o,this.addEventListener(e,r,!1),this._events[e].push(r)})},i.fn.undelegate=function(t,e,o){return o||(o=e,e=t),this.each(function(t){var n=this._events,i=this._events[e];if(n&&i){for(var t=0,s=i.length;t<s;t++)if(o===i[t].fn){this.removeEventListener(e,i[t]),delete i[t].fn,i.splice(t,1);break}i.length||delete n[e];var r=!0;for(var a in n)if(n.hasOwnProperty(a)){r=!1;break}r&&delete this._events}})},function(){function t(t,e){e=e||{bubbles:!1,cancelable:!1,detail:void 0};var o=document.createEvent("CustomEvent");return o.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),o}if("function"==typeof window.CustomEvent)return!1;t.prototype=window.Event.prototype,window.CustomEvent=t}(),i.fn.trigger=i.fn.triggerHandler=function(t,e){return this.each(function(o){var n=new CustomEvent(t,{detail:e||null});this.dispatchEvent(n)})},i.fn.data=function(t){return t?this[0].dataset[t]:this[0].dataset},i.parseJSON=function(t){return JSON.parse(t)},i.fn.css=function(t,e){if(t)return"float"==t&&(t="styleFloat"),e?this.each(function(){this.style[t]=e}):getComputedStyle(this[0],null)[t]||void 0},i.fn.hasClass=function(t){return this[0].classList.contains(t)},i.fn.addClass=function(t){var e=t.split(" ");return this.each(function(){for(var t=0,o=e.length;t<o;t++)this.classList.add(e[t])})},i.fn.removeClass=function(t){var e=t.split(" ");return this.each(function(t){for(var t=0,o=e.length;t<o;t++)this.classList.remove(e[t])})},i.fn.closest=function(t){for(var e,o=[],n=0,s=this.length;n<s;n++)if(i.match(this[n],t))o.push(this[n]);else for(e=this[n].parentNode,e===document&&(e=document.documentElement);e&&"HTML"!==e.tagName;)i.match(e,t)&&i.inArray(e,o)===-1&&o.push(e),e=e.parentNode;return i(o)},i.fn.html=function(t){return this.each(function(){this.innerHTML=t})},e.default=i,t.exports=e.default},function(t,e,o){"use strict";function n(){function t(t){var o,n,i,s=["Webkit","Moz","O","ms"],r=t.charAt(0).toUpperCase()+t.slice(1),a=document.createElement("div");if(document.body.insertBefore(a,null),t in a.style)n=t,i=null;else for(var d=0;d<s.length;d++){if((o=s[d]+r)in a.style){i=s[d];break}o=void 0}var l={js:n||o,css:e(t,i)};if("transform"===t){if(void 0!==a.style[l.js]){a.style[l.js]="translate3d(1px,1px,1px)";var c=window.getComputedStyle(a)[l.js]}l["3d"]=void 0!==c&&c.length>0&&"none"!==c}return document.body.removeChild(a),l}function e(t,e){if(t=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),null===e)return t;var o=void 0;switch(e){case"Webkit":o="-webkit-"+t;break;case"Moz":o="-moz-"+t;break;case"ms":o="-ms-"+t;break;case"O":o="-o-"+t}return o}var o={},n=document.createElement("div");n.style.cssText="width: 99px; height: 99px; overflow: scroll; position: absolute; top: -99px;",document.body.appendChild(n),o.scrollbarSize=n.offsetWidth-n.clientWidth||0,document.body.removeChild(n),o.oldIE=!(!document.all||document.addEventListener),o.touch="ontouchstart"in window;var i=o;return i.nativeDialogSupport=!!document.createElement("dialog").showModal,i.transition=t("transition"),i.transitionDuration=t("transitionDuration"),i.transform=t("transform"),i.animation=t("animation"),o}Object.defineProperty(e,"__esModule",{value:!0}),e.getDefaultInfo=n;e.defaults={elem:"",content:void 0,type:"",header:void 0,footer:void 0,class:!1,zindex:!1,container:"body",position:"fixed",click:!0,clickels:"",backdrop:!0,backdropassist:!0,scrollbar:"hide",out:!0,esc:!0,close:"outside",autoheight:"image",autofocus:!1,focusprevious:!0,title:!1,title_attr:"title",img:"ready",imgload:"show",anim:"scale",animclass:"animated",duration:"auto",jquery:void 0,_focusable:'a[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), [tabindex]:not([tabindex="-1"]), [contenteditable]',autobind:'[data-toggle~="box"], [data-toggle~="modal"]',templates:{wrap:'<div class="njb-wrap"><div class="njb-items"></div></div>',backdrop:'<div class="njb-backdrop"></div>',modalOuter:'<div class="njb-outer"></div>',modal:'<div class="njb" tabindex="-1" role="dialog"></div>',body:'<div class="njb__body" role="document" data-njb-body></div>',header:'<header class="njb__header" data-njb-header></header>',footer:'<footer class="njb__footer" data-njb-footer></footer>',close:'<button type="button" class="njb-ui__close" data-njb-close><span aria-hidden="true">×</span></button>',focusCatcher:'<div tabindex="0" class="njb-focus-catch"></div>',preloader:'<div class="njb-preloader"><div class="njb-preloader__inner"><div class="njb-preloader__bar1"></div><div class="njb-preloader__bar2"></div><div class="njb-preloader__bar3"></div></div></div>',ui:'<div class="njb-ui"></div>',title:'<div class="njb-ui__title"><div class="njb-ui__title-inner" id="njb-title" data-njb-title></div></div>'},text:{_missedContent:"njBox plugin: meow, put some content here...",preloader:"Loading...",imageError:'<a href="%url%">This image</a> can not be loaded.',close:"Close dialog",ok:"Ok",cancel:"Cancel",placeholder:""}}},function(t,e,o){t.exports=o(0)}])});